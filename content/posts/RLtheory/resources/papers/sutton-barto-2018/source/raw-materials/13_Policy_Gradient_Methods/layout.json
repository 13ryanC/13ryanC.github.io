{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        214,
                        233,
                        239
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                214,
                                233,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        214,
                                        233,
                                        239
                                    ],
                                    "type": "text",
                                    "content": "Chapter 13"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        267,
                        449,
                        297
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                267,
                                449,
                                297
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        267,
                                        449,
                                        297
                                    ],
                                    "type": "text",
                                    "content": "Policy Gradient Methods"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        339,
                        530,
                        485
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                339,
                                530,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we consider something new. So far in this book almost all the methods have been action- value methods; they learned the values of actions and then selected actions based on their estimated action values<sup>1</sup>; their policies would not even exist without the action- value estimates. In this chapter we consider methods that instead learn a parameterized policy that can select actions without consulting a value function. A value function may still be used to learn the policy parameter, but is not required for action selection. We use the notation "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta} \\in \\mathbb{R}^{d'}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " for the policy's parameter vector. Thus we write "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a | s, \\pmb {\\theta}) = \\operatorname *{Pr}\\{A_t = a \\mid S_t = s, \\pmb {\\theta}_t = \\pmb {\\theta}\\}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " for the probability that action "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " is taken at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " given that the environment is in state "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " with parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": ". If a method uses a learned value function as well, then the value function's weight vector is denoted "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " as usual, as in "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": ".In this chapter we consider methods for learning the policy parameter based on the gradient of some scalar performance measure "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "J(\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " with respect to the policy parameter. These methods seek to maximize performance, so their updates approximate gradient ascent in "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "J"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        485
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        487,
                        530,
                        539
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                487,
                                530,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        487,
                                        530,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we consider methods for learning the policy parameter based on the gradient of some scalar performance measure "
                                },
                                {
                                    "bbox": [
                                        104,
                                        487,
                                        530,
                                        539
                                    ],
                                    "type": "inline_equation",
                                    "content": "J(\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        487,
                                        530,
                                        539
                                    ],
                                    "type": "text",
                                    "content": " with respect to the policy parameter. These methods seek to maximize performance, so their updates approximate gradient ascent in "
                                },
                                {
                                    "bbox": [
                                        104,
                                        487,
                                        530,
                                        539
                                    ],
                                    "type": "inline_equation",
                                    "content": "J"
                                },
                                {
                                    "bbox": [
                                        104,
                                        487,
                                        530,
                                        539
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        131,
                        547,
                        528,
                        565
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                547,
                                528,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        547,
                                        528,
                                        565
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pmb{\\theta}_{t + 1} = \\pmb {\\theta}_t + \\alpha \\widehat{\\nabla J(\\pmb{\\theta}_t)}, \\tag{13.1}",
                                    "image_path": "76e55e9b068d99116dec1a5e45880095b44ba402432a65d01db07d98ee3ee903.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        575,
                        530,
                        684
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                575,
                                530,
                                684
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        575,
                                        530,
                                        684
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        575,
                                        530,
                                        684
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\widehat{\\nabla J(\\pmb{\\theta}_t)} \\in \\mathbb{R}^{d'}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        575,
                                        530,
                                        684
                                    ],
                                    "type": "text",
                                    "content": " is a stochastic estimate whose expectation approximates the gradient of the performance measure with respect to its argument "
                                },
                                {
                                    "bbox": [
                                        104,
                                        575,
                                        530,
                                        684
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb {\\theta}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        575,
                                        530,
                                        684
                                    ],
                                    "type": "text",
                                    "content": ". All methods that follow this general schema we call policy gradient methods, whether or not they also learn an approximate value function. Methods that learn approximations to both policy and value functions are often called actor- critic methods, where 'actor' is a reference to the learned policy, and 'critic' refers to the learned value function, usually a state- value function. First we treat the episodic case, in which performance is defined as the value of the start state under the parameterized policy, before going on to consider the continuing case, in"
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 0
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        491,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                491,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "which performance is defined as the average reward rate, as in Section 10.3. In the end, we are able to express the algorithms for both cases in very similar terms."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        188,
                        443,
                        206
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                188,
                                443,
                                206
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        188,
                                        443,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "13.1 Policy Approximation and its Advantages"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        216,
                        490,
                        336
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                216,
                                490,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": "In policy gradient methods, the policy can be parameterized in any way, as long as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s,\\pmb \\theta)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": " is differentiable with respect to its parameters, that is, as long as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla \\pi (a|s,\\pmb \\theta)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": " (the column vector of partial derivatives of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s,\\pmb \\theta)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": " with respect to the components of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb \\theta"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ") exists and is finite for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "a\\in \\mathcal{A}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb \\theta \\in \\mathbb{R}^{d^{\\prime}}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ". In practice, to ensure exploration we generally require that the policy never becomes deterministic (i.e., that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s,\\pmb \\theta)\\in (0,1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ", for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "inline_equation",
                                    "content": "s,a,\\pmb \\theta"
                                },
                                {
                                    "bbox": [
                                        64,
                                        216,
                                        490,
                                        336
                                    ],
                                    "type": "text",
                                    "content": "). In this section we introduce the most common parameterization for discrete action spaces and point out the advantages it offers over action- value methods. Policy- based methods also offer useful ways of dealing with continuous action spaces, as we describe later in Section 13.7."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        338,
                        490,
                        404
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                338,
                                490,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        338,
                                        490,
                                        404
                                    ],
                                    "type": "text",
                                    "content": "If the action space is discrete and not too large, then a natural and common kind of parameterization is to form parameterized numerical preferences "
                                },
                                {
                                    "bbox": [
                                        64,
                                        338,
                                        490,
                                        404
                                    ],
                                    "type": "inline_equation",
                                    "content": "h(s,a,\\pmb \\theta)\\in \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        338,
                                        490,
                                        404
                                    ],
                                    "type": "text",
                                    "content": " for each state- action pair. The actions with the highest preferences in each state are given the highest probabilities of being selected, for example, according to an exponential soft- max distribution:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        91,
                        410,
                        489,
                        442
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                410,
                                489,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        410,
                                        489,
                                        442
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pi (a|s,\\pmb \\theta)\\doteq \\frac{e^{h(s,a,\\pmb\\theta)}}{\\sum_{b}e^{h(s,b,\\pmb\\theta)}}, \\tag{13.2}",
                                    "image_path": "6adbb92916f0f69289f1f886bc18c07c3c224f3b25fbe8edb3d24ef37a9305ff.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        451,
                        489,
                        490
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                451,
                                489,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        451,
                                        489,
                                        490
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        451,
                                        489,
                                        490
                                    ],
                                    "type": "inline_equation",
                                    "content": "e\\approx 2.71828"
                                },
                                {
                                    "bbox": [
                                        64,
                                        451,
                                        489,
                                        490
                                    ],
                                    "type": "text",
                                    "content": " is the base of the natural logarithm. Note that the denominator here is just what is required so that the action probabilities in each state sum to one. We call this kind of policy parameterization soft- max in action preferences."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        492,
                        489,
                        545
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                492,
                                489,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        492,
                                        489,
                                        545
                                    ],
                                    "type": "text",
                                    "content": "The action preferences themselves can be parameterized arbitrarily. For example, they might be computed by a deep artificial neural network (ANN), where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        492,
                                        489,
                                        545
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb \\theta"
                                },
                                {
                                    "bbox": [
                                        64,
                                        492,
                                        489,
                                        545
                                    ],
                                    "type": "text",
                                    "content": " is the vector of all the connection weights of the network (as in the AlphaGo system described in Section 16.6). Or the preferences could simply be linear in features,"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        91,
                        554,
                        489,
                        570
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                554,
                                489,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        554,
                                        489,
                                        570
                                    ],
                                    "type": "interline_equation",
                                    "content": "h(s,a,\\pmb \\theta) = \\pmb \\theta^{\\top}\\mathbf{x}(s,a), \\tag{13.3}",
                                    "image_path": "883085d5b5ad1ae313a5f876e454cb1fe021e3fd14315bdeb77c5df542da6268.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        580,
                        489,
                        607
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                580,
                                489,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        580,
                                        489,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "using feature vectors "
                                },
                                {
                                    "bbox": [
                                        64,
                                        580,
                                        489,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(s,a)\\in \\mathbb{R}^{d^{\\prime}}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        580,
                                        489,
                                        607
                                    ],
                                    "type": "text",
                                    "content": " constructed by any of the methods described in Section 9.5."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        64,
                        608,
                        490,
                        755
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                608,
                                490,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        608,
                                        490,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "One advantage of parameterizing policies according to the soft- max in action preferences is that the approximate policy can approach a deterministic policy, whereas with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        608,
                                        490,
                                        755
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        608,
                                        490,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "- greedy action selection over action values there is always an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        608,
                                        490,
                                        755
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        608,
                                        490,
                                        755
                                    ],
                                    "type": "text",
                                    "content": " probability of selecting a random action. Of course, one could select according to a soft- max distribution based on action values, but this alone would not allow the policy to approach a deterministic policy. Instead, the action- value estimates would converge to their corresponding true values, which would differ by a finite amount, translating to specific probabilities other than 0 and 1. If the soft- max distribution included a temperature parameter, then the temperature could be reduced over time to approach determinism, but in practice it would be difficult to choose the reduction schedule, or even the initial temperature, without more prior knowledge of the true action values than we would like to assume. Action preferences"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 1
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        529,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                529,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "are different because they do not approach specific values; instead they are driven to produce the optimal stochastic policy. If the optimal policy is deterministic, then the preferences of the optimal actions will be driven infinitely higher than all suboptimal actions (if permitted by the parameterization)."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        196,
                        529,
                        287
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                196,
                                529,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        196,
                                        529,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "A second advantage of parameterizing policies according to the soft- max in action preferences is that it enables the selection of actions with arbitrary probabilities. In problems with significant function approximation, the best approximate policy may be stochastic. For example, in card games with imperfect information the optimal play is often to do two different things with specific probabilities, such as when bluffing in Poker. Action- value methods have no natural way of finding stochastic optimal policies, whereas policy approximating methods can, as shown in Example 13.1."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        117,
                        298,
                        526,
                        311
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                298,
                                526,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        298,
                                        526,
                                        311
                                    ],
                                    "type": "text",
                                    "content": "Example 13.1 Short corridor with switched actions"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        321,
                        516,
                        507
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                321,
                                516,
                                507
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": "Consider the small corridor gridworld shown inset in the graph below. The reward is "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 1"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": " per step, as usual. In each of the three nonterminal states there are only two actions, right and left. These actions have their usual consequences in the first and third states (left causes no movement in the first state), but in the second state they are reversed, so that right moves to the left and left moves to the right. The problem is difficult because all the states appear identical under the function approximation. In particular, we define "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(s, \\text{right}) = [1, 0]^{\\top}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(s, \\text{left}) = [0, 1]^{\\top}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": ", for all "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": ". An action- value method with "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": "- greedy action selection is forced to choose between just two policies: choosing right with high probability "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 - \\epsilon /2"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": " on all steps or choosing left with the same high probability on all time steps. If "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon = 0.1"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": ", then these two policies achieve a value (at the start state) of less than "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 44"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 82"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": ", respectively, as shown in the graph. A method can do significantly better if it can learn a specific probability with which to select right. The best probability is about 0.59, which achieves a value of about "
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 11.6"
                                },
                                {
                                    "bbox": [
                                        117,
                                        321,
                                        516,
                                        507
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        117,
                        523,
                        456,
                        691
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                117,
                                523,
                                456,
                                691
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        117,
                                        523,
                                        456,
                                        691
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                117,
                                                523,
                                                456,
                                                691
                                            ],
                                            "type": "image",
                                            "image_path": "8e729e5e4136c190c999778a730645f582d71145169ca987c4b1252107619617.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "type": "image_body"
                        }
                    ],
                    "index": 4
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 2
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        141,
                        490,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                141,
                                490,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        141,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "Perhaps the simplest advantage that policy parameterization may have over action- value parameterization is that the policy may be a simpler function to approximate. Problems vary in the complexity of their policies and action- value functions. For some, the action- value function is simpler and thus easier to approximate. For others, the policy is simpler. In the latter case a policy- based method will typically learn faster and yield a superior asymptotic policy (as in Tetris; see Şimşek, Algorta, and Kothiyal, 2016)."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        222,
                        489,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                222,
                                489,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        222,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "Finally, we note that the choice of policy parameterization is sometimes a good way of injecting prior knowledge about the desired form of the policy into the reinforcement learning system. This is often the most important reason for using a policy- based learning method."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        278,
                        489,
                        319
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                278,
                                489,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        278,
                                        489,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "Exercise 13.1 Use your knowledge of the gridworld and its dynamics to determine an exact symbolic expression for the optimal probability of selecting the right action in Example 13.1. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        278,
                                        489,
                                        319
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        65,
                        339,
                        351,
                        357
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                339,
                                351,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        339,
                                        351,
                                        357
                                    ],
                                    "type": "text",
                                    "content": "13.2 The Policy Gradient Theorem"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        369,
                        489,
                        489
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                369,
                                489,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        369,
                                        489,
                                        489
                                    ],
                                    "type": "text",
                                    "content": "In addition to the practical advantages of policy parameterization over "
                                },
                                {
                                    "bbox": [
                                        64,
                                        369,
                                        489,
                                        489
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        369,
                                        489,
                                        489
                                    ],
                                    "type": "text",
                                    "content": "- greedy action selection, there is also an important theoretical advantage. With continuous policy parameterization the action probabilities change smoothly as a function of the learned parameter, whereas in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        369,
                                        489,
                                        489
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        369,
                                        489,
                                        489
                                    ],
                                    "type": "text",
                                    "content": "- greedy selection the action probabilities may change dramatically for an arbitrarily small change in the estimated action values, if that change results in a different action having the maximal value. Largely because of this, stronger convergence guarantees are available for policy- gradient methods than for action- value methods. In particular, it is the continuity of the policy dependence on the parameters that enables policy- gradient methods to approximate gradient ascent (13.1)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        490,
                        489,
                        543
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                490,
                                489,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        490,
                                        489,
                                        543
                                    ],
                                    "type": "text",
                                    "content": "The episodic and continuing cases define the performance measure, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        490,
                                        489,
                                        543
                                    ],
                                    "type": "inline_equation",
                                    "content": "J(\\pmb \\theta)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        490,
                                        489,
                                        543
                                    ],
                                    "type": "text",
                                    "content": ", differently and thus have to be treated separately to some extent. Nevertheless, we will try to present both cases uniformly, and we develop a notation so that the major theoretical results can be described with a single set of equations."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        544,
                        489,
                        597
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                544,
                                489,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "In this section we treat the episodic case, for which we define the performance measure as the value of the start state of the episode. We can simplify the notation without losing any meaningful generality by assuming that every episode starts in some particular (non- random) state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "s_0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        597
                                    ],
                                    "type": "text",
                                    "content": ". Then, in the episodic case we define performance as"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        607,
                        488,
                        623
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                607,
                                488,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        607,
                                        488,
                                        623
                                    ],
                                    "type": "interline_equation",
                                    "content": "J(\\pmb \\theta) \\doteq v_{\\pi_{\\pmb \\theta}}(s_0), \\tag{13.4}",
                                    "image_path": "daea443d72c8fc0bfa912bf18a63c39634ce078038be095cbd579778dcb266e7.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        633,
                        489,
                        672
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                633,
                                489,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi_{\\theta}}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "text",
                                    "content": " is the true value function for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "text",
                                    "content": ", the policy determined by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb \\theta"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "text",
                                    "content": ". From here on in our discussion we will assume no discounting ("
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        672
                                    ],
                                    "type": "text",
                                    "content": ") for the episodic case, although for completeness we do include the possibility of discounting in the boxed algorithms."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        64,
                        674,
                        489,
                        753
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                674,
                                489,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        674,
                                        489,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "With function approximation it may seem challenging to change the policy parameter in a way that ensures improvement. The problem is that performance depends on both the action selections and the distribution of states in which those selections are made, and that both of these are affected by the policy parameter. Given a state, the effect of the policy parameter on the actions, and thus on reward, can be computed in a relatively straightforward way from knowledge of the parameterization. But the effect of the policy"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 3
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        117,
                        149,
                        418,
                        163
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                149,
                                418,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        149,
                                        418,
                                        163
                                    ],
                                    "type": "text",
                                    "content": "Proof of the Policy Gradient Theorem (episodic case)"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        173,
                        517,
                        240
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                173,
                                517,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "text",
                                    "content": "With just elementary calculus and re- arranging of terms, we can prove the policy gradient theorem from first principles. To keep the notation simple, we leave it implicit in all cases that "
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "text",
                                    "content": " is a function of "
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "text",
                                    "content": ", and all gradients are also implicitly with respect to "
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        517,
                                        240
                                    ],
                                    "type": "text",
                                    "content": ". First note that the gradient of the state- value function can be written in terms of the action- value function as"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        145,
                        246,
                        515,
                        283
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                145,
                                246,
                                515,
                                283
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        145,
                                        246,
                                        515,
                                        283
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla v_{\\pi}(s) = \\nabla \\left[\\sum_{a}\\pi (a|s)q_{\\pi}(s,a)\\right],\\quad \\mathrm{for~all~}s\\in \\mathcal{S} \\tag{Exercise 3.18}",
                                    "image_path": "efce3283f5e7086f822243be7a00a120a7fc7a9828572c47e2666dcff984af0b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        181,
                        286,
                        515,
                        346
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                181,
                                286,
                                515,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        181,
                                        286,
                                        515,
                                        346
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & {= \\sum_{a}\\Big[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\nabla q_{\\pi}(s,a)\\Big]\\quad (\\mathrm{product~rule~of~calculus})}\\\\ & {= \\sum_{a}\\Big[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\nabla \\sum_{s^{\\prime},r}p(s^{\\prime},r|s,a)\\big(r + v_{\\pi}(s^{\\prime})\\big)\\Big]} \\end{array}",
                                    "image_path": "cc12908461af5d87ff5356f0e6e4d55b08562de344cd02115c46109d97b8b09d.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        354,
                        347,
                        514,
                        360
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                354,
                                347,
                                514,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        354,
                                        347,
                                        514,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "Exercise 3.19 and Equation 3.2)"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        182,
                        363,
                        515,
                        424
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                182,
                                363,
                                515,
                                424
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        182,
                                        363,
                                        515,
                                        424
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & {= \\sum_{a}\\Big[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\sum_{s^{\\prime}}p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime})\\Big]}\\\\ & {= \\sum_{a}\\Big[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\sum_{s}p(s^{\\prime}|s,a)} \\end{array} \\tag{Eq. 3.4}",
                                    "image_path": "b13b5e124be02281420c93d2ee7c9561e7de71e14666ed463d3d8986a676342e.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        210,
                        427,
                        491,
                        456
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                210,
                                427,
                                491,
                                456
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        210,
                                        427,
                                        491,
                                        456
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\sum_{a^{\\prime}}\\bigl [\\nabla \\pi (a^{\\prime}|s^{\\prime})q_{\\pi}(s^{\\prime},a^{\\prime}) + \\pi (a^{\\prime}|s^{\\prime})\\sum_{s^{\\prime \\prime}}p(s^{\\prime \\prime}|s^{\\prime},a^{\\prime})\\nabla v_{\\pi}(s^{\\prime \\prime})\\bigr ]\\biggr ]",
                                    "image_path": "90fe2c818b4992852d898dcfebc4de8379b7b72e5b3394e3a189023179431e24.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        183,
                        458,
                        399,
                        494
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                183,
                                458,
                                399,
                                494
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        183,
                                        458,
                                        399,
                                        494
                                    ],
                                    "type": "interline_equation",
                                    "content": "= \\sum_{x\\in \\mathcal{S}}\\sum_{k = 0}^{\\infty}\\operatorname *{Pr}(s\\to x,k,\\pi)\\sum_{a}\\nabla \\pi (a|x)q_{\\pi}(x,a),",
                                    "image_path": "a805c51f4176fa135dc14f06c4cb72277439ca4cfe26943c64ac30d61deb2ee8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        117,
                        502,
                        516,
                        530
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                502,
                                516,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": "after repeated unrolling, where "
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname *{Pr}(s\\to x,k,\\pi)"
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": " is the probability of transitioning from state "
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": " to state "
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": " in "
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": " steps under policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        502,
                                        516,
                                        530
                                    ],
                                    "type": "text",
                                    "content": ". It is then immediate that"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        144,
                        538,
                        515,
                        719
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                144,
                                538,
                                515,
                                719
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        144,
                                        538,
                                        515,
                                        719
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & {\\nabla J(\\pmb {\\theta}) = \\nabla v_{\\pi}(s_0)}\\\\ & {\\quad \\quad = \\sum_s\\left(\\sum_{k = 0}^{\\infty}\\operatorname *{Pr}(s_0\\to s,k,\\pi)\\right)\\sum_a\\nabla \\pi (a|s)q_{\\pi}(s,a)}\\\\ & {\\quad \\quad = \\sum_s\\eta (s)\\sum_a\\nabla \\pi (a|s)q_{\\pi}(s,a)}\\\\ & {\\quad \\quad = \\sum_s\\eta (s')\\sum_s\\frac{\\eta(s)}{\\sum_{s'}\\eta(s')}\\sum_a\\nabla \\pi (a|s)q_{\\pi}(s,a)}\\\\ & {\\quad \\quad = \\sum_s\\eta (s')\\sum_s\\mu (s)\\sum_a\\nabla \\pi (a|s)q_{\\pi}(s,a)}\\\\ & {\\quad \\quad \\propto \\sum_s\\mu (s)\\sum_a\\nabla \\pi (a|s)q_{\\pi}(s,a)} \\end{array} \\tag{Eq. 9.3}",
                                    "image_path": "e71841553a8815e4390f2fb9cffaa18b5c5df03d41fff95a4c09eb2919a1a224.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 4
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        180
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        180
                                    ],
                                    "type": "text",
                                    "content": "on the state distribution is a function of the environment and is typically unknown. How can we estimate the performance gradient with respect to the policy parameter when the gradient depends on the unknown effect of policy changes on the state distribution?"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        181,
                        490,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                181,
                                490,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        490,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Fortunately, there is an excellent theoretical answer to this challenge in the form of the policy gradient theorem, which provides an analytic expression for the gradient of performance with respect to the policy parameter (which is what we need to approximate for gradient ascent (13.1)) that does not involve the derivative of the state distribution. The policy gradient theorem for the episodic case establishes that"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        91,
                        255,
                        489,
                        283
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                255,
                                489,
                                283
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        255,
                                        489,
                                        283
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla J(\\pmb {\\theta})\\propto \\sum_{s}\\mu (s)\\sum_{a}q_{\\pi}(s,a)\\nabla \\pi (a|s,\\pmb {\\theta}), \\tag{13.5}",
                                    "image_path": "d72b4dc3f656c1ca64b0c93ed4d45a4eccc90e668db09a526d8c60855a79d400.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        289,
                        489,
                        383
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                289,
                                489,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": "where the gradients are column vectors of partial derivatives with respect to the components of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " denotes the policy corresponding to parameter vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": ". The symbol "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\propto"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " here means \"proportional to\". In the episodic case, the constant of proportionality is the average length of an episode, and in the continuing case it is 1, so that the relationship is actually an equality. The distribution "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " here (as in Chapters 9 and 10) is the on- policy distribution under "
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        289,
                                        489,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " (see page 199). The policy gradient theorem is proved for the episodic case in the box on the previous page."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        65,
                        402,
                        462,
                        421
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                402,
                                462,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        402,
                                        462,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "13.3 REINFORCE: Monte Carlo Policy Gradient"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        431,
                        489,
                        578
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                431,
                                489,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "text",
                                    "content": "We are now ready to derive our first policy- gradient learning algorithm. Recall our overall strategy of stochastic gradient ascent (13.1), which requires a way to obtain samples such that the expectation of the sample gradient is proportional to the actual gradient of the performance measure as a function of the parameter. The sample gradients need only be proportional to the gradient because any constant of proportionality can be absorbed into the step size "
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "text",
                                    "content": ", which is otherwise arbitrary. The policy gradient theorem gives an exact expression proportional to the gradient; all that is needed is some way of sampling whose expectation equals or approximates this expression. Notice that the right- hand side of the policy gradient theorem is a sum over states weighted by how often the states occur under the target policy "
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "text",
                                    "content": "; if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        578
                                    ],
                                    "type": "text",
                                    "content": " is followed, then states will be encountered in these proportions. Thus"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        585,
                        489,
                        653
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                585,
                                489,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        585,
                                        489,
                                        653
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{\\nabla J(\\pmb{\\theta})\\propto\\sum_{s}\\mu(s)\\sum_{a}q_{\\pi}(s,a)\\nabla\\pi(a|s,\\pmb{\\theta})}}\\\\ {{\\qquad=\\mathbb{E}_{\\pi}\\biggl[\\sum_{a}q_{\\pi}(S_{t},a)\\nabla\\pi(a|S_{t},\\pmb{\\theta})\\biggr].}}\\end{array} \\tag{13.6}",
                                    "image_path": "505a9bf4ffd2bf62c5e650251c87a42d9775da9d5edce8b07f204a27257305e2.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        657,
                        479,
                        671
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                657,
                                479,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        657,
                                        479,
                                        671
                                    ],
                                    "type": "text",
                                    "content": "We could stop here and instantiate our stochastic gradient- ascent algorithm (13.1) as"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        91,
                        679,
                        489,
                        707
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                679,
                                489,
                                707
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        679,
                                        489,
                                        707
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pmb{\\theta}_{t + 1}\\doteq \\pmb {\\theta}_t + \\alpha \\sum_a\\hat{q} (S_t,a,\\mathbf{w})\\nabla \\pi (a|S_t,\\pmb {\\theta}), \\tag{13.7}",
                                    "image_path": "1bd188a1fccd85f1058caf37dcbfdd6bb5bb41f9426ce2581a9f6d0921c969dd.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        63,
                        713,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                713,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        63,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}"
                                },
                                {
                                    "bbox": [
                                        63,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is some learned approximation to "
                                },
                                {
                                    "bbox": [
                                        63,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        63,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". This algorithm, which has been called an all- actions method because its update involves all of the actions, is promising and"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 5
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        141,
                        530,
                        181
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                141,
                                530,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "deserving of further study, but our current interest is the classical REINFORCE algorithm (Willams, 1992) whose update at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "text",
                                    "content": " involves just "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "text",
                                    "content": ", the one action actually taken at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        181,
                        530,
                        275
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                181,
                                530,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": "We continue our derivation of REINFORCE by introducing "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": " in the same way as we introduced "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": " in (13.6)—by replacing a sum over the random variable's possible values by an expectation under "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": ", and then sampling the expectation. Equation (13.6) involves an appropriate sum over actions, but each term is not weighted by "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|S_{t},\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": " as is needed for an expectation under "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": ". So we introduce such a weighting, without changing the equality, by multiplying and then dividing the summed terms by "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|S_{t},\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        275
                                    ],
                                    "type": "text",
                                    "content": ". Continuing from (13.6), we have"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        131,
                        282,
                        530,
                        382
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                282,
                                530,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        282,
                                        530,
                                        382
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rlr}\\nabla J(\\pmb {\\theta})\\propto \\mathbb{E}_{\\pi}[\\sum_{a}\\pi (a|S_{t},\\pmb {\\theta})q_{\\pi}(S_{t},a)\\frac{\\nabla\\pi(a|S_{t},\\pmb{\\theta})}{\\pi(a|S_{t},\\pmb{\\theta})}] & \\\\ = \\mathbb{E}_{\\pi}[q_{\\pi}(S_{t},A_{t})\\frac{\\nabla\\pi(A_{t}|S_{t},\\pmb{\\theta})}{\\pi(A_{t}|S_{t},\\pmb{\\theta})}] & \\mathrm{(replacing~}a\\mathrm{~by~the~sample~}A_{t}\\sim \\pi)\\\\ = \\mathbb{E}_{\\pi}[G_{t}\\frac{\\nabla\\pi(A_{t}|S_{t},\\pmb{\\theta})}{\\pi(A_{t}|S_{t},\\pmb{\\theta})}], & \\mathrm{(because~}\\mathbb{E}_{\\pi}[G_{t}|S_{t},A_{t}] = q_{\\pi}(S_{t},A_{t})) \\end{array}",
                                    "image_path": "290e0b31726b697ba0dd7b9d36268b3643a4421afd8fa858004ee3c78b5eb3ac.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        385,
                        530,
                        439
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                385,
                                530,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        385,
                                        530,
                                        439
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        385,
                                        530,
                                        439
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        385,
                                        530,
                                        439
                                    ],
                                    "type": "text",
                                    "content": " is the return as usual. The final expression in brackets is exactly what is needed, a quantity that can be sampled on each time step whose expectation is proportional to the gradient. Using this sample to instantiate our generic stochastic gradient ascent algorithm (13.1) yields the REINFORCE update:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        131,
                        445,
                        528,
                        474
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                445,
                                528,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        445,
                                        528,
                                        474
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pmb{\\theta}_{t + 1}\\doteq \\pmb {\\theta}_t + \\alpha_{t}G_t\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}. \\tag{13.8}",
                                    "image_path": "b660c6e90e255997a114a7ddc775e41165d6fb0c49598268fb3d9c0b3d4f64af.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        480,
                        530,
                        613
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                480,
                                530,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "text",
                                    "content": "This update has an intuitive appeal. Each increment is proportional to the product of a return "
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "text",
                                    "content": " and a vector, the gradient of the probability of taking the action actually taken divided by the probability of taking that action. The vector is the direction in parameter space that most increases the probability of repeating the action "
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "text",
                                    "content": " on future visits to state "
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        480,
                                        530,
                                        613
                                    ],
                                    "type": "text",
                                    "content": ". The update increases the parameter vector in this direction proportional to the return, and inversely proportional to the action probability. The former makes sense because it causes the parameter to move most in the directions that favor actions that yield the highest return. The latter makes sense because otherwise actions that are selected frequently are at an advantage (the updates will be more often in their direction) and might win out even if they do not yield the highest return."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        615,
                        530,
                        681
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                615,
                                530,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        615,
                                        530,
                                        681
                                    ],
                                    "type": "text",
                                    "content": "Note that REINFORCE uses the complete return from time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        615,
                                        530,
                                        681
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        615,
                                        530,
                                        681
                                    ],
                                    "type": "text",
                                    "content": ", which includes all future rewards up until the end of the episode. In this sense REINFORCE is a Monte Carlo algorithm and is well defined only for the episodic case with all updates made in retrospect after the episode is completed (like the Monte Carlo algorithms in Chapter 5). This is shown explicitly in the boxed algorithm on the next page."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        682,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                682,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Notice that the update in the last line of pseudocode appears rather different from the REINFORCE update rule (13.8). One difference is that the pseudocode uses the compact expression "
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla \\ln \\pi (A_t|S_t,\\pmb {\\theta}_t)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " for the fractional vector "
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " in (13.8). That these two expressions for the vector are equivalent follows from the identity "
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla \\ln x = \\frac{\\nabla x}{x}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        682,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 6
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        180
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        180
                                    ],
                                    "type": "text",
                                    "content": "This vector has been given several names and notations in the literature; we will refer to it simply as the eligibility vector. Note that it is the only place that the policy parameterization appears in the algorithm."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        77,
                        188,
                        468,
                        203
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                188,
                                468,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        188,
                                        468,
                                        203
                                    ],
                                    "type": "text",
                                    "content": "REINFORCE: Monte- Carlo Policy- Gradient Control (episodic) for "
                                },
                                {
                                    "bbox": [
                                        77,
                                        188,
                                        468,
                                        203
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        77,
                        212,
                        349,
                        226
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                212,
                                349,
                                226
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        212,
                                        349,
                                        226
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable policy parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        212,
                                        349,
                                        226
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s,\\pmb \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        77,
                        227,
                        263,
                        239
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                227,
                                263,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        227,
                                        263,
                                        239
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameter: step size "
                                },
                                {
                                    "bbox": [
                                        77,
                                        227,
                                        263,
                                        239
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha >0"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        240,
                        303,
                        254
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                240,
                                303,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        240,
                                        303,
                                        254
                                    ],
                                    "type": "text",
                                    "content": "Initialize policy parameter "
                                },
                                {
                                    "bbox": [
                                        77,
                                        240,
                                        303,
                                        254
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb \\theta \\in \\mathbb{R}^{d^{\\prime}}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        240,
                                        303,
                                        254
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        260,
                        233,
                        273
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                260,
                                233,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        260,
                                        233,
                                        273
                                    ],
                                    "type": "text",
                                    "content": "Loop forever (for each episode):"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        274,
                        435,
                        287
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                274,
                                435,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        274,
                                        435,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "Generate an episode "
                                },
                                {
                                    "bbox": [
                                        91,
                                        274,
                                        435,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0},A_{0},R_{1},\\ldots ,S_{T - 1},A_{T - 1},R_{T}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        274,
                                        435,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " , following "
                                },
                                {
                                    "bbox": [
                                        91,
                                        274,
                                        435,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |\\cdot ,\\pmb \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        287,
                        348,
                        300
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                287,
                                348,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        287,
                                        348,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of the episode "
                                },
                                {
                                    "bbox": [
                                        92,
                                        287,
                                        348,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,\\ldots ,T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        108,
                        300,
                        481,
                        329
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                108,
                                300,
                                481,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        300,
                                        481,
                                        329
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow \\sum_{k = t + 1}^{T}\\gamma^{k - t - 1}R_{k}} \\end{array}"
                                },
                                {
                                    "bbox": [
                                        108,
                                        300,
                                        481,
                                        329
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}\\leftarrow \\pmb {\\theta} + \\alpha \\gamma^{t}G\\pmb {\\nabla}\\ln \\pi (A_{t}|S_{t},\\pmb {\\theta})"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        64,
                        346,
                        489,
                        426
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                346,
                                489,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        489,
                                        426
                                    ],
                                    "type": "text",
                                    "content": "The second difference between the pseudocode update and the REINFORCE update equation (13.8) is that the former includes a factor of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        489,
                                        426
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        489,
                                        426
                                    ],
                                    "type": "text",
                                    "content": " . This is because, as mentioned earlier, in the text we are treating the non- discounted case ( "
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        489,
                                        426
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        489,
                                        426
                                    ],
                                    "type": "text",
                                    "content": " ) while in the boxed algorithms we are giving the algorithms for the general discounted case. All of the ideas go through in the discounted case with appropriate adjustments (including to the box on page 199) but involve additional complexity that distracts from the main ideas."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        64,
                        429,
                        489,
                        482
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                429,
                                489,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        429,
                                        489,
                                        482
                                    ],
                                    "type": "text",
                                    "content": "\\*Exercise 13.2 Generalize the box on page 199, the policy gradient theorem (13.5), the proof of the policy gradient theorem (page 325), and the steps leading to the REINFORCE update equation (13.8), so that (13.8) ends up with a factor of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        429,
                                        489,
                                        482
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        429,
                                        489,
                                        482
                                    ],
                                    "type": "text",
                                    "content": " and thus aligns with the general algorithm given in the pseudocode."
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        64,
                        487,
                        489,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                487,
                                489,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        487,
                                        489,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "Figure 13.1 shows the performance of REINFORCE on the short- corridor gridworld from Example 13.1."
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "type": "image",
                    "bbox": [
                        81,
                        516,
                        440,
                        707
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                81,
                                516,
                                440,
                                707
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        516,
                                        440,
                                        707
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                516,
                                                440,
                                                707
                                            ],
                                            "type": "image",
                                            "image_path": "9ce797da0445726f2fc17887db7b8b8cab80354fa48a774f802bfe982d784e24.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 12,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                714,
                                489,
                                740
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        714,
                                        489,
                                        740
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                714,
                                                489,
                                                740
                                            ],
                                            "type": "text",
                                            "content": "Figure 13.1: REINFORCE on the short-corridor gridworld (Example 13.1). With a good step size, the total reward per episode approaches the optimal value of the start state."
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "type": "image_caption"
                        }
                    ],
                    "index": 12
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 7
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "As a stochastic gradient method, REINFORCE has good theoretical convergence properties. By construction, the expected update over an episode is in the same direction as the performance gradient. This assures an improvement in expected performance for sufficiently small "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", and convergence to a local optimum under standard stochastic approximation conditions for decreasing "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ". However, as a Monte Carlo method REINFORCE may be of high variance and thus produce slow learning."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        224,
                        530,
                        264
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                224,
                                530,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        224,
                                        530,
                                        264
                                    ],
                                    "type": "text",
                                    "content": "Exercise 13.3 In Section 13.1 we considered policy parameterizations using the soft- max in action preferences (13.2) with linear action preferences (13.3). For this parameterization, prove that the eligibility vector is"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        132,
                        271,
                        528,
                        300
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                271,
                                528,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        271,
                                        528,
                                        300
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla \\ln \\pi (a|s,\\pmb \\theta) = \\mathbf{x}(s,a) - \\sum_{b}\\pi (b|s,\\pmb \\theta)\\mathbf{x}(s,b), \\tag{13.9}",
                                    "image_path": "1fac80b245970cd47651e3e8dd74971083157db08452d319f52f170511b3b301.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        307,
                        325,
                        320
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                307,
                                325,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        307,
                                        325,
                                        320
                                    ],
                                    "type": "text",
                                    "content": "using the definitions and elementary calculus."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        340,
                        374,
                        357
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                340,
                                374,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        374,
                                        357
                                    ],
                                    "type": "text",
                                    "content": "13.4 REINFORCE with Baseline"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        369,
                        528,
                        396
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                369,
                                528,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        369,
                                        528,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "The policy gradient theorem (13.5) can be generalized to include a comparison of the action value to an arbitrary baseline "
                                },
                                {
                                    "bbox": [
                                        104,
                                        369,
                                        528,
                                        396
                                    ],
                                    "type": "inline_equation",
                                    "content": "b(s)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        369,
                                        528,
                                        396
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        130,
                        404,
                        528,
                        433
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                404,
                                528,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        404,
                                        528,
                                        433
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla J(\\pmb \\theta)\\propto \\sum_{s}\\mu (s)\\sum_{a}\\Bigl (q_{s}(s,a) - b(s)\\Bigr)\\nabla \\pi (a|s,\\pmb \\theta). \\tag{13.10}",
                                    "image_path": "dee90bfc25a2bb8bb3a5722742518cb7629089ea7425a62f00a38e95c5671bca.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        102,
                        440,
                        529,
                        466
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                440,
                                529,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        440,
                                        529,
                                        466
                                    ],
                                    "type": "text",
                                    "content": "The baseline can be any function, even a random variable, as long as it does not vary with "
                                },
                                {
                                    "bbox": [
                                        102,
                                        440,
                                        529,
                                        466
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        102,
                                        440,
                                        529,
                                        466
                                    ],
                                    "type": "text",
                                    "content": "; the equation remains valid because the subtracted quantity is zero:"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        131,
                        475,
                        416,
                        502
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                475,
                                416,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        475,
                                        416,
                                        502
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\sum_{a}b(s)\\nabla \\pi (a|s,\\pmb \\theta) = b(s)\\nabla \\sum_{a}\\pi (a|s,\\pmb \\theta) = b(s)\\nabla 1 = 0.",
                                    "image_path": "f8f94996dd9f7b8316110ac1eb9be039e1d23bdccdfed73429584d28ee5ffae4.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        103,
                        510,
                        529,
                        549
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                510,
                                529,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        510,
                                        529,
                                        549
                                    ],
                                    "type": "text",
                                    "content": "The policy gradient theorem with baseline (13.10) can be used to derive an update rule using similar steps as in the previous section. The update rule that we end up with is a new version of REINFORCE that includes a general baseline:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        131,
                        557,
                        528,
                        586
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                557,
                                528,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        557,
                                        528,
                                        586
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pmb{\\theta}_{t + 1}\\doteq \\pmb {\\theta}_t + a\\Big(G_t - b(S_t)\\Big)\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}. \\tag{13.11}",
                                    "image_path": "58db4fd0f46fb094e2d6a0e350d356f13c0ed63bf176eed7d98d3641960968e3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        104,
                        592,
                        530,
                        713
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                592,
                                530,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        592,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": "Because the baseline could be uniformly zero, this update is a strict generalization of REINFORCE. In general, the baseline leaves the expected value of the update unchanged, but it can have a large effect on its variance. For example, we saw in Section 2.8 that an analogous baseline can significantly reduce the variance (and thus speed the learning) of gradient bandit algorithms. In the bandit algorithms the baseline was just a number (the average of the rewards seen so far), but for MDPs the baseline should vary with state. In some states all actions have high values and we need a high baseline to differentiate the higher valued actions from the less highly valued ones; in other states all actions will have low values and a low baseline is appropriate."
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        104,
                        714,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                714,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "One natural choice for the baseline is an estimate of the state value, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (S_t,\\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is a weight vector learned by one of the methods presented in previous chapters."
                                }
                            ]
                        }
                    ],
                    "index": 12
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 8
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        491,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                491,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "Because REINFORCE is a Monte Carlo method for learning the policy parameter, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        194
                                    ],
                                    "type": "text",
                                    "content": ", it seems natural to also use a Monte Carlo method to learn the state- value weights, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        491,
                                        194
                                    ],
                                    "type": "text",
                                    "content": ". A complete pseudocode algorithm for REINFORCE with baseline using such a learned state- value function as the baseline is given in the box below."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        76,
                        210,
                        422,
                        225
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                210,
                                422,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        210,
                                        422,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "REINFORCE with Baseline (episodic), for estimating "
                                },
                                {
                                    "bbox": [
                                        76,
                                        210,
                                        422,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{\\theta} \\approx \\pi_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        234,
                        349,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                234,
                                349,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        349,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable policy parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        349,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        77,
                        249,
                        407,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                249,
                                407,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        249,
                                        407,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable state- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        249,
                                        407,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        261,
                        318,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                261,
                                318,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        318,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step sizes "
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        318,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta} > 0"
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        318,
                                        274
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        318,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}} > 0"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        275,
                        459,
                        289
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                275,
                                459,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        459,
                                        289
                                    ],
                                    "type": "text",
                                    "content": "Initialize policy parameter "
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        459,
                                        289
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta} \\in \\mathbb{R}^{d'}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        459,
                                        289
                                    ],
                                    "type": "text",
                                    "content": " and state- value weights "
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        459,
                                        289
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        459,
                                        289
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        77,
                        296,
                        233,
                        309
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                296,
                                233,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        296,
                                        233,
                                        309
                                    ],
                                    "type": "text",
                                    "content": "Loop forever (for each episode):"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        91,
                        309,
                        436,
                        322
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                309,
                                436,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        309,
                                        436,
                                        322
                                    ],
                                    "type": "text",
                                    "content": "Generate an episode "
                                },
                                {
                                    "bbox": [
                                        91,
                                        309,
                                        436,
                                        322
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}, A_{0}, R_{1}, \\ldots , S_{T - 1}, A_{T - 1}, R_{T}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        309,
                                        436,
                                        322
                                    ],
                                    "type": "text",
                                    "content": ", following "
                                },
                                {
                                    "bbox": [
                                        91,
                                        309,
                                        436,
                                        322
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |\\cdot , \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        92,
                        323,
                        348,
                        335
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                323,
                                348,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        323,
                                        348,
                                        335
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of the episode "
                                },
                                {
                                    "bbox": [
                                        92,
                                        323,
                                        348,
                                        335
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0, 1, \\ldots , T - 1"
                                },
                                {
                                    "bbox": [
                                        92,
                                        323,
                                        348,
                                        335
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        107,
                        335,
                        480,
                        392
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                335,
                                480,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        335,
                                        480,
                                        392
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {G\\leftarrow \\sum_{k = t + 1}^{T}\\gamma^{k - t - 1}R_{k}}\\\\ & {\\delta \\leftarrow G - \\hat{v} (S_{t},\\mathbf{w})}\\\\ & {\\mathbf{w}\\leftarrow \\mathbf{w} + \\alpha^{\\mathbf{w}}\\delta \\nabla \\hat{v} (S_{t},\\mathbf{w})}\\\\ & {\\pmb {\\theta}\\leftarrow \\pmb {\\theta} + \\alpha^{\\pmb{\\theta}}\\gamma^{t}\\delta \\nabla \\ln \\pi (A_{t}|S_{t},\\pmb {\\theta})} \\end{array} \\tag{G_t}",
                                    "image_path": "cd575447b1b09cedc85e8c9ba643c60a2bc737000d703acc6d4201570cf723a5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        64,
                        414,
                        491,
                        485
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                414,
                                491,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": "This algorithm has two step sizes, denoted "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " (where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " is the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " in (13.11)). Choosing the step size for values (here "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": ") is relatively easy; in the linear case we have rules of thumb for setting it, such as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}} = 0.1 / \\mathbb{E}[\\| \\nabla \\hat{v} (S_{t}, \\mathbf{w})\\|_{\\mu}^{2}]"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": " (see Section 9.6). It is much less clear how to set the step size for the policy parameters, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        414,
                                        491,
                                        485
                                    ],
                                    "type": "text",
                                    "content": ", whose best value depends on the range of variation of the rewards and on the policy parameterization."
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "image",
                    "bbox": [
                        75,
                        500,
                        457,
                        687
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                75,
                                500,
                                457,
                                687
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        75,
                                        500,
                                        457,
                                        687
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                75,
                                                500,
                                                457,
                                                687
                                            ],
                                            "type": "image",
                                            "image_path": "d3d7e1d0d6ce8c67732aa3b5b3e363fd09882c3cf47024337fbd2ed13a510df3.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 11,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                63,
                                692,
                                490,
                                730
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        63,
                                        692,
                                        490,
                                        730
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                63,
                                                692,
                                                490,
                                                730
                                            ],
                                            "type": "text",
                                            "content": "Figure 13.2: Adding a baseline to REINFORCE can make it learn much faster, as illustrated here on the short-corridor gridworld (Example 13.1). The step size used here for plain REINFORCE is that at which it performs best (to the nearest power of two; see Figure 13.1)."
                                        }
                                    ]
                                }
                            ],
                            "index": 12,
                            "type": "image_caption"
                        }
                    ],
                    "index": 11
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 9
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        529,
                        181
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                529,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "Figure 13.2 compares the behavior of REINFORCE with and without a baseline on the short- corridor grid/word (Example 13.1). Here the approximate state- value function used in the baseline is "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s,\\mathbf{w}) = w"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "text",
                                    "content": ". That is, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "text",
                                    "content": " is a single component, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "w"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        105,
                        214,
                        329,
                        232
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                214,
                                329,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        214,
                                        329,
                                        232
                                    ],
                                    "type": "text",
                                    "content": "13.5 Actor-Critic Methods"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        245,
                        530,
                        445
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                245,
                                530,
                                445
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        245,
                                        530,
                                        445
                                    ],
                                    "type": "text",
                                    "content": "In REINFORCE with baseline, the learned state- value function estimates the value of the first state of each state transition. This estimate sets a baseline for the subsequent return, but is made prior to the transition's action and thus cannot be used to assess that action. In actor- critic methods, on the other hand, the state- value function is applied also to the second state of the transition. The estimated value of the second state, when discounted and added to the reward, constitutes the one- step return, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        245,
                                        530,
                                        445
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        245,
                                        530,
                                        445
                                    ],
                                    "type": "text",
                                    "content": ", which is a useful estimate of the actual return and thus is a way of assessing the action. As we have seen in the TD learning of value functions throughout this book, the one- step return is often superior to the actual return in terms of its variance and computational congeniality, even though it introduces bias. We also know how we can flexibly modulate the extent of the bias with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        245,
                                        530,
                                        445
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        245,
                                        530,
                                        445
                                    ],
                                    "type": "text",
                                    "content": "- step returns and eligibility traces (Chapters 7 and 12). When the state- value function is used to assess actions in this way it is called a critic, and the overall policy- gradient method is termed an actor- critic method. Note that the bias in the gradient estimate is not due to bootstrapping as such; the actor would be biased even if the critic was learned by a Monte Carlo method."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        446,
                        530,
                        539
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                446,
                                530,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        446,
                                        530,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "First consider one- step actor- critic methods, the analog of the TD methods introduced in Chapter 6 such as TD(0), Sarsa(0), and Q- learning. The main appeal of one- step methods is that they are fully online and incremental, yet avoid the complexities of eligibility traces. They are a special case of the eligibility trace methods, but easier to understand. One- step actor- critic methods replace the full return of REINFORCE (13.11) with the one- step return (and use a learned state- value function as the baseline) as follows:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        130,
                        552,
                        528,
                        644
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                552,
                                528,
                                644
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        552,
                                        528,
                                        644
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{\\pmb{\\theta}_{t + 1}\\dot{=}\\pmb {\\theta}_t + \\alpha \\Big(G_{t:t + 1} - \\hat{v} (S_t,\\mathbf{w})\\Big)\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}}\\\\ {= \\pmb {\\theta}_t + \\alpha \\Big(R_{t + 1} + \\gamma \\hat{v} (S_{t + 1},\\mathbf{w}) - \\hat{v} (S_t,\\mathbf{w})\\Big)\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}}\\\\ {= \\pmb {\\theta}_t + \\alpha \\delta_t\\frac{\\nabla\\pi(A_t|S_t,\\pmb{\\theta}_t)}{\\pi(A_t|S_t,\\pmb{\\theta}_t)}.} \\end{array} \\tag{13.14}",
                                    "image_path": "3af2ff69d221437592487f29526129b910a43e682c099f3e24b3a91ccfa8ea29.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        658,
                        531,
                        712
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                658,
                                531,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        658,
                                        531,
                                        712
                                    ],
                                    "type": "text",
                                    "content": "The natural state- value- function learning method to pair with this is semi- gradient TD(0). Pseudocode for the complete algorithm is given in the box at the top of the next page. Note that it is now a fully online, incremental algorithm, with states, actions, and rewards processed as they occur and then never revisited."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 10
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        77,
                        140,
                        391,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                140,
                                391,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        140,
                                        391,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "One-step Actor-Critic (episodic), for estimating "
                                },
                                {
                                    "bbox": [
                                        77,
                                        140,
                                        391,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{\\theta} \\approx \\pi_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        164,
                        349,
                        176
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                164,
                                349,
                                176
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        164,
                                        349,
                                        176
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable policy parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        164,
                                        349,
                                        176
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        77,
                        178,
                        406,
                        190
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                178,
                                406,
                                190
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        178,
                                        406,
                                        190
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable state- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        178,
                                        406,
                                        190
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        77,
                        191,
                        267,
                        203
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                191,
                                267,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        191,
                                        267,
                                        203
                                    ],
                                    "type": "text",
                                    "content": "Parameters: step sizes "
                                },
                                {
                                    "bbox": [
                                        77,
                                        191,
                                        267,
                                        203
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta} > 0"
                                },
                                {
                                    "bbox": [
                                        77,
                                        191,
                                        267,
                                        203
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        77,
                                        191,
                                        267,
                                        203
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}} > 0"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        204,
                        459,
                        218
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                204,
                                459,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        204,
                                        459,
                                        218
                                    ],
                                    "type": "text",
                                    "content": "Initialize policy parameter "
                                },
                                {
                                    "bbox": [
                                        77,
                                        204,
                                        459,
                                        218
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\in \\mathbb{R}^{d^{\\prime}}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        204,
                                        459,
                                        218
                                    ],
                                    "type": "text",
                                    "content": " and state- value weights "
                                },
                                {
                                    "bbox": [
                                        77,
                                        204,
                                        459,
                                        218
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        204,
                                        459,
                                        218
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        218,
                        233,
                        231
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                218,
                                233,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        218,
                                        233,
                                        231
                                    ],
                                    "type": "text",
                                    "content": "Loop forever (for each episode):"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        232,
                        257,
                        245
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                232,
                                257,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        232,
                                        257,
                                        245
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        91,
                                        232,
                                        257,
                                        245
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                },
                                {
                                    "bbox": [
                                        91,
                                        232,
                                        257,
                                        245
                                    ],
                                    "type": "text",
                                    "content": " (first state of episode)"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        245,
                        121,
                        256
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                245,
                                121,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        245,
                                        121,
                                        256
                                    ],
                                    "type": "inline_equation",
                                    "content": "I \\leftarrow 1"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        91,
                        259,
                        334,
                        271
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                259,
                                334,
                                271
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        259,
                                        334,
                                        271
                                    ],
                                    "type": "text",
                                    "content": "Loop while "
                                },
                                {
                                    "bbox": [
                                        91,
                                        259,
                                        334,
                                        271
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                },
                                {
                                    "bbox": [
                                        91,
                                        259,
                                        334,
                                        271
                                    ],
                                    "type": "text",
                                    "content": " is not terminal (for each time step):"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        107,
                        271,
                        171,
                        284
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                271,
                                171,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        271,
                                        171,
                                        284
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot |S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        107,
                        285,
                        248,
                        298
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                285,
                                248,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        285,
                                        248,
                                        298
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        107,
                                        285,
                                        248,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        107,
                                        285,
                                        248,
                                        298
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        107,
                                        285,
                                        248,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}, R"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        107,
                        298,
                        451,
                        311
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                298,
                                451,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R + \\gamma \\hat{v} (S^{\\prime}, \\mathbf{w}) - \\hat{v} (S, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "text",
                                    "content": " (if "
                                },
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then "
                                },
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (S^{\\prime}, \\mathbf{w}) \\doteq 0"
                                },
                                {
                                    "bbox": [
                                        107,
                                        298,
                                        451,
                                        311
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        107,
                        313,
                        221,
                        324
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                313,
                                221,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        313,
                                        221,
                                        324
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha^{\\mathbf{w}} \\delta \\nabla \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        107,
                        325,
                        246,
                        337
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                325,
                                246,
                                337
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        325,
                                        246,
                                        337
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\leftarrow \\theta + \\alpha^{\\theta} I \\delta \\nabla \\ln \\pi (A | S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        107,
                        339,
                        143,
                        351
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                339,
                                143,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        339,
                                        143,
                                        351
                                    ],
                                    "type": "inline_equation",
                                    "content": "I \\leftarrow \\gamma I"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        107,
                        351,
                        143,
                        362
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                351,
                                143,
                                362
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        351,
                                        143,
                                        362
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\leftarrow S^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        64,
                        376,
                        490,
                        443
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                376,
                                490,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "The generalizations to the forward view of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "- step methods and then to a "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm are straightforward. The one- step return in (13.12) is merely replaced by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": " respectively. The backward view of the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        490,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm is also straightforward, using separate eligibility traces for the actor and critic, each after the patterns in Chapter 12. Pseudocode for the complete algorithm is given in the box below."
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        76,
                        452,
                        464,
                        468
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                452,
                                464,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        452,
                                        464,
                                        468
                                    ],
                                    "type": "text",
                                    "content": "Actor-Critic with Eligibility Traces (episodic), for estimating "
                                },
                                {
                                    "bbox": [
                                        76,
                                        452,
                                        464,
                                        468
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{\\theta} \\approx \\pi_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 17,
                    "level": 1
                },
                {
                    "bbox": [
                        76,
                        477,
                        348,
                        490
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                477,
                                348,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        477,
                                        348,
                                        490
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable policy parameterization "
                                },
                                {
                                    "bbox": [
                                        76,
                                        477,
                                        348,
                                        490
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        77,
                        491,
                        406,
                        504
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                491,
                                406,
                                504
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        491,
                                        406,
                                        504
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable state- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        491,
                                        406,
                                        504
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        76,
                        505,
                        464,
                        518
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                505,
                                464,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "text",
                                    "content": "Parameters: trace- decay rates "
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda^{\\theta} \\in [0, 1]"
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda^{\\mathbf{w}} \\in [0, 1]"
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "text",
                                    "content": "; step sizes "
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta} > 0"
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        76,
                                        505,
                                        464,
                                        518
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}} > 0"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        77,
                        519,
                        461,
                        532
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                519,
                                461,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        519,
                                        461,
                                        532
                                    ],
                                    "type": "text",
                                    "content": "Initialize policy parameter "
                                },
                                {
                                    "bbox": [
                                        77,
                                        519,
                                        461,
                                        532
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\in \\mathbb{R}^{d^{\\prime}}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        519,
                                        461,
                                        532
                                    ],
                                    "type": "text",
                                    "content": " and state- value weights "
                                },
                                {
                                    "bbox": [
                                        77,
                                        519,
                                        461,
                                        532
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        519,
                                        461,
                                        532
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        77,
                        533,
                        233,
                        545
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                533,
                                233,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        533,
                                        233,
                                        545
                                    ],
                                    "type": "text",
                                    "content": "Loop forever (for each episode):"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        91,
                        546,
                        258,
                        558
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                546,
                                258,
                                558
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        546,
                                        258,
                                        558
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        91,
                                        546,
                                        258,
                                        558
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                },
                                {
                                    "bbox": [
                                        91,
                                        546,
                                        258,
                                        558
                                    ],
                                    "type": "text",
                                    "content": " (first state of episode)"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        91,
                        559,
                        315,
                        573
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                559,
                                315,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        559,
                                        315,
                                        573
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\theta} \\leftarrow \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        559,
                                        315,
                                        573
                                    ],
                                    "type": "text",
                                    "content": " ("
                                },
                                {
                                    "bbox": [
                                        91,
                                        559,
                                        315,
                                        573
                                    ],
                                    "type": "inline_equation",
                                    "content": "d^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        559,
                                        315,
                                        573
                                    ],
                                    "type": "text",
                                    "content": "- component eligibility trace vector)"
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        91,
                        574,
                        314,
                        586
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                574,
                                314,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        574,
                                        314,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\mathbf{w}} \\leftarrow \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        574,
                                        314,
                                        586
                                    ],
                                    "type": "text",
                                    "content": " ("
                                },
                                {
                                    "bbox": [
                                        91,
                                        574,
                                        314,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "d"
                                },
                                {
                                    "bbox": [
                                        91,
                                        574,
                                        314,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "- component eligibility trace vector)"
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        91,
                        587,
                        120,
                        598
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                587,
                                120,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        587,
                                        120,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "I \\leftarrow 1"
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        91,
                        599,
                        334,
                        612
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                599,
                                334,
                                612
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        599,
                                        334,
                                        612
                                    ],
                                    "type": "text",
                                    "content": "Loop while "
                                },
                                {
                                    "bbox": [
                                        91,
                                        599,
                                        334,
                                        612
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                },
                                {
                                    "bbox": [
                                        91,
                                        599,
                                        334,
                                        612
                                    ],
                                    "type": "text",
                                    "content": " is not terminal (for each time step):"
                                }
                            ]
                        }
                    ],
                    "index": 27
                },
                {
                    "bbox": [
                        107,
                        612,
                        171,
                        625
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                612,
                                171,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        612,
                                        171,
                                        625
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot |S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 28
                },
                {
                    "bbox": [
                        107,
                        626,
                        246,
                        639
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                626,
                                246,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        246,
                                        639
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        246,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        246,
                                        639
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        246,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}, R"
                                }
                            ]
                        }
                    ],
                    "index": 29
                },
                {
                    "bbox": [
                        106,
                        639,
                        451,
                        653
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                639,
                                451,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R + \\gamma \\hat{v} (S^{\\prime}, \\mathbf{w}) - \\hat{v} (S, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "text",
                                    "content": " (if "
                                },
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then "
                                },
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (S^{\\prime}, \\mathbf{w}) \\doteq 0"
                                },
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        451,
                                        653
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 30
                },
                {
                    "bbox": [
                        106,
                        653,
                        229,
                        665
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                653,
                                229,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        653,
                                        229,
                                        665
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\mathbf{w}} \\leftarrow \\gamma \\lambda^{\\mathbf{w}} \\mathbf{z}^{\\mathbf{w}} + \\nabla \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 31
                },
                {
                    "bbox": [
                        106,
                        665,
                        254,
                        679
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                665,
                                254,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        665,
                                        254,
                                        679
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\theta} \\leftarrow \\gamma \\lambda^{\\theta} \\mathbf{z}^{\\theta} + I \\nabla \\ln \\pi (A | S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 32
                },
                {
                    "bbox": [
                        106,
                        680,
                        189,
                        692
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                680,
                                189,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        680,
                                        189,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha^{\\mathbf{w}} \\delta \\mathbf{z}^{\\mathbf{w}}"
                                }
                            ]
                        }
                    ],
                    "index": 33
                },
                {
                    "bbox": [
                        106,
                        692,
                        185,
                        705
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                692,
                                185,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        692,
                                        185,
                                        705
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\leftarrow \\theta + \\alpha^{\\theta} \\delta \\mathbf{z}^{\\theta}"
                                }
                            ]
                        }
                    ],
                    "index": 34
                },
                {
                    "bbox": [
                        106,
                        706,
                        183,
                        719
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                706,
                                183,
                                719
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        706,
                                        183,
                                        719
                                    ],
                                    "type": "inline_equation",
                                    "content": "I \\leftarrow \\gamma I"
                                }
                            ]
                        }
                    ],
                    "index": 35
                },
                {
                    "bbox": [
                        106,
                        719,
                        143,
                        731
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                719,
                                143,
                                731
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        719,
                                        143,
                                        731
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\leftarrow S^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 36
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 11
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        136,
                        480,
                        155
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                136,
                                480,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        136,
                                        480,
                                        155
                                    ],
                                    "type": "text",
                                    "content": "13.6 Policy Gradient for Continuing Problems"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        529,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                529,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "As discussed in Section 10.3, for continuing problems without episode boundaries we need to define performance in terms of the average rate of reward per time step:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        130,
                        204,
                        528,
                        296
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                204,
                                528,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        204,
                                        528,
                                        296
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{J(\\pmb\\theta)\\doteq r(\\pi)\\doteq\\lim _{h\\rightarrow\\infty}\\frac{1}{h}\\sum_{t=1}^{h}\\mathbb{E}[R_{t}\\mid S_{0},A_{0:t-1}\\sim\\pi]}}\\\\ {{\\qquad=\\lim _{t\\rightarrow\\infty}\\mathbb{E}[R_{t}\\mid S_{0},A_{0:t-1}\\sim\\pi]}}\\\\ {{\\qquad=\\sum_{s}\\mu(s)\\sum_{a}\\pi(a|s)\\sum_{s^{\\prime},r}p(s^{\\prime},r|s,a)r,}}\\end{array} \\tag{13.15}",
                                    "image_path": "143e138691af317a3d182edfd465cfcd360b46181d45b6deaf66f9e0d71f8312.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        103,
                        306,
                        531,
                        360
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                306,
                                531,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu"
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "text",
                                    "content": " is the steady- state distribution under "
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{\\mu (s)\\doteq \\lim_{t\\to \\infty}\\operatorname *{Pr}\\{S_{t} = s|A_{0:t}\\sim \\pi \\}} \\end{array}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "text",
                                    "content": " which is assumed to exist and to be independent of "
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "text",
                                    "content": " (an ergodicity assumption). Remember that this is the special distribution under which, if you select actions according to "
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        103,
                                        306,
                                        531,
                                        360
                                    ],
                                    "type": "text",
                                    "content": " , you remain in the same distribution:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        130,
                        372,
                        528,
                        399
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                372,
                                528,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        372,
                                        528,
                                        399
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\sum_{s} \\mu (s) \\sum_{a} \\pi (a | s, \\theta) p(s' | s, a) = \\mu (s'), \\text{for all} s' \\in \\mathcal{S}. \\tag{13.16}",
                                    "image_path": "bd55f2e754c1ffa0489fab13d5cb48df9a0bca251e133cde82e170e660b514bb.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        103,
                        410,
                        529,
                        437
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                410,
                                529,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        410,
                                        529,
                                        437
                                    ],
                                    "type": "text",
                                    "content": "Complete pseudocode for the actor- critic algorithm in the continuing case (backward view) is given in the box below."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        117,
                        454,
                        517,
                        469
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                454,
                                517,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        454,
                                        517,
                                        469
                                    ],
                                    "type": "text",
                                    "content": "Actor-Critic with Eligibility Traces (continuing), for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        454,
                                        517,
                                        469
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi_{\\theta} \\approx \\pi_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        478,
                        389,
                        492
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                478,
                                389,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        478,
                                        389,
                                        492
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable policy parameterization "
                                },
                                {
                                    "bbox": [
                                        117,
                                        478,
                                        389,
                                        492
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a | s, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        117,
                        493,
                        446,
                        504
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                493,
                                446,
                                504
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        493,
                                        446,
                                        504
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable state- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        117,
                                        493,
                                        446,
                                        504
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        117,
                        506,
                        464,
                        519
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                506,
                                464,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: "
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda^{\\mathbf{w}} \\in [0, 1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda^{\\theta} \\in [0, 1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\mathbf{w}} > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\theta} > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        506,
                                        464,
                                        519
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha^{\\bar{R}} > 0"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        117,
                        521,
                        253,
                        532
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                521,
                                253,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        521,
                                        253,
                                        532
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        521,
                                        253,
                                        532
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        117,
                                        521,
                                        253,
                                        532
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        117,
                        534,
                        499,
                        547
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                534,
                                499,
                                547
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        534,
                                        499,
                                        547
                                    ],
                                    "type": "text",
                                    "content": "Initialize state- value weights "
                                },
                                {
                                    "bbox": [
                                        117,
                                        534,
                                        499,
                                        547
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        117,
                                        534,
                                        499,
                                        547
                                    ],
                                    "type": "text",
                                    "content": " and policy parameter "
                                },
                                {
                                    "bbox": [
                                        117,
                                        534,
                                        499,
                                        547
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\in \\mathbb{R}^{d'}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        534,
                                        499,
                                        547
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to 0)"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        117,
                        548,
                        252,
                        560
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                548,
                                252,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        548,
                                        252,
                                        560
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        548,
                                        252,
                                        560
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\in \\mathcal{S}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        548,
                                        252,
                                        560
                                    ],
                                    "type": "text",
                                    "content": " (e.g., to "
                                },
                                {
                                    "bbox": [
                                        117,
                                        548,
                                        252,
                                        560
                                    ],
                                    "type": "inline_equation",
                                    "content": "s_0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        548,
                                        252,
                                        560
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        117,
                        567,
                        340,
                        580
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                567,
                                340,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        567,
                                        340,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\mathbf{w}} \\leftarrow \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        567,
                                        340,
                                        580
                                    ],
                                    "type": "text",
                                    "content": " (d- component eligibility trace vector)"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        117,
                        581,
                        340,
                        593
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                581,
                                340,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        581,
                                        340,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\theta} \\leftarrow \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        581,
                                        340,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " (d'- component eligibility trace vector)"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        117,
                        595,
                        282,
                        607
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                595,
                                282,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        595,
                                        282,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "Loop forever (for each time step):"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        132,
                        607,
                        195,
                        620
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                607,
                                195,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        607,
                                        195,
                                        620
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot | S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        132,
                        621,
                        275,
                        633
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                621,
                                275,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        621,
                                        275,
                                        633
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        621,
                                        275,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        132,
                                        621,
                                        275,
                                        633
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        132,
                                        621,
                                        275,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "S', R"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        132,
                        634,
                        283,
                        647
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                634,
                                283,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        634,
                                        283,
                                        647
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R - \\bar{R} + \\hat{v} (S', \\mathbf{w}) - \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        132,
                        648,
                        194,
                        660
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                648,
                                194,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        648,
                                        194,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} \\leftarrow \\bar{R} + \\alpha^{\\bar{R}} \\delta"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        132,
                        661,
                        248,
                        674
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                661,
                                248,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        661,
                                        248,
                                        674
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\mathbf{w}} \\leftarrow \\lambda^{\\mathbf{w}} \\mathbf{z}^{\\mathbf{w}} + \\nabla \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        132,
                        675,
                        266,
                        688
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                675,
                                266,
                                688
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        675,
                                        266,
                                        688
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}^{\\theta} \\leftarrow \\lambda^{\\theta} \\mathbf{z}^{\\theta} + \\nabla \\ln \\pi (A | S, \\theta)"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        132,
                        689,
                        216,
                        701
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                689,
                                216,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        689,
                                        216,
                                        701
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha^{\\mathbf{w}} \\delta \\mathbf{z}^{\\mathbf{w}}"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        132,
                        701,
                        209,
                        714
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                701,
                                209,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        701,
                                        209,
                                        714
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta \\leftarrow \\theta + \\alpha^{\\theta} \\delta \\mathbf{z}^{\\theta}"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        132,
                        714,
                        194,
                        728
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                714,
                                194,
                                728
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        714,
                                        194,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\leftarrow S'"
                                }
                            ]
                        }
                    ],
                    "index": 24
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 12
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "Naturally, in the continuing case, we define values, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}(s) \\doteq \\mathbb{E}_{\\pi}[G_{t}|S_{t} = s]"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}(s,a) \\doteq \\mathbb{E}_{\\pi}[G_{t}|S_{t} = s, A_{t} = a]"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": ", with respect to the differential return:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        186,
                        489,
                        202
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                186,
                                489,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        186,
                                        489,
                                        202
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t} \\doteq R_{t + 1} - r(\\pi) + R_{t + 2} - r(\\pi) + R_{t + 3} - r(\\pi) + \\dots . \\tag{13.17}",
                                    "image_path": "7896f94f74a01364e7b723028cfdb6a07c66c4dc75cd0367fb8355b1ad965d9e.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        219,
                        489,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                219,
                                489,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        219,
                                        489,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "With these alternate definitions, the policy gradient theorem as given for the episodic case (13.5) remains true for the continuing case. A proof is given in the box on the next page. The forward and backward view equations also remain the same."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        76,
                        264,
                        392,
                        278
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                264,
                                392,
                                278
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        264,
                                        392,
                                        278
                                    ],
                                    "type": "text",
                                    "content": "Proof of the Policy Gradient Theorem (continuing case)"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        288,
                        477,
                        369
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                288,
                                477,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": "The proof of the policy gradient theorem for the continuing case begins similarly to the episodic case. Again we leave it implicit in all cases that "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": " is a function of "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": " and that the gradients are with respect to "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": ". Recall that in the continuing case "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "J(\\theta) = r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": " (13.15) and that "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": " denote values with respect to the differential return (13.17). The gradient of the state- value function can be written, for any "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\in \\mathbb{S}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        477,
                                        369
                                    ],
                                    "type": "text",
                                    "content": ", as"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        82,
                        377,
                        476,
                        510
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                82,
                                377,
                                476,
                                510
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        377,
                                        476,
                                        510
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\nabla v_{\\pi}(s) = \\nabla \\left[\\sum_{a}\\pi (a|s)q_{\\pi}(s,a)\\right],\\quad \\mathrm{for~all~}s\\in \\mathcal{S}}\\\\ & {\\qquad = \\sum_{a}\\left[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\nabla q_{\\pi}(s,a)\\right]\\qquad \\mathrm{(product~rule~of~cal{c u l u s})}}\\\\ & {\\qquad = \\sum_{a}\\left[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\nabla \\sum_{s^{\\prime},r}p(s^{\\prime},r|s,a)\\big(r - r(\\pmb {\\theta}) + v_{\\pi}(s^{\\prime})\\big)\\right]}\\\\ & {\\qquad = \\sum_{a}\\left[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\big[-\\nabla r(\\pmb {\\theta}) + \\sum_{s^{\\prime}}p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime})\\big]\\right].} \\end{array} \\tag{Exercise 3.18}",
                                    "image_path": "d08747a8ed9de795990320e1c5ea0dc490b1e623d4c1644f099c0cd56ed5b823.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        77,
                        518,
                        252,
                        532
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                518,
                                252,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        518,
                                        252,
                                        532
                                    ],
                                    "type": "text",
                                    "content": "After re- arranging terms, we obtain"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        106,
                        542,
                        446,
                        570
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                542,
                                446,
                                570
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        542,
                                        446,
                                        570
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla r(\\pmb {\\theta}) = \\sum_{a}\\left[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\sum_{s^{\\prime}}p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime})\\right] - \\nabla v_{\\pi}(s).",
                                    "image_path": "c0224d03597c6bf298a6d0f0e502f253f6db6ad99ec108f4553f78780398e4f5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        77,
                        579,
                        476,
                        621
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                579,
                                476,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": "Notice that the left- hand side can be written "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla J(\\theta)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": ", and that it does not depend on "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": ". Thus the right- hand side does not depend on "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": " either, and we can safely sum it over all "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\in \\mathbb{S}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": ", weighted by "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu (s)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": ", without changing it (because "
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sum_{s} \\mu (s) = 1"
                                },
                                {
                                    "bbox": [
                                        77,
                                        579,
                                        476,
                                        621
                                    ],
                                    "type": "text",
                                    "content": "):"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        76,
                        631,
                        474,
                        729
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                631,
                                474,
                                729
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        631,
                                        474,
                                        729
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{\\nabla J(\\pmb {\\theta}) = \\sum_{s}\\mu (s)\\left(\\sum_{a}\\left[\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\pi (a|s)\\sum_{s^{\\prime}}p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime})\\right] - \\nabla v_{\\pi}(s)\\right)}\\\\ {= \\sum_{s}\\mu (s)\\sum_{a}\\nabla \\tau (a|s)q_{\\pi}(s,a)}\\\\ {\\qquad +\\sum_{s}\\mu (s)\\sum_{a}\\pi (a|s)\\sum_{s^{\\prime}}p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime}) - \\sum_{s}\\mu (s)\\nabla v_{\\pi}(s)} \\end{array}",
                                    "image_path": "4024ee165146aa5d16d0eb6fdcfb753b9349850df22b35fefce0b8dbc54ccf63.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 13
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        149,
                        147,
                        476,
                        284
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                149,
                                147,
                                476,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        149,
                                        147,
                                        476,
                                        284
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\quad = \\sum_{s}\\mu (s)\\sum_{a}\\nabla \\pi (a|s)q_{\\pi}(s,a)}\\\\ & {\\qquad +\\sum_{s}\\sum_{s}\\mu (s)\\sum_{a}\\pi (a|s)p(s^{\\prime}|s,a)\\nabla v_{\\pi}(s^{\\prime}) - \\sum_{a}\\mu (s)\\nabla v_{\\pi}(s)}\\\\ & {\\qquad \\quad \\mu (s^{\\prime})\\mathrm{~(13.16)}}\\\\ & {\\quad = \\sum_{s}\\mu (s)\\sum_{a}\\nabla \\pi (a|s)q_{\\pi}(s,a) + \\sum_{s^{\\prime}}\\mu (s^{\\prime})\\nabla v_{\\pi}(s^{\\prime}) - \\sum_{s}\\mu (s)\\nabla v_{\\pi}(s)}\\\\ & {\\quad = \\sum_{s}\\mu (s)\\sum_{a}\\nabla \\pi (a|s)q_{\\pi}(s,a).\\qquad \\mathrm{Q.E.D.}} \\end{array}",
                                    "image_path": "f07734787783088af62cc2950fcca36b151230b5cd059f03289880bf616125a0.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        105,
                        315,
                        529,
                        334
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                315,
                                529,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        315,
                                        529,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "13.7 Policy Parameterization for Continuous Actions"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        345,
                        529,
                        412
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                345,
                                529,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        345,
                                        529,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "Policy- based methods offer practical ways of dealing with large action spaces, even continuous spaces with an infinite number of actions. Instead of computing learned probabilities for each of the many actions, we instead learn statistics of the probability distribution. For example, the action set might be the real numbers, with actions chosen from a normal (Gaussian) distribution."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        115,
                        413,
                        526,
                        426
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                115,
                                413,
                                526,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        413,
                                        526,
                                        426
                                    ],
                                    "type": "text",
                                    "content": "The probability density function for the normal distribution is conventionally written"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        131,
                        431,
                        528,
                        463
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                431,
                                528,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        431,
                                        528,
                                        463
                                    ],
                                    "type": "interline_equation",
                                    "content": "p(x) \\doteq \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp \\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right), \\tag{13.18}",
                                    "image_path": "ec0a2a07decf45bb81469a9166b1035b8cb8d223734911545b200c22f9a04906.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        468,
                        312,
                        639
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                468,
                                312,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " here are the mean and standard deviation of the normal distribution, and of course "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " here is just the number "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi \\approx 3.14159"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": ". The probability density functions for several different means and standard deviations are shown to the right. The value "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "p(x)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " is the density of the probability at "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": ", not the probability. It can be greater than 1; it is the total area under "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "p(x)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " that must sum to 1. In general, one can take the integral under "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "p(x)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " for any range of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " values to get the probability of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "x"
                                },
                                {
                                    "bbox": [
                                        104,
                                        468,
                                        312,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " falling within that range."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "image",
                    "bbox": [
                        320,
                        479,
                        544,
                        631
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                320,
                                479,
                                544,
                                631
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        320,
                                        479,
                                        544,
                                        631
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                320,
                                                479,
                                                544,
                                                631
                                            ],
                                            "type": "image",
                                            "image_path": "1c244db24714346000e090063c21bdddfb2c506cc1263ed82aade530f906a39d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "type": "image_body"
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        641,
                        530,
                        682
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                641,
                                530,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        641,
                                        530,
                                        682
                                    ],
                                    "type": "text",
                                    "content": "To produce a policy parameterization, the policy can be defined as the normal probability density over a real- valued scalar action, with mean and standard deviation given by parametric function approximators that depend on the state. That is,"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        131,
                        687,
                        528,
                        718
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                687,
                                528,
                                718
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        687,
                                        528,
                                        718
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pi (a|s, \\theta) \\doteq \\frac{1}{\\sigma(s, \\theta)\\sqrt{2\\pi}} \\exp \\left(-\\frac{(a - \\mu(s, \\theta))^2}{2\\sigma(s, \\theta)^2}\\right), \\tag{13.19}",
                                    "image_path": "e66bc71854c8d251b37fff96564dcc05fa1af52d7543f7f8812ed33f09818793.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        102,
                        725,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                725,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        725,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        102,
                                        725,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu : \\mathcal{S} \\times \\mathbb{R}^{d'} \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        102,
                                        725,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        102,
                                        725,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma : \\mathcal{S} \\times \\mathbb{R}^{d'} \\to \\mathbb{R}^+"
                                },
                                {
                                    "bbox": [
                                        102,
                                        725,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " are two parameterized function approximators."
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 14
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        490,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                490,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "To complete the example we need only give a form for these approximators. For this we divide the policy's parameter vector into two parts, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb {\\theta} = [\\pmb{\\theta}_{\\mu},\\pmb{\\theta}_{\\sigma}]^{\\top}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", one part to be used for the approximation of the mean and one part for the approximation of the standard deviation. The mean can be approximated as a linear function. The standard deviation must always be positive and is better approximated as the exponential of a linear function. Thus"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        229,
                        489,
                        253
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                229,
                                489,
                                253
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        229,
                                        489,
                                        253
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mu (s,\\pmb {\\theta})\\doteq \\pmb{\\theta}_{\\mu}^{\\top}\\mathbf{x}_{\\mu}(s)\\quad \\mathrm{and}\\quad \\sigma (s,\\pmb {\\theta})\\doteq \\exp \\Big(\\pmb{\\theta}_{\\sigma}^{\\top}\\mathbf{x}_{\\sigma}(s)\\Big), \\tag{13.20}",
                                    "image_path": "4b887fba7b5836b39f55b50384a7271b18104a30ad400e688a3b6fbf985d895f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        264,
                        489,
                        304
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                264,
                                489,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        264,
                                        489,
                                        304
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        264,
                                        489,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_{\\mu}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        264,
                                        489,
                                        304
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        264,
                                        489,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_{\\sigma}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        264,
                                        489,
                                        304
                                    ],
                                    "type": "text",
                                    "content": " are state feature vectors perhaps constructed by one of the methods described in Section 9.5. With these definitions, all the algorithms described in the rest of this chapter can be applied to learn to select real- valued actions."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        310,
                        489,
                        337
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                310,
                                489,
                                337
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        310,
                                        489,
                                        337
                                    ],
                                    "type": "text",
                                    "content": "Exercise 13.4 Show that for the Gaussian policy parameterization (Equations 13.19 and 13.20) the eligibility vector has the following two parts:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        92,
                        351,
                        404,
                        379
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                351,
                                404,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        351,
                                        404,
                                        379
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla \\ln \\pi (a|s,\\pmb{\\theta}_{\\mu}) = \\frac{\\nabla\\pi(a|s,\\pmb{\\theta}_{\\mu})}{\\pi(a|s,\\pmb{\\theta})} = \\frac{1}{\\sigma(s,\\pmb{\\theta})^{2}} (a - \\mu (s,\\pmb {\\theta}))\\mathbf{x}_{\\mu}(s),\\mathrm{and}",
                                    "image_path": "292367e62d9732125a7e8fec4293311eafe2b254c0bd32069b1c132d0878aa7f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        91,
                        396,
                        387,
                        432
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                396,
                                387,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        396,
                                        387,
                                        432
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\nabla \\ln \\pi (a|s,\\pmb{\\theta}_{\\sigma}) = \\frac{\\nabla\\pi(a|s,\\pmb{\\theta}_{\\sigma})}{\\pi(a|s,\\pmb{\\theta})} = \\left(\\frac{(a - \\mu(s,\\pmb{\\theta}))^{2}}{\\sigma(s,\\pmb{\\theta})^{2}} -1\\right)\\mathbf{x}_{\\sigma}(s).",
                                    "image_path": "3beb10e197b465f6c0ef719ebabb82455090ba017c82040a409567ca760ed549.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        446,
                        490,
                        540
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                446,
                                490,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": "Exercise 13.5 A Bernoulli- logistic unit is a stochastic neuron- like unit used in some ANNs (Section 9.7). Its input at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " is a feature vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(S_{t})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": "; its output, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": ", is a random variable having two values, 0 and 1, with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname *{Pr}\\{A_{t} = 1\\} = P_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname *{Pr}\\{A_{t} = 0\\} = 1 - P_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " (the Bernoulli distribution). Let "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "h(s,0,\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "h(s,1,\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " be the preferences in state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " for the unit's two actions given policy parameter "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": ". Assume that the difference between the action preferences is given by a weighted sum of the unit's input vector, that is, assume that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "h(s,1,\\pmb {\\theta}) - h(s,0,\\pmb {\\theta}) = \\pmb{\\theta}^{\\top}\\mathbf{x}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": ", where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        446,
                                        490,
                                        540
                                    ],
                                    "type": "text",
                                    "content": " is the unit's weight vector."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        71,
                        551,
                        489,
                        592
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                71,
                                551,
                                489,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        551,
                                        489,
                                        592
                                    ],
                                    "type": "text",
                                    "content": "(a) Show that if the exponential soft-max distribution (13.2) is used to convert action preferences to policies, then "
                                },
                                {
                                    "bbox": [
                                        71,
                                        551,
                                        489,
                                        592
                                    ],
                                    "type": "inline_equation",
                                    "content": "P_{t} = \\pi (1|S_{t},\\pmb{\\theta}_{t}) = 1 / (1 + \\exp (-\\pmb{\\theta}_{t}^{\\top}\\mathbf{x}(S_{t})))"
                                },
                                {
                                    "bbox": [
                                        71,
                                        551,
                                        489,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " (the logistic function)."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        70,
                        606,
                        489,
                        633
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                70,
                                606,
                                489,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "text",
                                    "content": "(b) What is the Monte-Carlo REINFORCE update of "
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}_{t}"
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "text",
                                    "content": " to "
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "text",
                                    "content": " upon receipt of return "
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}"
                                },
                                {
                                    "bbox": [
                                        70,
                                        606,
                                        489,
                                        633
                                    ],
                                    "type": "text",
                                    "content": "?"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        71,
                        647,
                        490,
                        675
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                71,
                                647,
                                490,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "text",
                                    "content": "(c) Express the eligibility "
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla \\ln \\pi (a|s,\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "text",
                                    "content": " for a Bernoulli-logistic unit, in terms of "
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(s)"
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|s,\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        71,
                                        647,
                                        490,
                                        675
                                    ],
                                    "type": "text",
                                    "content": " by calculating the gradient."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        64,
                        686,
                        489,
                        741
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                686,
                                489,
                                741
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": "Hint for part (c): Define "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "P = \\pi (1|s,\\pmb {\\theta})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": " and compute the derivative of the logarithm, for each action, using the chain rule on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "P"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": ". Combine the two results into one expression that depends on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "P"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": ", and then use the chain rule again, this time on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{\\theta}^{\\top}\\mathbf{x}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": ", noting that the derivative of the logistic function "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "f(x) = 1 / (1 + e^{- x})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": " is "
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "f(x)(1 - f(x))"
                                },
                                {
                                    "bbox": [
                                        64,
                                        686,
                                        489,
                                        741
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 10
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 15
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        137,
                        230,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                137,
                                230,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        137,
                                        230,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "13.8 Summary"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        166,
                        530,
                        259
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                166,
                                530,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        166,
                                        530,
                                        259
                                    ],
                                    "type": "text",
                                    "content": "Prior to this chapter, this book focused on action- value methods- meaning methods that learn action values and then use them to determine action selections. In this chapter, on the other hand, we considered methods that learn a parameterized policy that enables actions to be taken without consulting action- value estimates. In particular, we have considered policy- gradient methods- meaning methods that update the policy parameter on each step in the direction of an estimate of the gradient of performance with respect to the policy parameter."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        261,
                        530,
                        353
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                261,
                                530,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        261,
                                        530,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "Methods that learn and store a policy parameter have many advantages. They can learn specific probabilities for taking the actions. They can learn appropriate levels of exploration and approach deterministic policies asymptotically. They can naturally handle continuous action spaces. All these things are easy for policy- based methods but awkward or impossible for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        261,
                                        530,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        104,
                                        261,
                                        530,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " - greedy methods and for action- value methods in general. In addition, on some problems the policy is just simpler to represent parametrically than the value function; these problems are more suited to parameterized policy methods."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        355,
                        530,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                355,
                                530,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        355,
                                        530,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "Parameterized policy methods also have an important theoretical advantage over action- value methods in the form of the policy gradient theorem, which gives an exact formula for how performance is affected by the policy parameter that does not involve derivatives of the state distribution. This theorem provides a theoretical foundation for all policy gradient methods."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        421,
                        530,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                421,
                                530,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        421,
                                        530,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "The REINFORCE method follows directly from the policy gradient theorem. Adding a state- value function as a baseline reduces REINFORCE's variance without introducing bias. If the state- value function is also used to assess or criticize the policy's action selections, then the value function is called a critic and the policy is called an actor; the overall method is called an actor- critic method. The critic introduces bias into the actor's gradient estimates, but is often desirable for the same reason that bootstrapping TD methods are often superior to Monte Carlo methods (substantially reduced variance)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        516,
                        530,
                        555
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                516,
                                530,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        516,
                                        530,
                                        555
                                    ],
                                    "type": "text",
                                    "content": "Overall, policy- gradient methods provide a significantly different set of strengths and weaknesses than action- value methods. Today they are less well understood in some respects, but a subject of excitement and ongoing research."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        577,
                        415,
                        596
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                577,
                                415,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        577,
                                        415,
                                        596
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical Remarks"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        607,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                607,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical RemarksMethods that we now see as related to policy gradients were actually some of the earliest to be studied in reinforcement learning (Witten, 1977; Barto, Sutton, and Anderson, 1983; Sutton, 1984; Williams, 1987, 1992) and in predecessor fields (see Phansalkar and Thathachar, 1995). They were largely supplanted in the 1990s by the action- value methods that are the focus of the other chapters of this book. In recent years, however, attention has returned to actor- critic methods and to policy- gradient methods in general. Among the further developments beyond what we cover here are natural- gradient methods (Amari, 1998; Kakade, 2002, Peters, Vijayakumar and Schaal, 2005; Peters and Schaal, 2008; Park, Kim and Kang, 2005; Bhatnagar, Sutton, Ghawamzadeh and Lee, 2009; see Grondman, Busontu, Lopes and Babuska, 2012), deterministic policy- gradient methods"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 16
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        141,
                        490,
                        180
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                141,
                                490,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        141,
                                        490,
                                        180
                                    ],
                                    "type": "text",
                                    "content": "(Silver et al., 2014), off- policy policy- gradient methods (Degris, White, and Sutton, 2012; Maei, 2018), and entropy regularization (see Schulman, Chen, and Abbed, 2017). Major applications include acrobatic helicopter autopilots and AlphaGo (Section 16.6)."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        182,
                        489,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                182,
                                489,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        182,
                                        489,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "Our presentation in this chapter is based primarily on that by Sutton, McAllester, Singh, and Mansour (2000), who introduced the term \"policy gradient methods.\" A useful overview is provided by Bhatnagar et al. (2009). One of the earliest related works is by Aleksandrov, Sysoyev, and Shemeneva (1968). Thomas (2014) first realized that the factor of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        182,
                                        489,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        182,
                                        489,
                                        261
                                    ],
                                    "type": "text",
                                    "content": ", as specified in the boxed algorithms of this chapter, was needed in the case of discounted episodic problems."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        273,
                        489,
                        299
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                273,
                                489,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        273,
                                        489,
                                        299
                                    ],
                                    "type": "text",
                                    "content": "13.1 Example 13.1 and the results with it in this chapter were developed with Eric Graves."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        313,
                        489,
                        391
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                313,
                                489,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        313,
                                        489,
                                        391
                                    ],
                                    "type": "text",
                                    "content": "13.2 The policy gradient theorem here and on page 334 was first obtained by Marbach and Tsitsiklis (1998, 2001) and then independently by Sutton et al. (2000). A similar expression was obtained by Cao and Chen (1997). Other early results are due to Konda and Tsitsiklis (2000, 2003), Baxter and Bartlett (2001), and Baxter, Bartlett, and Weaver (2001). Some additional results are developed by Sutton, Singh, and McAllester (2000)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        65,
                        404,
                        489,
                        442
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                404,
                                489,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        404,
                                        489,
                                        442
                                    ],
                                    "type": "text",
                                    "content": "13.3 REINFORCE is due to Williams (1987, 1992). Phansalkar and Thathachar (1995) proved both local and global convergence theorems for modified versions of REINFORCE algorithms."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        448,
                        489,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                448,
                                489,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        489,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "The all- actions algorithm was first presented in an unpublished but widely circulated incomplete paper (Sutton, Singh, and McAllester, 2000) and then developed further by Ciosek and Whiteson (2017, 2018), who termed it \"expected policy gradients,\" and by Asadi, Allen, Roderick, Mohamed, Konidaris, and Littman (2017), who called it \"mean actor critic.\""
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        527,
                        490,
                        580
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                527,
                                490,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        527,
                                        490,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "13.4 The baseline was introduced in Williams's (1987, 1992) original work. Greensmith, Bartlett, and Baxter (2004) analyzed an arguably better baseline (see Dick, 2015). Thomas and Brunskill (2017) argue that an action- dependent baseline can be used without incurring bias."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        591,
                        489,
                        658
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                591,
                                489,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        591,
                                        489,
                                        658
                                    ],
                                    "type": "text",
                                    "content": "13.5- 6 Actor- critic methods were among the earliest to be investigated in reinforcement learning (Witten, 1977; Barto, Sutton, and Anderson, 1983; Sutton, 1984). The algorithms presented here are based on the work of Degris, White, and Sutton (2012). Actor- critic methods are sometimes referred to as advantage actor- critic (\"A2C\") methods in the literature."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        671,
                        489,
                        710
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                671,
                                489,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        671,
                                        489,
                                        710
                                    ],
                                    "type": "text",
                                    "content": "13.7 The first to show how continuous actions could be handled this way appears to have been Williams (1987, 1992). The figure on page 335 is adapted from Wikipedia."
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 17
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.0.6"
}
{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        214,
                        233,
                        240
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                214,
                                233,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        214,
                                        233,
                                        240
                                    ],
                                    "type": "text",
                                    "content": "Chapter 12"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        267,
                        334,
                        298
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                267,
                                334,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        267,
                                        334,
                                        298
                                    ],
                                    "type": "text",
                                    "content": "Eligibility Traces"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        339,
                        530,
                        392
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                339,
                                530,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "Eligibility traces are one of the basic mechanisms of reinforcement learning. For example, in the popular TD(λ) algorithm, the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        392
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        339,
                                        530,
                                        392
                                    ],
                                    "type": "text",
                                    "content": " refers to the use of an eligibility trace. Almost any temporal- difference (TD) method, such as Q- learning or Sargs, can be combined with eligibility traces to obtain a more general method that may learn more efficiently."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        394,
                        530,
                        474
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                394,
                                530,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        394,
                                        530,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "Eligibility traces unify and generalize TD and Monte Carlo methods. When TD methods are augmented with eligibility traces, they produce a family of methods spanning a spectrum that has Monte Carlo methods at one end ("
                                },
                                {
                                    "bbox": [
                                        104,
                                        394,
                                        530,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        394,
                                        530,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ") and one- step TD methods at the other ("
                                },
                                {
                                    "bbox": [
                                        104,
                                        394,
                                        530,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        394,
                                        530,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "). In between are intermediate methods that are often better than either extreme method. Eligibility traces also provide a way of implementing Monte Carlo methods online and on continuing problems without episodes."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        475,
                        530,
                        593
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                475,
                                530,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "Of course, we have already seen one way of unifying TD and Monte Carlo methods: the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "- step TD methods of Chapter 7. What eligibility traces offer beyond these is an elegant algorithmic mechanism with significant computational advantages. The mechanism is a short- term memory vector, the eligibility trace "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": ", that parallels the long- term weight vector "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": ". The rough idea is that when a component of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " participates in producing an estimated value, then the corresponding component of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " is bumped up and then begins to fade away. Learning will then occur in that component of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " if a nonzero TD error occurs before the trace falls back to zero. The trace- decay parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0,1]"
                                },
                                {
                                    "bbox": [
                                        104,
                                        475,
                                        530,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " determines the rate at which the trace falls."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        595,
                        530,
                        661
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                595,
                                530,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "The primary computational advantage of eligibility traces over "
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "- step methods is that only a single trace vector is required rather than a store of the last "
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "text",
                                    "content": " feature vectors. Learning also occurs continually and uniformly in time rather than being delayed and then catching up at the end of the episode. In addition learning can occur and affect behavior immediately after a state is encountered rather than being delayed "
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        530,
                                        661
                                    ],
                                    "type": "text",
                                    "content": " steps."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        663,
                        530,
                        729
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                663,
                                530,
                                729
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        663,
                                        530,
                                        729
                                    ],
                                    "type": "text",
                                    "content": "Eligibility traces illustrate that a learning algorithm can sometimes be implemented in a different way to obtain computational advantages. Many algorithms are most naturally formulated and understood as an update of a state's value based on events that follow that state over multiple future time steps. For example, Monte Carlo methods (Chapter 5) update a state based on all the future rewards, and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        663,
                                        530,
                                        729
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        663,
                                        530,
                                        729
                                    ],
                                    "type": "text",
                                    "content": "- step TD methods (Chapter 7)"
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 0
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        286
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": "update based on the next "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": " rewards and state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": " steps in the future. Such formulations, based on looking forward from the updated state, are called forward views. Forward views are always somewhat complex to implement because the update depends on later things that are not available at the time. However, as we show in this chapter it is often possible to achieve nearly the same updates—and sometimes exactly the same updates—with an algorithm that uses the current TD error, looking backward to recently visited states using an eligibility trace. These alternate ways of looking at and implementing learning algorithms are called backward views. Backward views, transformations between forward views and backward views, and equivalences between them, date back to the introduction of temporal difference learning but have become much more powerful and sophisticated since 2014. Here we present the basics of the modern view."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        287,
                        489,
                        367
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                287,
                                489,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        287,
                                        489,
                                        367
                                    ],
                                    "type": "text",
                                    "content": "As usual, first we fully develop the ideas for state values and prediction, then extend them to action values and control. We develop them first for the on- policy case then extend them to off- policy learning. Our treatment pays special attention to the case of linear function approximation, for which the results with eligibility traces are stronger. All these results apply also to the tabular and state aggregation cases because these are special cases of linear function approximation."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        387,
                        217,
                        404
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                387,
                                217,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        217,
                                        404
                                    ],
                                    "type": "text",
                                    "content": "12.1 The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        217,
                                        404
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        217,
                                        404
                                    ],
                                    "type": "text",
                                    "content": "-return"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        416,
                        489,
                        456
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                416,
                                489,
                                456
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "text",
                                    "content": "In Chapter 7 we defined an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "text",
                                    "content": "- step return as the sum of the first "
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "text",
                                    "content": " rewards plus the estimated value of the state reached in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        416,
                                        489,
                                        456
                                    ],
                                    "type": "text",
                                    "content": " steps, each appropriately discounted (7.1). The general form of that equation, for any parameterized function approximator, is"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        80,
                        463,
                        488,
                        478
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                80,
                                463,
                                488,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        463,
                                        488,
                                        478
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^n \\hat{v} (S_{t + n}, \\mathbf{w}_{t + n - 1}), \\quad 0 \\leq t \\leq T - n, \\tag{12.1}",
                                    "image_path": "2a26b1576eed49bb5155d9bcf6df438c8d1ef8d1676346c3ab824f6de99c8457.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        484,
                        489,
                        538
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                484,
                                489,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " is the approximate value of state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " given weight vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " (Chapter 9), and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " is the time of episode termination, if any. We noted in Chapter 7 that each "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": "- step return, for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "n \\geq 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        489,
                                        538
                                    ],
                                    "type": "text",
                                    "content": ", is a valid update target for a tabular learning update, just as it is for an approximate SGD learning update such as (9.7)."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        539,
                        489,
                        698
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                539,
                                489,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "Now we note that a valid update can be done not just toward any "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "- step return, but toward any average of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "- step returns for different "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "s. For example, an update can be done toward a target that is half of a two- step return and half of a four- step return: "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac{1}{2} G_{t:t + 2} + \\frac{1}{2} G_{t:t + 4}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": ". Any set of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "- step returns can be averaged in this way, even an infinite set, as long as the weights on the component returns are positive and sum to 1. The composite return possesses an error reduction property similar to that of individual "
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        539,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "- step returns (7.3) and thus can be used to construct updates with guaranteed convergence properties. Averaging produces a substantial new range of algorithms. For example, one could average one- step and infinite- step returns to obtain another way of interrelating TD and Monte Carlo methods. In principle, one could even average experience- based updates with DP updates to get a simple combination of experience- based and model- based methods (cf. Chapter 8)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        699,
                        489,
                        739
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                699,
                                489,
                                739
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        699,
                                        489,
                                        739
                                    ],
                                    "type": "text",
                                    "content": "An update that averages simpler component updates is called a compound update. The backup diagram for a compound update consists of the backup diagrams for each of the component updates with a horizontal line above them and the weighting fractions below."
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 1
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        471,
                        234
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                471,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        471,
                                        234
                                    ],
                                    "type": "text",
                                    "content": "For example, the compound update for the case mentioned at the start of this section, mixing half of a two- step return and half of a four- step return, has the diagram shown to the right. A compound update can only be done when the longest of its component updates is complete. The update at the right, for example, could only be done at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        471,
                                        234
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + 4"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        471,
                                        234
                                    ],
                                    "type": "text",
                                    "content": " for the estimate formed at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        471,
                                        234
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        471,
                                        234
                                    ],
                                    "type": "text",
                                    "content": ". In general one would like to limit the length of the longest component update because of the corresponding delay in the updates."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        234,
                        471,
                        301
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                234,
                                471,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": " algorithm can be understood as one particular way of averaging "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "- step updates. This average contains all the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "- step updates, each weighted proportionally to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda^{n - 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": " (where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0,1)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "), and is normalized by a factor of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 - \\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": " to ensure that the weights sum to 1 (Figure 12.1). The resulting update is toward a return, called the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        234,
                                        471,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "- return, defined in its state- based form by"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        132,
                        315,
                        470,
                        351
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                315,
                                470,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        315,
                                        470,
                                        351
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda} \\doteq (1 - \\lambda) \\sum_{n = 1}^{\\infty} \\lambda^{n - 1} G_{t:t + n}. \\tag{12.2}",
                                    "image_path": "345fd2e7b6e8e91f570ddde26b820af39b2d8dc042d4d8285bc71c7582001685.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "image",
                    "bbox": [
                        480,
                        139,
                        528,
                        351
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                480,
                                139,
                                528,
                                351
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        480,
                                        139,
                                        528,
                                        351
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                480,
                                                139,
                                                528,
                                                351
                                            ],
                                            "type": "image",
                                            "image_path": "f5bccd2c8630bf0897662eccde3a0157f85b4ebdd27e72d49b0434c27247eb73.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_body"
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        103,
                        364,
                        531,
                        432
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                364,
                                531,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "Figure 12.2 further illustrates the weighting on the sequence of "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "- step returns in the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "- return. The one- step return is given the largest weight, "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 - \\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "; the two- step return is given the next largest weight, "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "(1 - \\lambda) \\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "; the three- step return is given the weight "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "(1 - \\lambda) \\lambda^{2}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "; and so on. The weight fades by "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": " with each additional step. After a terminal state has been reached, all subsequent "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "- step returns are equal to the conventional return, "
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        364,
                                        531,
                                        432
                                    ],
                                    "type": "text",
                                    "content": ". If"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "image",
                    "bbox": [
                        186,
                        455,
                        447,
                        698
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                186,
                                455,
                                447,
                                698
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        186,
                                        455,
                                        447,
                                        698
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                186,
                                                455,
                                                447,
                                                698
                                            ],
                                            "type": "image",
                                            "image_path": "1f6dbeaeaf1ae9113d1d0131270e91d3dfc662a2c3751260b58fc8f54be681f2.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                103,
                                699,
                                530,
                                736
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        103,
                                        699,
                                        530,
                                        736
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.1: The backup diagram for "
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\mathrm{TD}(\\lambda)"
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": ". If "
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda = 0"
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": ", then the overall update reduces to its first component, the one-step TD update, whereas if "
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda = 1"
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                699,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": ", then the overall update reduces to its last component, the Monte Carlo update."
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "type": "image_caption"
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 2
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        79,
                        139,
                        459,
                        279
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                79,
                                139,
                                459,
                                279
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        79,
                                        139,
                                        459,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                139,
                                                459,
                                                279
                                            ],
                                            "type": "image",
                                            "image_path": "8f0e5947a15801190dd973323bd97f4470183408fe3b889be228b90b4cd5a53a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                102,
                                292,
                                449,
                                305
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        102,
                                        292,
                                        449,
                                        305
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                102,
                                                292,
                                                449,
                                                305
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.2: Weighting given in the "
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                292,
                                                449,
                                                305
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                292,
                                                449,
                                                305
                                            ],
                                            "type": "text",
                                            "content": "-return to each of the "
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                292,
                                                449,
                                                305
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                292,
                                                449,
                                                305
                                            ],
                                            "type": "text",
                                            "content": "-step returns."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        330,
                        473,
                        344
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                330,
                                473,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        330,
                                        473,
                                        344
                                    ],
                                    "type": "text",
                                    "content": "we want, we can separate these post- termination terms from the main sum, yielding"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        352,
                        489,
                        390
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                352,
                                489,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        352,
                                        489,
                                        390
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda} = (1 - \\lambda) \\sum_{n = 1}^{T - t - 1} \\lambda^{n - 1} G_{t:t + n} + \\lambda^{T - t - 1} G_{t}, \\tag{12.3}",
                                    "image_path": "779fe876d6eb6b2ca82cd85e9a3af28175bbaa263b2364155d39868543a8c5b3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        399,
                        490,
                        465
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                399,
                                490,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "as indicated in the figures. This equation makes it clearer what happens when "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": ". In this case the main sum goes to zero, and the remaining term reduces to the conventional return. Thus, for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": ", updating according to the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "- return is a Monte Carlo algorithm. On the other hand, if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": ", then the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "- return reduces to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": ", the one- step return. Thus, for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": ", updating according to the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        399,
                                        490,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "- return is a one- step TD method."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        469,
                        489,
                        510
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                469,
                                489,
                                510
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        469,
                                        489,
                                        510
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.1 Just as the return can be written recursively in terms of the first reward and itself one- step later (3.9), so can the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        469,
                                        489,
                                        510
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        469,
                                        489,
                                        510
                                    ],
                                    "type": "text",
                                    "content": "- return. Derive the analogous recursive relationship from (12.2) and (12.1)."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        514,
                        489,
                        593
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                514,
                                489,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.2 The parameter "
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " characterizes how fast the exponential weighting in Figure 12.2 falls off, and thus how far into the future the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm looks in determining its update. But a rate factor such as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " is sometimes an awkward way of characterizing the speed of the decay. For some purposes it is better to specify a time constant, or half- life. What is the equation relating "
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": " and the half- life, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau_{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        514,
                                        489,
                                        593
                                    ],
                                    "type": "text",
                                    "content": ", the time by which the weighting sequence will have fallen to half of its initial value?"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        595,
                        489,
                        661
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                595,
                                489,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "We are now ready to define our first learning algorithm based on the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "- return: the off- line "
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm. As an off- line algorithm, it makes no changes to the weight vector during the episode. Then, at the end of the episode, a whole sequence of off- line updates are made according to our usual semi- gradient rule, using the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        595,
                                        489,
                                        661
                                    ],
                                    "type": "text",
                                    "content": "- return as the target:"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        91,
                        670,
                        489,
                        692
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                670,
                                489,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        670,
                                        489,
                                        692
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_{t} + \\alpha \\Big[ G_{t}^{\\lambda} - \\hat{v} (S_{t}, \\mathbf{w}_{t}) \\Big] \\nabla \\hat{v} (S_{t}, \\mathbf{w}_{t}), \\quad t = 0, \\ldots , T - 1. \\tag{12.4}",
                                    "image_path": "5c05a9ac65e1323b1cc6e45b3d7aed4564a888569fb5f0386bf5515f8ac64aa9.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 3
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        141,
                        530,
                        300
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                141,
                                530,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- return gives us an alternative way of moving smoothly between Monte Carlo and one- step TD methods that can be compared with the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- step bootstrapping way developed in Chapter 7. There we assessed effectiveness on a 19- state random walk task (Example 7.1, page 144). Figure 12.3 shows the performance of the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm on this task alongside that of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- step methods (repeated from Figure 7.2). The experiment was just as described earlier except that for the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm we varied "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": " instead of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": ". The performance measure used is the estimated root- mean- square error between the correct and estimated values of each state measured at the end of the episode, averaged over the first 10 episodes and the 19 states. Note that overall performance of the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- return algorithms is comparable to that of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- step algorithms. In both cases we get best performance with an intermediate value of the bootstrapping parameter, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": " for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- step methods and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": " for the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        89,
                        314,
                        544,
                        502
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                89,
                                314,
                                544,
                                502
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        89,
                                        314,
                                        544,
                                        502
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                89,
                                                314,
                                                544,
                                                502
                                            ],
                                            "type": "image",
                                            "image_path": "2fbdbffa09c5260b1f0b3dcc11d38b106e893aaee6f7a8eaa41ae44f56f64acc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                513,
                                530,
                                563
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        513,
                                        530,
                                        563
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.3: 19-state Random walk results (Example 7.1): Performance of the off-line "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": "-return algorithm alongside that of the "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": "-step TD methods. In both case, intermediate values of the bootstrapping parameter ("
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": " or "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": ") performed best. The results with the off-line "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": "-return algorithm are slightly better at the best values of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": " and "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": ", and at high "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                513,
                                                530,
                                                563
                                            ],
                                            "type": "text",
                                            "content": "."
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_caption"
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        591,
                        530,
                        697
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                591,
                                530,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        591,
                                        530,
                                        697
                                    ],
                                    "type": "text",
                                    "content": "The approach that we have been taking so far is what we call the theoretical, or forward, view of a learning algorithm. For each state visited, we look forward in time to all the future rewards and decide how best to combine them. We might imagine ourselves riding the stream of states, looking forward from each state to determine its update, as suggested by Figure 12.4. After looking forward from and updating one state, we move on to the next and never have to work with the preceding state again. Future states, on the other hand, are viewed and processed repeatedly, once from each vantage point preceding them."
                                }
                            ]
                        }
                    ],
                    "index": 3
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 4
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        77,
                        140,
                        477,
                        248
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                77,
                                140,
                                477,
                                248
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        77,
                                        140,
                                        477,
                                        248
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                140,
                                                477,
                                                248
                                            ],
                                            "type": "image",
                                            "image_path": "3cb7c61d5d58d403daaafeed7f0d3c96e87345cf4b94f9008e958dc8672961c8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                260,
                                489,
                                284
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        260,
                                        489,
                                        284
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                260,
                                                489,
                                                284
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.4: The forward view. We decide how to update each state by looking forward to future rewards and states."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        304,
                        164,
                        323
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                304,
                                164,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        304,
                                        164,
                                        323
                                    ],
                                    "type": "text",
                                    "content": "12.2 "
                                },
                                {
                                    "bbox": [
                                        64,
                                        304,
                                        164,
                                        323
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{TD}(\\lambda)"
                                }
                            ]
                        }
                    ],
                    "index": 2,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        334,
                        489,
                        399
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                334,
                                489,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        399
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        399
                                    ],
                                    "type": "text",
                                    "content": " is one of the oldest and most widely used algorithms in reinforcement learning. It was the first algorithm for which a formal relationship was shown between a more theoretical forward view and a more computationally- congenial backward view using eligibility traces. Here we will show empirically that it approximates the off- line "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        399
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        399
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm presented in the previous section."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        402,
                        489,
                        481
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                402,
                                489,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "text",
                                    "content": " improves over the off- line "
                                },
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm in three ways. First it updates the weight vector on every step of an episode rather than only at the end, and thus its estimates may be better sooner. Second, its computations are equally distributed in time rather than all at the end of the episode. And third, it can be applied to continuing problems rather than just to episodic problems. In this section we present the semi- gradient version of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        402,
                                        489,
                                        481
                                    ],
                                    "type": "text",
                                    "content": " with function approximation."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        482,
                        489,
                        561
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                482,
                                489,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": "With function approximation, the eligibility trace is a vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " with the same number of components as the weight vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": ". Whereas the weight vector is a long- term memory, accumulating over the lifetime of the system, the eligibility trace is a short- term memory, typically lasting less time than the length of an episode. Eligibility traces assist in the learning process; their only consequence is that they affect the weight vector, and then the weight vector determines the estimated value."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        563,
                        489,
                        602
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                563,
                                489,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        602
                                    ],
                                    "type": "text",
                                    "content": "In "
                                },
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        602
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        602
                                    ],
                                    "type": "text",
                                    "content": ", the eligibility trace vector is initialized to zero at the beginning of the episode, is incremented on each time step by the value gradient, and then fades away by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        602
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma \\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        602
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        96,
                        610,
                        489,
                        640
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                96,
                                610,
                                489,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        610,
                                        489,
                                        640
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{z}_{-1}\\doteq \\mathbf{0},}\\\\ & {\\mathbf{z}_{t} = \\gamma \\lambda \\mathbf{z}_{t - 1} + \\nabla v(S_{t},\\mathbf{w}_{t}),\\quad 0\\leq t\\leq T,} \\end{array} \\tag{12.5}",
                                    "image_path": "ea2e40113f507cdcbbd37c87da55c09b76c1e0b37df23b180c164018f5dcdb5a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        647,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                647,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is the discount rate and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is the parameter introduced in the previous section, which we henceforth call the trace- decay parameter. The eligibility trace keeps track of which components of the weight vector have contributed, positively or negatively, to recent state valuations, where \"recent\" is defined in terms of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma \\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". (Recall that in linear function approximation, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\nabla v(S_t, \\mathbf{w}_t)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is the feature vector, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", in which case the eligibility trace vector is just a sum of past, fading, input vectors.) The trace is said to indicate the eligibility of each component of the weight vector for undergoing learning changes"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 5
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        103,
                        140,
                        529,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                140,
                                529,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        140,
                                        529,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "should a reinforcing event occur. The reinforcing events we are concerned with are the moment- by- moment one- step TD errors. The TD error for state- value prediction is"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        131,
                        178,
                        528,
                        192
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                178,
                                528,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        178,
                                        528,
                                        192
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t} \\doteq R_{t + 1} + \\gamma \\hat{v} (S_{t + 1},\\mathbf{w}_{t}) - \\hat{v} (S_{t},\\mathbf{w}_{t}). \\tag{12.6}",
                                    "image_path": "700cec4a8fdb3453d41d4d7f423892739607d58bf1aee33376d855a623466584.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        102,
                        202,
                        529,
                        229
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                202,
                                529,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        202,
                                        529,
                                        229
                                    ],
                                    "type": "text",
                                    "content": "In "
                                },
                                {
                                    "bbox": [
                                        102,
                                        202,
                                        529,
                                        229
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        102,
                                        202,
                                        529,
                                        229
                                    ],
                                    "type": "text",
                                    "content": ", the weight vector is updated on each step proportional to the scalar TD error and the vector eligibility trace:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        131,
                        240,
                        528,
                        254
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                240,
                                528,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        240,
                                        528,
                                        254
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t} \\mathbf{z}_{t}. \\tag{12.7}",
                                    "image_path": "e285c58a59c8974663e0c214272afd057f81e6f84088445d5e94365804862d1e.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        117,
                        269,
                        354,
                        283
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                269,
                                354,
                                283
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        269,
                                        354,
                                        283
                                    ],
                                    "type": "text",
                                    "content": "Semi-gradient "
                                },
                                {
                                    "bbox": [
                                        117,
                                        269,
                                        354,
                                        283
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        117,
                                        269,
                                        354,
                                        283
                                    ],
                                    "type": "text",
                                    "content": " for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        269,
                                        354,
                                        283
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} \\approx v_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        293,
                        291,
                        305
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                293,
                                291,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        293,
                                        291,
                                        305
                                    ],
                                    "type": "text",
                                    "content": "Input: the policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        293,
                                        291,
                                        305
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        293,
                                        291,
                                        305
                                    ],
                                    "type": "text",
                                    "content": " to be evaluated"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        117,
                        306,
                        489,
                        319
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                306,
                                489,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        306,
                                        489,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable function "
                                },
                                {
                                    "bbox": [
                                        117,
                                        306,
                                        489,
                                        319
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v}: \\mathbb{S}^{+} \\times \\mathbb{R}^{d} \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        306,
                                        489,
                                        319
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        117,
                                        306,
                                        489,
                                        319
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (\\text{terminal}, \\cdot) = 0"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        117,
                        320,
                        437,
                        332
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                320,
                                437,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        320,
                                        437,
                                        332
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        320,
                                        437,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        320,
                                        437,
                                        332
                                    ],
                                    "type": "text",
                                    "content": ", trace decay rate "
                                },
                                {
                                    "bbox": [
                                        117,
                                        320,
                                        437,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0, 1]"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        117,
                        333,
                        406,
                        346
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                333,
                                406,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        333,
                                        406,
                                        346
                                    ],
                                    "type": "text",
                                    "content": "Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        117,
                                        333,
                                        406,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        333,
                                        406,
                                        346
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        333,
                                        406,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        333,
                                        406,
                                        346
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        117,
                        353,
                        228,
                        365
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                353,
                                228,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        353,
                                        228,
                                        365
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        129,
                        367,
                        173,
                        378
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                367,
                                173,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        367,
                                        173,
                                        378
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        129,
                                        367,
                                        173,
                                        378
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        130,
                        379,
                        163,
                        391
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                379,
                                163,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        379,
                                        163,
                                        391
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z} \\leftarrow \\mathbf{0}"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        394,
                        379,
                        511,
                        392
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                394,
                                379,
                                511,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        394,
                                        379,
                                        511,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "(a "
                                },
                                {
                                    "bbox": [
                                        394,
                                        379,
                                        511,
                                        392
                                    ],
                                    "type": "inline_equation",
                                    "content": "d"
                                },
                                {
                                    "bbox": [
                                        394,
                                        379,
                                        511,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "- dimensional vector)"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        130,
                        393,
                        278,
                        405
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                393,
                                278,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        393,
                                        278,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of episode:"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        130,
                        406,
                        238,
                        418
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                406,
                                238,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        406,
                                        238,
                                        418
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        130,
                                        406,
                                        238,
                                        418
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot | S)"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        130,
                        420,
                        285,
                        431
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                420,
                                285,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        420,
                                        285,
                                        431
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        130,
                                        420,
                                        285,
                                        431
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        130,
                                        420,
                                        285,
                                        431
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        130,
                                        420,
                                        285,
                                        431
                                    ],
                                    "type": "inline_equation",
                                    "content": "R, S'"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        130,
                        432,
                        246,
                        445
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                432,
                                246,
                                445
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        432,
                                        246,
                                        445
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z} \\leftarrow \\gamma \\lambda \\mathbf{z} + \\nabla \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        130,
                        446,
                        282,
                        459
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                446,
                                282,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        446,
                                        282,
                                        459
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R + \\gamma \\hat{v} (S', \\mathbf{w}) - \\hat{v} (S, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        130,
                        460,
                        217,
                        472
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                460,
                                217,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        460,
                                        217,
                                        472
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha \\delta \\mathbf{z}"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        130,
                        472,
                        185,
                        484
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                472,
                                185,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        472,
                                        185,
                                        484
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\leftarrow S'"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        130,
                        485,
                        223,
                        497
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                485,
                                223,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        485,
                                        223,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "until "
                                },
                                {
                                    "bbox": [
                                        130,
                                        485,
                                        223,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "S'"
                                },
                                {
                                    "bbox": [
                                        130,
                                        485,
                                        223,
                                        497
                                    ],
                                    "type": "text",
                                    "content": " is terminal"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "image",
                    "bbox": [
                        135,
                        519,
                        492,
                        686
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                135,
                                519,
                                492,
                                686
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        135,
                                        519,
                                        492,
                                        686
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                135,
                                                519,
                                                492,
                                                686
                                            ],
                                            "type": "image",
                                            "image_path": "fb75a22f46169daf358c955793262a2518b7f3fa2058ea25cf78feb476db5cc0.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 21,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                102,
                                694,
                                529,
                                719
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        102,
                                        694,
                                        529,
                                        719
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                102,
                                                694,
                                                529,
                                                719
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.5: The backward or mechanistic view of "
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                694,
                                                529,
                                                719
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\mathrm{TD}(\\lambda)"
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                694,
                                                529,
                                                719
                                            ],
                                            "type": "text",
                                            "content": ". Each update depends on the current TD error combined with the current eligibility traces of past events."
                                        }
                                    ]
                                }
                            ],
                            "index": 22,
                            "type": "image_caption"
                        }
                    ],
                    "index": 21
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 6
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        141,
                        489,
                        233
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                141,
                                489,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        141,
                                        489,
                                        233
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        141,
                                        489,
                                        233
                                    ],
                                    "type": "text",
                                    "content": " is oriented backward in time. At each moment we look at the current TD error and assign it backward to each prior state according to how much that state contributed to the current eligibility trace at that time. We might imagine ourselves riding along the stream of states, computing TD errors, and shouting them back to the previously visited states, as suggested by Figure 12.5. Where the TD error and traces come together, we get the update given by (12.7), changing the values of those past states for when they occur again in the future."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        234,
                        489,
                        380
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                234,
                                489,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": "To better understand the backward view of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ", consider what happens at various values of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ". If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ", then by (12.5) the trace at "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": " is exactly the value gradient corresponding to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ". Thus the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": " update (12.7) reduces to the one- step semi- gradient TD update treated in Chapter 9 (and, in the tabular case, to the simple TD rule (6.2)). This is why that algorithm was called "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(0)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ". In terms of Figure 12.5, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(0)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": " is the case in which only the one- state preceding the current one is updated by the TD error (other states may have their value estimates changed by generalization due to function approximation). For larger values of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ", but still "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda < 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        489,
                                        380
                                    ],
                                    "type": "text",
                                    "content": ", more of the preceding states are updated, but each more temporally distant state is updated less because the corresponding eligibility trace is smaller, as suggested by the figure. We say that the earlier states are given less credit for the TD error."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        382,
                        489,
                        474
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                382,
                                489,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ", then the credit given to earlier states falls only by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": " per step. This turns out to be just the right thing to do to achieve Monte Carlo behavior. For example, remember that the TD error, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ", includes an undiscounted term of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ". In passing this back "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": " steps it needs to be discounted, like any reward in a return, by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{k}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ", which is just what the falling eligibility trace achieves. If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ", then the eligibility traces do not decay at all with time. In this case the method behaves like a Monte Carlo method for an undiscounted, episodic task. If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": ", the algorithm is also known as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        382,
                                        489,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        475,
                        489,
                        634
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                475,
                                489,
                                634
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": " is a way of implementing Monte Carlo algorithms that is more general than those presented earlier and that significantly increases their range of applicability. Whereas the earlier Monte Carlo methods were limited to episodic tasks, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": " can be applied to discounted continuing tasks as well. Moreover, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": " can be performed incrementally and online. One disadvantage of Monte Carlo methods is that they learn nothing from an episode until it is over. For example, if a Monte Carlo control method takes an action that produces a very poor reward but does not end the episode, then the agent's tendency to repeat the action will be undiminished during the episode. Online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": ", on the other hand, learns in an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": "- step TD way from the incomplete ongoing episode, where the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": " steps are all the way up to the current step. If something unusually good or bad happens during an episode, control methods based on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(1)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        475,
                                        489,
                                        634
                                    ],
                                    "type": "text",
                                    "content": " can learn immediately and alter their behavior on that same episode."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        636,
                        489,
                        742
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                636,
                                489,
                                742
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": "It is revealing to revisit the 19- state random walk example (Example 7.1) to see how well "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " does in approximating the off- line "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm. The results for both algorithms are shown in Figure 12.6. For each "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " value, if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " is selected optimally for it (or smaller), then the two algorithms perform virtually identically. If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " is chosen larger than is optimal, however, then the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm is only a little worse whereas "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " is much worse and may even be unstable. This is not catastrophic for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        636,
                                        489,
                                        742
                                    ],
                                    "type": "text",
                                    "content": " on this problem, as these higher parameter values are not what one would want to use anyway, but for other problems it can be a significant weakness."
                                }
                            ]
                        }
                    ],
                    "index": 4
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 7
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        100,
                        132,
                        533,
                        310
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                100,
                                132,
                                533,
                                310
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        100,
                                        132,
                                        533,
                                        310
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                100,
                                                132,
                                                533,
                                                310
                                            ],
                                            "type": "image",
                                            "image_path": "a745f6d40d4ebac3ae5177f971dc2763c562ad29b27d4f65b97878fdc90c35cd.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                315,
                                530,
                                353
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        315,
                                        530,
                                        353
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.6: 19-state Random walk results (Example 7.1): Performance of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\mathrm{TD}(\\lambda)"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": " alongside that of the off-line "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": "-return algorithm. The two algorithms performed virtually identically at low (less than optimal) "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": " values, but "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\mathrm{TD}(\\lambda)"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": " was worse at high "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                315,
                                                530,
                                                353
                                            ],
                                            "type": "text",
                                            "content": " values."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        375,
                        530,
                        442
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                375,
                                530,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "text",
                                    "content": "Linear "
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "text",
                                    "content": " has been proved to converge in the on- policy case if the step- size parameter is reduced over time according to the usual conditions (2.7). Just as discussed in Section 9.4, convergence is not to the minimum- error weight vector, but to a nearby weight vector that depends on "
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "text",
                                    "content": ". The bound on solution quality presented in that section (9.14) can now be generalized to apply for any "
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        375,
                                        530,
                                        442
                                    ],
                                    "type": "text",
                                    "content": ". For the continuing discounted case,"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        131,
                        447,
                        528,
                        475
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                447,
                                528,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        447,
                                        528,
                                        475
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\overline{\\mathrm{VE}} (\\mathbf{w}_{\\infty}) \\leq \\frac{1 - \\gamma \\lambda}{1 - \\gamma} \\min_{\\mathbf{w}} \\overline{\\mathrm{VE}} (\\mathbf{w}). \\tag{12.8}",
                                    "image_path": "7b4d6543655292e6ece68318404a270b9d7c2f30c38281dfc1a3bb23b2542ef3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        481,
                        530,
                        538
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                481,
                                530,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "text",
                                    "content": "That is, the asymptotic error is no more than "
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac{1 - \\gamma \\lambda}{1 - \\gamma}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " times the smallest possible error. As "
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " approaches 1, the bound approaches the minimum error (and it is loosest at "
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "text",
                                    "content": "). In practice, however, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        481,
                                        530,
                                        538
                                    ],
                                    "type": "text",
                                    "content": " is often the poorest choice, as will be illustrated later in Figure 12.14."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        541,
                        530,
                        607
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                541,
                                530,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.3 Some insight into how "
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "text",
                                    "content": " can closely approximate the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm can be gained by seeing that the latter's error term (in brackets in (12.4)) can be written as the sum of TD errors (12.6) for a single fixed "
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "text",
                                    "content": ". Show this, following the pattern of (6.6), and using the recursive relationship for the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        541,
                                        530,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "- return you obtained in Exercise 12.1."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        611,
                        530,
                        665
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                611,
                                530,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        611,
                                        530,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.4 Use your result from the preceding exercise to show that, if the weight updates over an episode were computed on each step but not actually used to change the weights (w remained fixed), then the sum of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        611,
                                        530,
                                        665
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        611,
                                        530,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "'s weight updates would be the same as the sum of the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        611,
                                        530,
                                        665
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        611,
                                        530,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm's updates."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        105,
                        684,
                        436,
                        703
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                684,
                                436,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        436,
                                        703
                                    ],
                                    "type": "text",
                                    "content": "12.3 "
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        436,
                                        703
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        436,
                                        703
                                    ],
                                    "type": "text",
                                    "content": "-step Truncated "
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        436,
                                        703
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        436,
                                        703
                                    ],
                                    "type": "text",
                                    "content": "-return Methods"
                                }
                            ]
                        }
                    ],
                    "index": 7,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        713,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                713,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "The off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm is an important ideal, but it is of limited utility because it uses the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return (12.2), which is not known until the end of the episode. In the"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 8
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "continuing case, the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- return is technically never known, as it depends on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step returns for arbitrarily large "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", and thus on rewards arbitrarily far in the future. However, the dependence becomes weaker for longer- delayed rewards, falling by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma \\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": " for each step of delay. A natural approximation, then, would be to truncate the sequence after some number of steps. Our existing notion of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step returns provides a natural way to do this in which the missing rewards are replaced with estimated values.In general, we define the truncated "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- return for time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", given data only up to some later horizon, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", as"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        63,
                        221,
                        489,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                221,
                                489,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "In general, we define the truncated "
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " - return for time "
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " , given data only up to some later horizon, "
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        63,
                                        221,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " , as"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        91,
                        264,
                        489,
                        302
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                264,
                                489,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        264,
                                        489,
                                        302
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:h}^{\\lambda} \\doteq (1 - \\lambda) \\sum_{n = 1}^{h - t - 1} \\lambda^{n - 1} G_{t:t + n} + \\lambda^{h - t - 1} G_{t:h}, \\qquad 0 \\leq t < h \\leq T. \\tag{12.9}",
                                    "image_path": "f2411695847d07008e6655f9d252a27f5db1f5ad759abb64870a92c4cca7f8d9.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        318,
                        489,
                        372
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                318,
                                489,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": "If you compare this equation with the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " - return (12.3), it is clear that the horizon "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " is playing the same role as was previously played by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " , the time of termination. Whereas in the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " - return there is a residual weight given to the conventional return "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " , here it is given to the longest available "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathcal{n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " - step return, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:h}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        318,
                                        489,
                                        372
                                    ],
                                    "type": "text",
                                    "content": " (Figure 12.2)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        373,
                        489,
                        479
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                373,
                                489,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": "The truncated "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - return immediately gives rise to a family of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - step "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - return algorithms similar to the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - step methods of Chapter 7. In all of these algorithms, updates are delayed by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " steps and only take into account the first "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " rewards, but now all the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - step returns are included for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "1\\leq k\\leq n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " (whereas the earlier "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - step algorithms used only the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " - step return), weighted geometrically as in Figure 12.2. In the state- value case, this family of algorithms is known as Truncated "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " , or "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " . The compound backup diagram, shown in Figure 12.7, is similar to that for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " (Figure 12.1) except that the longest component update is at most "
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        373,
                                        489,
                                        479
                                    ],
                                    "type": "text",
                                    "content": " steps rather than always going all the way to the"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "image",
                    "bbox": [
                        126,
                        505,
                        426,
                        715
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                126,
                                505,
                                426,
                                715
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        126,
                                        505,
                                        426,
                                        715
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                126,
                                                505,
                                                426,
                                                715
                                            ],
                                            "type": "image",
                                            "image_path": "bfb9239945602aa5858ffdf0b15900160b235b974bd84d2f1155a746af205a57.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "type": "image_body"
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 9
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        103,
                        139,
                        364,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                139,
                                364,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        139,
                                        364,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "end of the episode. "
                                },
                                {
                                    "bbox": [
                                        103,
                                        139,
                                        364,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        103,
                                        139,
                                        364,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " is defined by (cf. (9.15)):"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        132,
                        162,
                        503,
                        177
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                162,
                                503,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        162,
                                        503,
                                        177
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r}{\\mathbf{w}_{t + n}\\doteq \\mathbf{w}_{t + n - 1} + \\alpha \\left[G_{t:t + n}^{\\lambda} - \\hat{v} (S_{t},\\mathbf{w}_{t + n - 1})\\right]\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t + n - 1}),\\qquad 0\\leq t< T.} \\end{array}",
                                    "image_path": "5d2e0a1951951999d08de4baa07a6bb561e292dc8f75afb97837586ee211ddde.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        103,
                        183,
                        530,
                        250
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                183,
                                530,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": "This algorithm can be implemented efficiently so that per- step computation does not scale with "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": " (though of course memory must). Much as in "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": "- step TD methods, no updates are made on the first "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "n - 1"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": " time steps of each episode, and "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "n - 1"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": " additional updates are made upon termination. Efficient implementation relies on the fact that the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": "- step "
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        183,
                                        530,
                                        250
                                    ],
                                    "type": "text",
                                    "content": "- return can be written exactly as"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        131,
                        256,
                        528,
                        294
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                256,
                                528,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        256,
                                        528,
                                        294
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + k}^{\\lambda} = \\hat{v} (S_{t},\\mathbf{w}_{t - 1}) + \\sum_{i = t}^{t + k - 1}(\\gamma \\lambda)^{i - t}\\delta_{i}^{\\prime}, \\tag{12.10}",
                                    "image_path": "b7f6415c72021cba9c85f85f531ced2de711056364d264c2e8df170a6e6606cb.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        103,
                        300,
                        134,
                        313
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                300,
                                134,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        300,
                                        134,
                                        313
                                    ],
                                    "type": "text",
                                    "content": "where"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        132,
                        322,
                        321,
                        336
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                322,
                                321,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        322,
                                        321,
                                        336
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t}^{\\prime}\\doteq R_{t + 1} + \\gamma \\hat{v} (S_{t + 1},\\mathbf{w}_{t}) - \\hat{v} (S_{t},\\mathbf{w}_{t - 1}).",
                                    "image_path": "575ebb9a8e307f5c503c2dc88b4eabda4d9dd30051879761f51a6cb479d0c8a7.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        103,
                        346,
                        529,
                        388
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                346,
                                529,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        346,
                                        529,
                                        388
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.5 Several times in this book (often in exercises) we have established that returns can be written as sums of TD errors if the value function is held constant. Why is (12.10) another instance of this? Prove (12.10)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        105,
                        406,
                        512,
                        425
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                406,
                                512,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        406,
                                        512,
                                        425
                                    ],
                                    "type": "text",
                                    "content": "12.4 Redoing Updates: Online "
                                },
                                {
                                    "bbox": [
                                        105,
                                        406,
                                        512,
                                        425
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        105,
                                        406,
                                        512,
                                        425
                                    ],
                                    "type": "text",
                                    "content": "-return Algorithm"
                                }
                            ]
                        }
                    ],
                    "index": 7,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        436,
                        529,
                        502
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                436,
                                529,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "text",
                                    "content": "Choosing the truncation parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "text",
                                    "content": " in Truncated "
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "text",
                                    "content": " involves a tradeoff. "
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "text",
                                    "content": " should be large so that the method closely approximates the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        436,
                                        529,
                                        502
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm, but it should also be small so that the updates can be made sooner and can influence behavior sooner. Can we get the best of both? Well, yes, in principle we can, albeit at the cost of computational complexity."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        504,
                        529,
                        597
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                504,
                                529,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "The idea is that, on each time step as you gather a new increment of data, you go back and redo all the updates since the beginning of the current episode. The new updates will be better than the ones you previously made because now they can take into account the time step's new data. That is, the updates are always towards an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "- step truncated "
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "- return target, but they always use the latest horizon. In each pass over that episode you can use a slightly longer horizon and obtain slightly better results. Recall that the truncated "
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        504,
                                        529,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "- return is defined in (12.9) as"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        132,
                        605,
                        389,
                        642
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                605,
                                389,
                                642
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        605,
                                        389,
                                        642
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:h}^{\\lambda} \\doteq (1 - \\lambda)\\sum_{n = 1}^{h - t - 1}\\lambda^{n - 1}G_{t:t + n} + \\lambda^{h - t - 1}G_{t:h}.",
                                    "image_path": "595586a85ecef0d5d62e3e9c9e7724e050c3286ef31cdc9e4ea79d528729f0b6.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        103,
                        647,
                        529,
                        728
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                647,
                                529,
                                728
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": "Let us step through how this target could ideally be used if computational complexity was not an issue. The episode begins with an estimate at time 0 using the weights "
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{0}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": " from the end of the previous episode. Learning begins when the data horizon is extended to time step 1. The target for the estimate at step 0, given the data up to horizon 1, could only be the one- step return "
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{0:1}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": ", which includes "
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{1}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": " and bootstraps from the estimate "
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (S_{1},\\mathbf{w}_{0})"
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": ". Note that this is exactly what "
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{0:1}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        647,
                                        529,
                                        728
                                    ],
                                    "type": "text",
                                    "content": " is, with the sum in the first term of the"
                                }
                            ]
                        }
                    ],
                    "index": 11
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 10
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        260
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                260
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": "equation degenerating to zero. Using this update target, we construct "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ". Then, after advancing the data horizon to step 2, what do we do? We have new data in the form of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{2}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{2}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ", as well as the new "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ", so now we can construct a better update target "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{0:2}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " for the first update from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " as well as a better update target "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{1:2}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " for the second update from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ". Using these improved targets, we redo the updates at "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{2}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ", starting again from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{0}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ", to produce "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{2}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ". Now we advance the horizon to step 3 and repeat, going all the way back to produce three new targets, redoing all updates starting from the original "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{0}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " to produce "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{3}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": ", and so on. Each time the horizon is advanced, all the updates are redone starting from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{0}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        260
                                    ],
                                    "type": "text",
                                    "content": " using the weight vector from the preceding horizon."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        261,
                        489,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                261,
                                489,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "This conceptual algorithm involves multiple passes over the episode, one at each horizon, each generating a different sequence of weight vectors. To describe it clearly we have to distinguish between the weight vectors computed at the different horizons. Let us use "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}^{h}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " to denote the weights used to generate the value at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " in the sequence up to horizon "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": ". The first weight vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{0}^{h}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " in each sequence is that inherited from the previous episode (so they are the same for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "), and the last weight vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{h}^{h}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " in each sequence defines the ultimate weight vector sequence of the algorithm. At the final horizon "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "h = T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " we obtain the final weights "
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{T}^{T}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        261,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " which will be passed on to form the initial weights of the next episode. With these conventions, the three first sequences described in the previous paragraph can be given explicitly:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        90,
                        405,
                        349,
                        421
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                405,
                                349,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        405,
                                        349,
                                        421
                                    ],
                                    "type": "interline_equation",
                                    "content": "h = 1:\\quad \\mathbf{w}_{1}^{1}\\doteq \\mathbf{w}_{0}^{1} + \\alpha \\left[G_{0:1}^{\\lambda} - \\hat{v} (S_{0},\\mathbf{w}_{0}^{1})\\right]\\nabla \\hat{v} (S_{0},\\mathbf{w}_{0}^{1}),",
                                    "image_path": "c83ff26551a5a60996dc24212d76993374dd47bd170c8388c0c23259e24e0528.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        439,
                        349,
                        475
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                439,
                                349,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        439,
                                        349,
                                        475
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l}{h = 2:} & {\\mathbf{w}_{1}^{2}\\doteq \\mathbf{w}_{0}^{2} + \\alpha \\left[G_{0:2}^{\\lambda} - \\hat{v} (S_{0},\\mathbf{w}_{0}^{2})\\right]\\nabla \\hat{v} (S_{0},\\mathbf{w}_{0}^{2}),}\\\\ & {\\mathbf{w}_{2}^{2}\\doteq \\mathbf{w}_{1}^{2} + \\alpha \\left[G_{1:2}^{\\lambda} - \\hat{v} (S_{1},\\mathbf{w}_{1}^{2})\\right]\\nabla \\hat{v} (S_{1},\\mathbf{w}_{1}^{2}),} \\end{array}",
                                    "image_path": "11e77159e916b823a2dfa65fd18ceb8d492693c9ae8890bf883efcb78896b1ab.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        91,
                        492,
                        349,
                        548
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                492,
                                349,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        492,
                                        349,
                                        548
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l}{h = 3:} & {\\mathbf{w}_{1}^{3}\\doteq \\mathbf{w}_{0}^{3} + \\alpha \\left[G_{0:3}^{\\lambda} - \\hat{v} (S_{0},\\mathbf{w}_{0}^{3})\\right]\\nabla \\hat{v} (S_{0},\\mathbf{w}_{0}^{3}),}\\\\ & {\\mathbf{w}_{2}^{3}\\doteq \\mathbf{w}_{1}^{3} + \\alpha \\left[G_{1:3}^{\\lambda} - \\hat{v} (S_{1},\\mathbf{w}_{1}^{3})\\right]\\nabla \\hat{v} (S_{1},\\mathbf{w}_{1}^{3}),}\\\\ & {\\mathbf{w}_{3}^{3}\\doteq \\mathbf{w}_{2}^{3} + \\alpha \\left[G_{2:3}^{\\lambda} - \\hat{v} (S_{2},\\mathbf{w}_{2}^{3})\\right]\\nabla \\hat{v} (S_{2},\\mathbf{w}_{2}^{3}).} \\end{array}",
                                    "image_path": "ca16f7281f3085de7ae945035bfce082f340b543027a889d30f078203446e821.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        555,
                        233,
                        569
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                555,
                                233,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        555,
                                        233,
                                        569
                                    ],
                                    "type": "text",
                                    "content": "The general form for the update is"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        92,
                        580,
                        393,
                        596
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                580,
                                393,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        580,
                                        393,
                                        596
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1}^{h}\\doteq \\mathbf{w}_{t}^{h} + \\alpha \\left[G_{t:h}^{\\lambda} - \\hat{v} (S_{t},\\mathbf{w}_{t}^{h})\\right]\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t}^{h}), 0\\leq t< h\\leq T.",
                                    "image_path": "c897dce4e3a72e82916c8656fb2090be27b93691998df12c978a8ef45a00cc7a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        606,
                        426,
                        619
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                606,
                                426,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        606,
                                        426,
                                        619
                                    ],
                                    "type": "text",
                                    "content": "This update, together with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        606,
                                        426,
                                        619
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}\\doteq \\mathbf{w}_{t}^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        606,
                                        426,
                                        619
                                    ],
                                    "type": "text",
                                    "content": " defines the online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        606,
                                        426,
                                        619
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        606,
                                        426,
                                        619
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        621,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                621,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "The online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm is fully online, determining a new weight vector "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " at each step "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " during an episode, using only information available at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". Its main drawback is that it is computationally complex, passing over the portion of the episode experienced so far on every step. Note that it is strictly more complex than the off- line "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm, which passes through all the steps at the time of termination but does not make any updates during the episode. In return, the online algorithm can be expected to perform better than the off- line one, not only during the episode when it makes an update while the off- line algorithm makes none, but also at the end of the episode because the weight vector used in bootstrapping (in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:h}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        621,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ") has had a larger number of informative"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 11
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        141,
                        530,
                        167
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                141,
                                530,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        530,
                                        167
                                    ],
                                    "type": "text",
                                    "content": "updates. This effect can be seen if one looks carefully at Figure 12.8, which compares the two algorithms on the 19- state random walk task."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        102,
                        175,
                        533,
                        354
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                102,
                                175,
                                533,
                                354
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        102,
                                        175,
                                        533,
                                        354
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                102,
                                                175,
                                                533,
                                                354
                                            ],
                                            "type": "image",
                                            "image_path": "452cc4628123484eae19e62e891c3386561b5383f9d82044a0c2b0ac3ffee65a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                360,
                                530,
                                409
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        360,
                                        530,
                                        409
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.8: 19-state Random walk results (Example 7.1): Performance of online and off-line "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "text",
                                            "content": "-return algorithms. The performance measure here is the "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\overline{\\mathrm{VE}}"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "text",
                                            "content": " at the end of the episode, which should be the best case for the off-line algorithm. Nevertheless, the online algorithm performs subtly better. For comparison, the "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda = 0"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                360,
                                                530,
                                                409
                                            ],
                                            "type": "text",
                                            "content": " line is the same for both methods."
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_caption"
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        105,
                        424,
                        304,
                        443
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                424,
                                304,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        424,
                                        304,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "12.5 True Online "
                                },
                                {
                                    "bbox": [
                                        105,
                                        424,
                                        304,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{TD}(\\lambda)"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        452,
                        531,
                        559
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                452,
                                531,
                                559
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "The online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm just presented is currently the best performing temporal- difference algorithm. It is an ideal which online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " only approximates. As presented, however, the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm is very complex. Is there a way to invert this forward- view algorithm to produce an efficient backward- view algorithm using eligibility traces? It turns out that there is indeed an exact computationally congenial implementation of the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm for the case of linear function approximation. This implementation is known as the true online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " algorithm because it is \"truer\" to the ideal of the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm than the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        452,
                                        531,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " algorithm is."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        561,
                        530,
                        614
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                561,
                                530,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        614
                                    ],
                                    "type": "text",
                                    "content": "The derivation of true online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " is a little too complex to present here (see the next section and the appendix to the paper by van Seijen et al., 2016) but its strategy is simple. The sequence of weight vectors produced by the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        614
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm can be arranged in a triangle:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        135,
                        619,
                        290,
                        709
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                135,
                                619,
                                290,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        619,
                                        290,
                                        709
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}\\mathbf{w}_0^0\\\\ \\mathbf{w}_0^1\\\\ \\mathbf{w}_0^2\\\\ \\mathbf{w}_0^3\\\\ \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\\\ \\mathbf{w}_0^T\\\\ \\mathbf{w}_1^T\\\\ \\mathbf{w}_2^T\\\\ \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdash \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots}\\\\ \\mathbf{w}_0^T\\\\ \\mathbf{w}_1^T\\\\ \\mathbf{w}_2^T\\\\ \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\vdots \\\\ \\mathbf{w}_0^T \\end{array}",
                                    "image_path": "7b82543298d0a86e67b4f1185c57c103a9ce1894a9394590f3771bf72ac43dfa.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        103,
                        714,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                714,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "One row of this triangle is produced on each time step. It turns out that the weight vectors on the diagonal, the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t^t"
                                },
                                {
                                    "bbox": [
                                        103,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", are the only ones really needed. The first, "
                                },
                                {
                                    "bbox": [
                                        103,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_0^0"
                                },
                                {
                                    "bbox": [
                                        103,
                                        714,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", is the initial weight"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 12
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        139,
                        490,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                139,
                                490,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "vector of the episode, the last, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{T}^{T}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", is the final weight vector, and each weight vector along the way, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", plays a role in bootstrapping in the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step returns of the updates. In the final algorithm the diagonal weight vectors are renamed without a superscript, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t} = \\mathbf{w}_{t}^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ". The strategy then is to find a compact, efficient way of computing each "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}^{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": " from the one before. If this is done, for the linear case in which "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s,\\mathbf{w}) = \\mathbf{w}^{\\top}\\mathbf{x}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", then we arrive at the true online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        490,
                                        220
                                    ],
                                    "type": "text",
                                    "content": " algorithm:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        227,
                        340,
                        242
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                227,
                                340,
                                242
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        227,
                                        340,
                                        242
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t}\\mathbf{z}_{t} + \\alpha \\left(\\mathbf{w}_{t}^{\\top}\\mathbf{x}_{t} - \\mathbf{w}_{t - 1}^{\\top}\\mathbf{x}_{t}\\right)(\\mathbf{z}_{t} - \\mathbf{x}_{t}),",
                                    "image_path": "e5f37de3d6ecaa9d46d6e5e84b0867ae72b223b2798a3c2da77c60cb16f68a2d.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        247,
                        489,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                247,
                                489,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "where we have used the shorthand "
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_{t}\\doteq \\mathbf{x}(S_{t})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " is defined as in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " (12.6), and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        247,
                                        489,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " is defined by"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        279,
                        489,
                        296
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                279,
                                489,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        279,
                                        489,
                                        296
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{z}_{t}\\doteq \\gamma \\lambda \\mathbf{z}_{t - 1} + \\left(1 - \\alpha \\gamma \\lambda \\mathbf{z}_{t - 1}^{\\top}\\mathbf{x}_{t}\\right)\\mathbf{x}_{t}. \\tag{12.11}",
                                    "image_path": "b07d7d44f9d8cf08c834ccbaeb95833f25e12537fe7d1214b98b01aa1c668795.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        302,
                        490,
                        408
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                302,
                                490,
                                408
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": "This algorithm has been proven to produce exactly the same sequence of weight vectors, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "0\\leq t\\leq T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": ", as the online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm (van Seijen et al. 2016). Thus the results on the random walk task on the left of Figure 12.8 are also its results on that task. Now, however, the algorithm is much less expensive. The memory requirements of true online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": " are identical to those of conventional "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": ", while the per- step computation is increased by about "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "50\\%"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": " (there is one more inner product in the eligibility- trace update). Overall, the per- step computational complexity remains of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "O(d)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": ", the same as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        302,
                                        490,
                                        408
                                    ],
                                    "type": "text",
                                    "content": ". Pseudocode for the complete algorithm is given in the box."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        416,
                        317,
                        432
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                416,
                                317,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        416,
                                        317,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "True online "
                                },
                                {
                                    "bbox": [
                                        77,
                                        416,
                                        317,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        416,
                                        317,
                                        432
                                    ],
                                    "type": "text",
                                    "content": " for estimating "
                                },
                                {
                                    "bbox": [
                                        77,
                                        416,
                                        317,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}^{\\top}\\mathbf{x}\\approx v_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        442,
                        405,
                        495
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                442,
                                405,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "Input: the policy "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " to be evaluated  Input: a feature function "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}:\\mathbb{S}^{+}\\to \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(t e r m i n a l,\\cdot) = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "  Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha >0"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": ", trace decay rate "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0,1]"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "  Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " (e.g., "
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        442,
                                        405,
                                        495
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        77,
                        502,
                        189,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                502,
                                189,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        502,
                                        189,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        89,
                        516,
                        331,
                        527
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                89,
                                516,
                                331,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        516,
                                        331,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "Initialize state and obtain initial feature vector "
                                },
                                {
                                    "bbox": [
                                        89,
                                        516,
                                        331,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        91,
                        530,
                        120,
                        540
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                530,
                                120,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        530,
                                        120,
                                        540
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}\\gets \\mathbf{0}"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        91,
                        543,
                        135,
                        554
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                543,
                                135,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        543,
                                        135,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{old}\\gets 0"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        91,
                        555,
                        238,
                        567
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                555,
                                238,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        555,
                                        238,
                                        567
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of episode:"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        106,
                        569,
                        177,
                        580
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                569,
                                177,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        569,
                                        177,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        106,
                                        569,
                                        177,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "A\\sim \\pi"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        106,
                        582,
                        409,
                        595
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                582,
                                409,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "inline_equation",
                                    "content": "R"
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        106,
                                        582,
                                        409,
                                        595
                                    ],
                                    "type": "text",
                                    "content": " (feature vector of the next state)"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        106,
                        595,
                        159,
                        607
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                595,
                                159,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        595,
                                        159,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "V\\gets \\mathbf{w}^{\\top}\\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        106,
                        607,
                        163,
                        620
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                607,
                                163,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        607,
                                        163,
                                        620
                                    ],
                                    "type": "inline_equation",
                                    "content": "V^{\\prime}\\gets \\mathbf{w}^{\\top}\\mathbf{x}^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        106,
                        622,
                        195,
                        634
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                622,
                                195,
                                634
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        622,
                                        195,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\gets R + \\gamma V^{\\prime} - V"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        106,
                        634,
                        242,
                        648
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                634,
                                242,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        634,
                                        242,
                                        648
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}\\gets \\gamma \\lambda \\mathbf{z} + \\left(1 - \\alpha \\gamma \\lambda \\mathbf{z}^{\\top}\\mathbf{x}\\right)\\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        106,
                        649,
                        316,
                        661
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                649,
                                316,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        649,
                                        316,
                                        661
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\gets \\mathbf{w} + \\alpha (\\delta +V - V_{old})\\mathbf{z} - \\alpha (V - V_{old})\\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        106,
                        661,
                        146,
                        672
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                661,
                                146,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        661,
                                        146,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{old}\\gets V^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        106,
                        674,
                        141,
                        686
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                674,
                                141,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        674,
                                        141,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}\\gets \\mathbf{x}^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        91,
                        688,
                        333,
                        701
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                688,
                                333,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        688,
                                        333,
                                        701
                                    ],
                                    "type": "text",
                                    "content": "until "
                                },
                                {
                                    "bbox": [
                                        91,
                                        688,
                                        333,
                                        701
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}^{\\prime} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        688,
                                        333,
                                        701
                                    ],
                                    "type": "text",
                                    "content": " (signaling arrival at a terminal state)"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        64,
                        713,
                        490,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                713,
                                490,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "The eligibility trace (12.11) used in true online "
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is called a dutch trace to distinguish it from the trace (12.5) used in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", which is called an accumulating trace."
                                }
                            ]
                        }
                    ],
                    "index": 22
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 13
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        529,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                529,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        529,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "Earlier work often used a third kind of trace called the replacing trace, defined only for the tabular case or for binary feature vectors such as those produced by tile coding. The replacing trace is defined on a component- by- component basis depending on whether the component of the feature vector was 1 or 0:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        131,
                        211,
                        528,
                        241
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                211,
                                528,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        211,
                                        528,
                                        241
                                    ],
                                    "type": "interline_equation",
                                    "content": "z_{i,t}\\doteq \\left\\{ \\begin{array}{l l}{1\\qquad} & {\\mathrm{if~}x_{i,t} = 1}\\\\ {\\gamma \\lambda z_{i,t - 1}\\quad \\mathrm{otherwise}.} \\end{array} \\right. \\tag{12.12}",
                                    "image_path": "da38e92c5a2c5d5e2ede51b88df45b8f9a4334304fda2aae449f207d5112f13a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        257,
                        529,
                        311
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                257,
                                529,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        257,
                                        529,
                                        311
                                    ],
                                    "type": "text",
                                    "content": "Nowadays, we see replacing traces as crude approximations to dutch traces, which largely supersede them. Dutch traces usually perform better than replacing traces and have a clearer theoretical basis. Accumulating traces remain of interest for nonlinear function approximations where dutch traces are not available."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        348,
                        470,
                        367
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                348,
                                470,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        348,
                                        470,
                                        367
                                    ],
                                    "type": "text",
                                    "content": "12.6 \\*Dutch Traces in Monte Carlo Learning"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        381,
                        529,
                        488
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                381,
                                529,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        381,
                                        529,
                                        488
                                    ],
                                    "type": "text",
                                    "content": "Although eligibility traces are closely associated historically with TD learning, in fact they have nothing to do with it. In fact, eligibility traces arise even in Monte Carlo learning, as we show in this section. We show that the linear MC algorithm (Chapter 9), taken as a forward view, can be used to derive an equivalent yet computationally cheaper backward- view algorithm using dutch traces. This is the only equivalence of forward- and backward- views that we explicitly demonstrate in this book. It gives some of the flavor of the proof of equivalence of true online TD( "
                                },
                                {
                                    "bbox": [
                                        104,
                                        381,
                                        529,
                                        488
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        381,
                                        529,
                                        488
                                    ],
                                    "type": "text",
                                    "content": " ) and the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        381,
                                        529,
                                        488
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        381,
                                        529,
                                        488
                                    ],
                                    "type": "text",
                                    "content": " - return algorithm, but is much simpler."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        489,
                        529,
                        516
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                489,
                                529,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        489,
                                        529,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "The linear version of the gradient Monte Carlo prediction algorithm (page 202) makes the following sequence of updates, one for each time step of the episode:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        131,
                        532,
                        528,
                        549
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                532,
                                528,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        532,
                                        528,
                                        549
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_{t} + \\alpha \\left[G - \\mathbf{w}_{t}^{\\top}\\mathbf{x}_{t}\\right]\\mathbf{x}_{t},\\quad 0\\leq t< T. \\tag{12.13}",
                                    "image_path": "c527af7a71b6d96a954379427005faed5b2f53db1624650133a8d58d9823c489.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        566,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                566,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "To simplify the example, we assume here that the return "
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "G"
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is a single reward received at the end of the episode (this is why "
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "G"
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is not subscripted by time) and that there is no discounting. In this case the update is also known as the Least Mean Square (LMS) rule. As a Monte Carlo algorithm, all the updates depend on the final reward/return, so none can be made until the end of the episode. The MC algorithm is an off- line algorithm and we do not seek to improve this aspect of it. Rather we seek merely an implementation of this algorithm with computational advantages. We will still update the weight vector only at the end of the episode, but we will do some computation during each step of the episode and less at its end. This will give a more equal distribution of computation—"
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "O(d)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " per step—and also remove the need to store the feature vectors at each step for use later at the end of each episode. Instead, we will introduce an additional vector memory, the eligibility trace, keeping in it a summary of all the feature vectors seen so far. This will be sufficient to efficiently recreate exactly the same overall update as the sequence of MC"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 14
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        274,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                274,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        274,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "updates (12.13), by the end of the episode:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        90,
                        159,
                        325,
                        230
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                159,
                                325,
                                230
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        325,
                                        230
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & {\\mathbf{w}_T = \\mathbf{w}_{T - 1} + \\alpha \\left(G - \\mathbf{w}_{T - 1}^\\top \\mathbf{x}_{T - 1}\\right)\\mathbf{x}_{T - 1}}\\\\ & {\\quad = \\mathbf{w}_{T - 1} + \\alpha \\mathbf{x}_{T - 1}\\left(-\\mathbf{x}_{T - 1}^\\top \\mathbf{w}_{T - 1}\\right) + \\alpha G\\mathbf{x}_{T - 1}}\\\\ & {\\quad = \\left(\\mathbf{I} - \\alpha \\mathbf{x}_{T - 1}\\mathbf{x}_{T - 1}^\\top\\right)\\mathbf{w}_{T - 1} + \\alpha G\\mathbf{x}_{T - 1}}\\\\ & {\\quad = \\mathbf{F}_{T - 1}\\mathbf{w}_{T - 1} + \\alpha G\\mathbf{x}_{T - 1}} \\end{array}",
                                    "image_path": "804a883e61108e91eb8a20ebcfcf3588f5ffdd6a6e9557bbefacb34f7a96ba29.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        76,
                        234,
                        428,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                234,
                                428,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        234,
                                        428,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        76,
                                        234,
                                        428,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{F}_t \\doteq \\mathbf{I} - \\alpha \\mathbf{x}_t \\mathbf{x}_t^\\top"
                                },
                                {
                                    "bbox": [
                                        76,
                                        234,
                                        428,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " is a forgetting, or fading, matrix. Now, recursing,"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        108,
                        250,
                        452,
                        316
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                108,
                                250,
                                452,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        250,
                                        452,
                                        316
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {= \\mathbf{F}_{T - 1}\\left(\\mathbf{F}_{T - 2}\\mathbf{w}_{T - 2} + \\alpha G\\mathbf{x}_{T - 2}\\right) + \\alpha G\\mathbf{x}_{T - 1}}\\\\ & {= \\mathbf{F}_{T - 1}\\mathbf{F}_{T - 2}\\mathbf{w}_{T - 2} + \\alpha G\\left(\\mathbf{F}_{T - 1}\\mathbf{x}_{T - 2} + \\mathbf{x}_{T - 1}\\right)}\\\\ & {= \\mathbf{F}_{T - 1}\\mathbf{F}_{T - 2}\\left(\\mathbf{F}_{T - 3}\\mathbf{w}_{T - 3} + \\alpha G\\mathbf{x}_{T - 3}\\right) + \\alpha G\\left(\\mathbf{F}_{T - 1}\\mathbf{x}_{T - 2} + \\mathbf{x}_{T - 1}\\right)}\\\\ & {= \\mathbf{F}_{T - 1}\\mathbf{F}_{T - 2}\\mathbf{F}_{T - 3}\\mathbf{w}_{T - 3} + \\alpha G\\left(\\mathbf{F}_{T - 1}\\mathbf{F}_{T - 2}\\mathbf{x}_{T - 3} + \\mathbf{F}_{T - 1}\\mathbf{x}_{T - 2} + \\mathbf{x}_{T - 1}\\right)} \\end{array}",
                                    "image_path": "59424817a0e3a4389b1f5559da8857a78c4ed123bd73375b6a3472adf0031b8b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        109,
                        342,
                        489,
                        414
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                109,
                                342,
                                489,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        342,
                                        489,
                                        414
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l l l}{{}}&{{=\\underbrace{{\\bf F}_{T-1}{\\bf F}_{T-2}\\cdots{\\bf F}_{0}{\\bf w}_{0}}_{\\bf a_{T-1}}+}}&{{\\alpha G\\underbrace{{\\bf\\sum}_{k=0}^{T-1}{\\bf F}_{T-1}{\\bf F}_{T-2}\\cdots{\\bf F}_{k+1}{\\bf x}_{k}}_{\\bf z_{T-1}}}}\\\\ {{}}&{{}}&{{}}\\\\ {{}}&{{={\\bf a}_{T-1}+\\alpha G{\\bf z}_{T-1},}}\\end{array} \\tag{12.14}",
                                    "image_path": "e2156ba150b304bfc38858d0d6a39139cadb3967df4e32964843cbc199cfc0a2.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        421,
                        490,
                        475
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                421,
                                490,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{a}_{T - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_{T - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " are the values at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "T - 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " of two auxiliary memory vectors that can be updated incrementally without knowledge of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "G"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " and with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "O(d)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " complexity per time step. The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " vector is in fact a dutch- style eligibility trace. It is initialized to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_0 = \\mathbf{x}_0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        421,
                                        490,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " and then updated according to"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        90,
                        481,
                        314,
                        687
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                481,
                                314,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        481,
                                        314,
                                        687
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{z}_{t}\\doteq \\sum_{k = 0}^{t}\\mathbf{F}_{t}\\mathbf{F}_{t - 1}\\cdot \\cdot \\cdot \\mathbf{F}_{k + 1}\\mathbf{x}_{k},\\qquad 1\\leq t< T}\\\\ & {\\quad = \\sum_{k = 0}^{t - 1}\\mathbf{F}_{t}\\mathbf{F}_{t - 1}\\cdot \\cdot \\cdot \\mathbf{F}_{k + 1}\\mathbf{x}_{k} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\mathbf{F}_{t}\\sum_{k = 0}^{t - 1}\\mathbf{F}_{t - 1}\\mathbf{F}_{t - 2}\\cdot \\cdot \\cdot \\mathbf{F}_{k + 1}\\mathbf{x}_{k} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\mathbf{F}_{t}\\mathbf{z}_{t - 1} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\left(\\mathbf{I} - \\alpha \\mathbf{x}_{t}\\mathbf{x}_{t}^{\\top}\\right)\\mathbf{z}_{t - 1} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\mathbf{z}_{t - 1} - \\alpha \\mathbf{x}_{t}\\mathbf{x}_{t}^{\\top}\\mathbf{z}_{t - 1} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\mathbf{z}_{t - 1} - \\alpha \\left(\\mathbf{z}_{t - 1}^{\\top}\\mathbf{x}_{t}\\right)\\mathbf{x}_{t} + \\mathbf{x}_{t}}\\\\ & {\\quad = \\mathbf{z}_{t - 1} + \\left(1 - \\alpha \\mathbf{z}_{t - 1}^{\\top}\\mathbf{x}_{t}\\right)\\mathbf{x}_{t},} \\end{array}",
                                    "image_path": "e3edcf5c1401a7967bd32b22f2d2d50f76cd2c7974f9b2e853e0c5f0aaf8f01f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        692,
                        490,
                        719
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                692,
                                490,
                                719
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "text",
                                    "content": "which is the dutch trace for the case of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma \\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "text",
                                    "content": " (cf. Eq. 12.11). The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{a}_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "text",
                                    "content": " auxiliary vector is initialized to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{a}_0 = \\mathbf{w}_0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        692,
                                        490,
                                        719
                                    ],
                                    "type": "text",
                                    "content": " and then updated according to"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        91,
                        725,
                        436,
                        740
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                725,
                                436,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        725,
                                        436,
                                        740
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{a}_t \\doteq \\mathbf{F}_t \\mathbf{F}_{t - 1} \\dots \\mathbf{F}_0 \\mathbf{w}_0 = \\mathbf{F}_t \\mathbf{a}_{t - 1} = \\mathbf{a}_{t - 1} - \\alpha \\mathbf{x}_t \\mathbf{x}_t^\\top \\mathbf{a}_{t - 1}, \\quad 1 \\leq t < T.",
                                    "image_path": "ea80da6673097d231a845378629c34036b65bf08b935d6ce80f94287d83896cd.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 15
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        273
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": "The auxiliary vectors, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{a}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": ", are updated on each time step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "t < T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": " and then, at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": " when "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "G"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": " is observed, they are used in (12.14) to compute "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": ". In this way we achieve exactly the same final result as the MC/LMS algorithm that has poor computational properties (12.13), but now with an incremental algorithm whose time and memory complexity per step is "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "O(d)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        273
                                    ],
                                    "type": "text",
                                    "content": ". This is surprising and intriguing because the notion of an eligibility trace (and the dutch trace in particular) has arisen in a setting without temporal- difference (TD) learning (in contrast to van Seijen and Sutton, 2014). It seems eligibility traces are not specific to TD learning at all; they are more fundamental than that. The need for eligibility traces seems to arise whenever one tries to learn long- term predictions in an efficient manner."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        105,
                        294,
                        220,
                        313
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                294,
                                220,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        294,
                                        220,
                                        313
                                    ],
                                    "type": "text",
                                    "content": "12.7 Sarsa "
                                },
                                {
                                    "bbox": [
                                        105,
                                        294,
                                        220,
                                        313
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        324,
                        530,
                        378
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                324,
                                530,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "text",
                                    "content": "Very few changes in the ideas already presented in this chapter are required in order to extend eligibility- traces to action- value methods. To learn approximate action values, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (s, a, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "text",
                                    "content": ", rather than approximate state values, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "text",
                                    "content": ", we need to use the action- value form of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        324,
                                        530,
                                        378
                                    ],
                                    "type": "text",
                                    "content": "- step return, from Chapter 10:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        132,
                        389,
                        496,
                        404
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                389,
                                496,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        389,
                                        496,
                                        404
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^n \\hat{q} (S_{t + n}, A_{t + n}, \\mathbf{w}_{t + n - 1}), \\qquad t + n < T,",
                                    "image_path": "1cb8341c5c3b03405e0e672c169e43fcd83a0c38c58136c2fc0f0b7cd4721856.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        413,
                        529,
                        454
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                413,
                                529,
                                454
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": "with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} \\doteq G_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n \\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": ". Using this, we can form the action- value form of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": "- return, which is otherwise identical to the state- value form (12.3). The action- value form of the off- line "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm (12.4) simply uses "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": " rather than "
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        413,
                                        529,
                                        454
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        131,
                        464,
                        528,
                        486
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                464,
                                528,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        464,
                                        528,
                                        486
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_t + \\alpha \\Big[ G_t^\\lambda - \\hat{q} (S_t, A_t, \\mathbf{w}_t) \\Big] \\nabla \\hat{q} (S_t, A_t, \\mathbf{w}_t), \\quad t = 0, \\ldots , T - 1, \\tag{12.15}",
                                    "image_path": "74723822d984917deb3845facda0fb4eb42a27ad39b911141d5a5a54f082d318.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        496,
                        530,
                        577
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                496,
                                530,
                                577
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}^{\\lambda} \\doteq G_{t:\\infty}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": ". The compound backup diagram for this forward view is shown in Figure 12.9. Notice the similarity to the diagram of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": " algorithm (Figure 12.1). The first update looks ahead one full step, to the next state- action pair, the second looks ahead two steps, to the second state- action pair, and so on. A final update is based on the complete return. The weighting of each "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": "- step update in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": "- return is just as in "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": " and the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        496,
                                        530,
                                        577
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm (12.3)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        578,
                        529,
                        605
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                578,
                                529,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        578,
                                        529,
                                        605
                                    ],
                                    "type": "text",
                                    "content": "The temporal- difference method for action values, known as Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        578,
                                        529,
                                        605
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        578,
                                        529,
                                        605
                                    ],
                                    "type": "text",
                                    "content": ", approximates this forward view. It has the same update rule as given earlier for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        578,
                                        529,
                                        605
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\operatorname {TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        578,
                                        529,
                                        605
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        618,
                        228,
                        631
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                618,
                                228,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        618,
                                        228,
                                        631
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_t + \\alpha \\delta_t \\mathbf{z}_t,",
                                    "image_path": "ac7ecdd317ecbeb4d697d08c59442e5cac7cb6d37adade94cc0cd012feb8d597.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        103,
                        641,
                        407,
                        655
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                641,
                                407,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        641,
                                        407,
                                        655
                                    ],
                                    "type": "text",
                                    "content": "except, naturally, using the action- value form of the TD error:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        131,
                        666,
                        528,
                        680
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                666,
                                528,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        666,
                                        528,
                                        680
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_t \\doteq R_{t + 1} + \\gamma \\hat{q} (S_{t + 1}, A_{t + 1}, \\mathbf{w}_t) - \\hat{q} (S_t, A_t, \\mathbf{w}_t), \\tag{12.16}",
                                    "image_path": "007504c439d40ae6a98a851b9cbe027a4d0babd2ee709270b4ecc2db76013de5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        103,
                        691,
                        341,
                        704
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                691,
                                341,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        691,
                                        341,
                                        704
                                    ],
                                    "type": "text",
                                    "content": "and the action- value form of the eligibility trace:"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        136,
                        714,
                        345,
                        744
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                714,
                                345,
                                744
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        714,
                                        345,
                                        744
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{z}_{-1}\\doteq \\mathbf{0},}\\\\ & {\\mathbf{z}_{t}\\doteq \\gamma \\lambda \\mathbf{z}_{t - 1} + \\nabla \\hat{q} (S_{t},A_{t},\\mathbf{w}_{t}),\\quad 0\\leq t\\leq T.} \\end{array}",
                                    "image_path": "4e29f122030a8ea06b578da702527ae3716d180044552f2ce84ea81632543229.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 12
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 16
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        154,
                        136,
                        395,
                        362
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                154,
                                136,
                                395,
                                362
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        154,
                                        136,
                                        395,
                                        362
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                154,
                                                136,
                                                395,
                                                362
                                            ],
                                            "type": "image",
                                            "image_path": "0a080a3864149fef7e415f4e2150a4c163f4cf373c01caa014a945b3c58a9fb6.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                118,
                                373,
                                434,
                                385
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        373,
                                        434,
                                        385
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                373,
                                                434,
                                                385
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.9: Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                118,
                                                373,
                                                434,
                                                385
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                118,
                                                373,
                                                434,
                                                385
                                            ],
                                            "type": "text",
                                            "content": ")s backup diagram. Compare with Figure 12.1."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        394,
                        490,
                        447
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                394,
                                490,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        394,
                                        490,
                                        447
                                    ],
                                    "type": "text",
                                    "content": "Complete pseudocode for Sarsa("
                                },
                                {
                                    "bbox": [
                                        64,
                                        394,
                                        490,
                                        447
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        394,
                                        490,
                                        447
                                    ],
                                    "type": "text",
                                    "content": ") with linear function approximation, binary features, and either accumulating or replacing traces is given in the box on the next page. This pseudocode highlights a few optimizations possible in the special case of binary features (features are either active (=1) or inactive (=0))."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        452,
                        490,
                        491
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                452,
                                490,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        452,
                                        490,
                                        491
                                    ],
                                    "type": "text",
                                    "content": "Example 12.1: Traces in Gridworld The use of eligibility traces can substantially increase the efficiency of control algorithms over one- step methods and even over "
                                },
                                {
                                    "bbox": [
                                        64,
                                        452,
                                        490,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        452,
                                        490,
                                        491
                                    ],
                                    "type": "text",
                                    "content": "- step methods. The reason for this is illustrated by the gridworld example below."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        64,
                        500,
                        504,
                        597
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                64,
                                500,
                                504,
                                597
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        500,
                                        504,
                                        597
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                500,
                                                504,
                                                597
                                            ],
                                            "type": "image",
                                            "image_path": "cf89f9447e1c76557ae6a936c857b057075a230eadb9388842535f353b1da482.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "type": "image_body"
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        602,
                        490,
                        709
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                602,
                                490,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "text",
                                    "content": "The first panel shows the path taken by an agent in a single episode. The initial estimated values were zero, and all rewards were zero except for a positive reward at the goal location marked by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{G}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "text",
                                    "content": ". The arrows in the other panels show, for various algorithms, which action- values would be increased, and by how much, upon reaching the goal. A one- step method would increment only the last action value, whereas an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "text",
                                    "content": "- step method would equally increment the last "
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "text",
                                    "content": " actions' values (assuming "
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        602,
                                        490,
                                        709
                                    ],
                                    "type": "text",
                                    "content": "), and an eligibility trace method would update all the action values up to the beginning of the episode, to different degrees, fading with recency. The fading strategy is often the best."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 17
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        116,
                        140,
                        479,
                        168
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                116,
                                140,
                                479,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "Sarsa "
                                },
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "text",
                                    "content": " with binary features and linear function approximation for estimating "
                                },
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\times \\mathbf{s}\\approx q_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        116,
                                        140,
                                        479,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        176,
                        504,
                        201
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                176,
                                504,
                                201
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "text",
                                    "content": "Input: a function "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathcal{F}(s,a)"
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "text",
                                    "content": " returning the set of (indices of) active features for "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "inline_equation",
                                    "content": "s,a"
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "text",
                                    "content": " Input: a policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        504,
                                        201
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        117,
                        203,
                        498,
                        230
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                203,
                                498,
                                230
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha >0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": " , trace decay rate "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0,1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": " , small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon >0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": " Initialize: "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = (w_{1},\\ldots ,w_{d})^{\\top}\\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": " (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "text",
                                    "content": " ), "
                                },
                                {
                                    "bbox": [
                                        117,
                                        203,
                                        498,
                                        230
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z} = (z_{1},\\ldots ,z_{d})^{\\top}\\in \\mathbb{R}^{d}"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        117,
                        236,
                        228,
                        249
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                236,
                                228,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        236,
                                        228,
                                        249
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        129,
                        250,
                        186,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                250,
                                186,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        186,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        186,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        132,
                        263,
                        392,
                        277
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                263,
                                392,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "A\\sim \\pi (\\cdot |S)"
                                },
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "text",
                                    "content": " - greedy according to "
                                },
                                {
                                    "bbox": [
                                        132,
                                        263,
                                        392,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S,\\cdot ,\\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        132,
                        278,
                        163,
                        288
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                278,
                                163,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        278,
                                        163,
                                        288
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}\\gets \\mathbf{0}"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        132,
                        290,
                        278,
                        302
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                290,
                                278,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        290,
                                        278,
                                        302
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of episode:"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        147,
                        303,
                        286,
                        315
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                303,
                                286,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        303,
                                        286,
                                        315
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        147,
                                        303,
                                        286,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        147,
                                        303,
                                        286,
                                        315
                                    ],
                                    "type": "text",
                                    "content": " , observe "
                                },
                                {
                                    "bbox": [
                                        147,
                                        303,
                                        286,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "R,S^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        148,
                        316,
                        181,
                        328
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                148,
                                316,
                                181,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        148,
                                        316,
                                        181,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\gets R"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        147,
                        330,
                        253,
                        342
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                330,
                                253,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        330,
                                        253,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        147,
                                        330,
                                        253,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "i"
                                },
                                {
                                    "bbox": [
                                        147,
                                        330,
                                        253,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " in "
                                },
                                {
                                    "bbox": [
                                        147,
                                        330,
                                        253,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathcal{F}(S,A)"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        161,
                        343,
                        214,
                        355
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                343,
                                214,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        343,
                                        214,
                                        355
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\gets \\delta - w_{i}"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        161,
                        356,
                        216,
                        367
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                356,
                                216,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        356,
                                        216,
                                        367
                                    ],
                                    "type": "inline_equation",
                                    "content": "z_{i}\\gets z_{i} + 1"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        161,
                        369,
                        213,
                        381
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                369,
                                213,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        369,
                                        213,
                                        381
                                    ],
                                    "type": "text",
                                    "content": "or "
                                },
                                {
                                    "bbox": [
                                        161,
                                        369,
                                        213,
                                        381
                                    ],
                                    "type": "inline_equation",
                                    "content": "z_{i}\\gets 1"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        409,
                        357,
                        514,
                        369
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                409,
                                357,
                                514,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        409,
                                        357,
                                        514,
                                        369
                                    ],
                                    "type": "text",
                                    "content": "(accumulating traces)"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        409,
                        370,
                        495,
                        383
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                409,
                                370,
                                495,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        409,
                                        370,
                                        495,
                                        383
                                    ],
                                    "type": "text",
                                    "content": "(replacing traces)"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        147,
                        383,
                        253,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                383,
                                253,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        383,
                                        253,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        147,
                                        383,
                                        253,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        147,
                                        383,
                                        253,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " is terminal then:"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        161,
                        396,
                        232,
                        408
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                396,
                                232,
                                408
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        396,
                                        232,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\gets \\mathbf{w} + \\alpha \\delta \\mathbf{z}"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        161,
                        410,
                        253,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                410,
                                253,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        410,
                                        253,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "Go to next episode"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        147,
                        422,
                        415,
                        435
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                422,
                                415,
                                435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "inline_equation",
                                    "content": "A\\sim \\pi (\\cdot |S^{\\prime})"
                                },
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "text",
                                    "content": " - greedy according to "
                                },
                                {
                                    "bbox": [
                                        147,
                                        422,
                                        415,
                                        435
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S^{\\prime},\\cdot ,\\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        147,
                        436,
                        323,
                        448
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                436,
                                323,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "inline_equation",
                                    "content": "i"
                                },
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "text",
                                    "content": " in "
                                },
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathcal{F}(S^{\\prime},A^{\\prime})"
                                },
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "text",
                                    "content": " .. "
                                },
                                {
                                    "bbox": [
                                        147,
                                        436,
                                        323,
                                        448
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\gets \\delta +\\gamma w_{i}"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        147,
                        450,
                        323,
                        462
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                450,
                                323,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        450,
                                        323,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\gets \\mathbf{w} + \\alpha \\delta \\mathbf{z}"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        147,
                        463,
                        218,
                        474
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                463,
                                218,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        463,
                                        218,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}\\gets \\gamma \\lambda \\mathbf{z}"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        147,
                        475,
                        224,
                        488
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                147,
                                475,
                                224,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        147,
                                        475,
                                        224,
                                        488
                                    ],
                                    "type": "inline_equation",
                                    "content": "S\\gets S^{\\prime};A\\gets A^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        104,
                        519,
                        529,
                        559
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                519,
                                529,
                                559
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        519,
                                        529,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.6 Modify the pseudocode for Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        519,
                                        529,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        519,
                                        529,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " to use dutch traces (12.11) without the other distinctive features of a true online algorithm. Assume linear function approximation and binary features."
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        104,
                        563,
                        529,
                        669
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                563,
                                529,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": "Example 12.2: Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " on Mountain Car Figure 12.10 (left) on the next page shows results with Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " on the Mountain Car task introduced in Example 10.1. The function approximation, action selection, and environmental details were exactly as in Chapter 10, and thus it is appropriate to numerically compare these results with the Chapter 10 results for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " - step Sarsa (right side of the figure). The earlier results varied the update length "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " whereas here for Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " we vary the trace parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " , which plays a similar role. The fading- trace bootstrapping strategy of Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        529,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " appears to result in more efficient learning on this problem."
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        104,
                        673,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                673,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "There is also an action- value version of our ideal TD method, the online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " - return algorithm (Section 12.4) and its efficient implementation as true online "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " (Section 12.5). Everything in Section 12.4 goes through without change other than to use the action- value form of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " - step return given at the beginning of the current section. The analyses in Sections 12.5 and 12.6 also carry through for action values, the only change being the use"
                                }
                            ]
                        }
                    ],
                    "index": 26
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 18
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        57,
                        139,
                        493,
                        346
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                57,
                                139,
                                493,
                                346
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        57,
                                        139,
                                        493,
                                        346
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                57,
                                                139,
                                                493,
                                                346
                                            ],
                                            "type": "image",
                                            "image_path": "47ea935323bb0d1d23aa400963a2d5247d0a70661113b9b1110566150d69f77b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                63,
                                357,
                                489,
                                383
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        63,
                                        357,
                                        489,
                                        383
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.10: Early performance on the Mountain Car task of Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "text",
                                            "content": ") with replacing traces and "
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "text",
                                            "content": "-step Sarsa (copied from Figure 10.4) as a function of the step size, "
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                357,
                                                489,
                                                383
                                            ],
                                            "type": "text",
                                            "content": "."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        401,
                        490,
                        455
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                401,
                                490,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "text",
                                    "content": "of state- action feature vectors "
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_t = \\mathbf{x}(S_t, A_t)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "text",
                                    "content": " instead of state feature vectors "
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}_t = \\mathbf{x}(S_t)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "text",
                                    "content": ". Pseudocode for the resulting efficient algorithm, called true online Sarsa("
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "text",
                                    "content": ") is given in the box on the next page. The figure below compares the performance of various versions of Sarsa("
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        401,
                                        490,
                                        455
                                    ],
                                    "type": "text",
                                    "content": ") on the Mountain Car example."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "image",
                    "bbox": [
                        57,
                        472,
                        496,
                        666
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                57,
                                472,
                                496,
                                666
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        57,
                                        472,
                                        496,
                                        666
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                57,
                                                472,
                                                496,
                                                666
                                            ],
                                            "type": "image",
                                            "image_path": "2406eec36fb2fec17ccf880c20396cefc12e7b9a495523c8832f5992b2189fef.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                676,
                                490,
                                724
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        676,
                                        490,
                                        724
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.11: Summary comparison of Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "text",
                                            "content": ") algorithms on the Mountain Car task. True online Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "text",
                                            "content": ") performed better than regular Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "text",
                                            "content": ") with both accumulating and replacing traces. Also included is a version of Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                676,
                                                490,
                                                724
                                            ],
                                            "type": "text",
                                            "content": ") with replacing traces in which, on each time step, the traces for the state and the actions not selected were set to zero."
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "type": "image_caption"
                        }
                    ],
                    "index": 3
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 19
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        117,
                        141,
                        396,
                        155
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                141,
                                396,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        141,
                                        396,
                                        155
                                    ],
                                    "type": "text",
                                    "content": "True online Sarsa() for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        141,
                                        396,
                                        155
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}^{\\top}\\mathbf{x} \\approx q_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        141,
                                        396,
                                        155
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        117,
                                        141,
                                        396,
                                        155
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\epsilon}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        164,
                        468,
                        178
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                164,
                                468,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        164,
                                        468,
                                        178
                                    ],
                                    "type": "text",
                                    "content": "Input: a feature function "
                                },
                                {
                                    "bbox": [
                                        117,
                                        164,
                                        468,
                                        178
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}: \\mathcal{S}^{+} \\times \\mathcal{A} \\rightarrow \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        164,
                                        468,
                                        178
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        117,
                                        164,
                                        468,
                                        178
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(terminal, \\cdot) = \\mathbf{0}"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        117,
                        179,
                        289,
                        191
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                179,
                                289,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        179,
                                        289,
                                        191
                                    ],
                                    "type": "text",
                                    "content": "Input: a policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        179,
                                        289,
                                        191
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        179,
                                        289,
                                        191
                                    ],
                                    "type": "text",
                                    "content": " (if estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        179,
                                        289,
                                        191
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        117,
                        192,
                        498,
                        205
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                192,
                                498,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "text",
                                    "content": ", trace decay rate "
                                },
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda \\in [0,1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "text",
                                    "content": ", small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        192,
                                        498,
                                        205
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon > 0"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        117,
                        206,
                        272,
                        218
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                206,
                                272,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        206,
                                        272,
                                        218
                                    ],
                                    "type": "text",
                                    "content": "Initialize: "
                                },
                                {
                                    "bbox": [
                                        117,
                                        206,
                                        272,
                                        218
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        206,
                                        272,
                                        218
                                    ],
                                    "type": "text",
                                    "content": " (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        206,
                                        272,
                                        218
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        206,
                                        272,
                                        218
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        117,
                        225,
                        228,
                        237
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                225,
                                228,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        225,
                                        228,
                                        237
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        129,
                        239,
                        186,
                        250
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                239,
                                186,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        239,
                                        186,
                                        250
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        129,
                                        239,
                                        186,
                                        250
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        132,
                        252,
                        392,
                        265
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                252,
                                392,
                                265
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot |S)"
                                },
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "text",
                                    "content": "- greedy according to "
                                },
                                {
                                    "bbox": [
                                        132,
                                        252,
                                        392,
                                        265
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S, \\cdot , \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        266,
                        192,
                        277
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                266,
                                192,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        266,
                                        192,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x} \\leftarrow \\mathbf{x}(S, A)"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        132,
                        280,
                        163,
                        290
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                280,
                                163,
                                290
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        280,
                                        163,
                                        290
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z} \\leftarrow \\mathbf{0}"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        132,
                        293,
                        178,
                        304
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                293,
                                178,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        293,
                                        178,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q_{old} \\leftarrow 0"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        132,
                        306,
                        277,
                        317
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                306,
                                277,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        306,
                                        277,
                                        317
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of episode:"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        132,
                        319,
                        287,
                        330
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                319,
                                287,
                                330
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "inline_equation",
                                    "content": "R"
                                },
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        132,
                                        319,
                                        287,
                                        330
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        132,
                        331,
                        415,
                        344
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                331,
                                415,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\sim \\pi (\\cdot |S^{\\prime})"
                                },
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "text",
                                    "content": "- greedy according to "
                                },
                                {
                                    "bbox": [
                                        132,
                                        331,
                                        415,
                                        344
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S^{\\prime}, \\cdot , \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        132,
                        345,
                        217,
                        357
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                345,
                                217,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        345,
                                        217,
                                        357
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}^{\\prime} \\leftarrow \\mathbf{x}(S^{\\prime}, A^{\\prime})"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        132,
                        358,
                        195,
                        370
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                358,
                                195,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        358,
                                        195,
                                        370
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q \\leftarrow \\mathbf{w}^{\\top} \\mathbf{x}^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        132,
                        370,
                        195,
                        383
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                370,
                                195,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        370,
                                        195,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q^{\\prime} \\leftarrow \\mathbf{w}^{\\top} \\mathbf{x}^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        132,
                        384,
                        233,
                        397
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                384,
                                233,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        384,
                                        233,
                                        397
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R + \\gamma Q^{\\prime} - Q"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        132,
                        398,
                        280,
                        411
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                398,
                                280,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        398,
                                        280,
                                        411
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z} \\leftarrow \\gamma \\lambda \\mathbf{z} + \\left(1 - \\alpha \\gamma \\lambda \\mathbf{z}^{\\top} \\mathbf{x}\\right) \\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        132,
                        412,
                        359,
                        425
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                412,
                                359,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        412,
                                        359,
                                        425
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha (\\delta + Q - Q_{old}) \\mathbf{z} - \\alpha (Q - Q_{old}) \\mathbf{x}"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        132,
                        425,
                        186,
                        437
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                425,
                                186,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        425,
                                        186,
                                        437
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q_{old} \\leftarrow Q^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        132,
                        438,
                        182,
                        450
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                438,
                                182,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        438,
                                        182,
                                        450
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x} \\leftarrow \\mathbf{x}^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        132,
                        451,
                        183,
                        462
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                451,
                                183,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        451,
                                        183,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\leftarrow A^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        132,
                        464,
                        225,
                        477
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                464,
                                225,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        464,
                                        225,
                                        477
                                    ],
                                    "type": "text",
                                    "content": "until "
                                },
                                {
                                    "bbox": [
                                        132,
                                        464,
                                        225,
                                        477
                                    ],
                                    "type": "inline_equation",
                                    "content": "S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        132,
                                        464,
                                        225,
                                        477
                                    ],
                                    "type": "text",
                                    "content": " is terminal"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        104,
                        505,
                        529,
                        545
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                505,
                                529,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        505,
                                        529,
                                        545
                                    ],
                                    "type": "text",
                                    "content": "Finally, there is also a truncated version of Sarsa() called forward Sarsa() (van Seijen, 2016), which appears to be a particularly effective model- free control method for use in conjunction with multi- layer artificial neural networks."
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        104,
                        586,
                        285,
                        603
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                586,
                                285,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        285,
                                        603
                                    ],
                                    "type": "text",
                                    "content": "12.8 Variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        285,
                                        603
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        285,
                                        603
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        285,
                                        603
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                }
                            ]
                        }
                    ],
                    "index": 25,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        619,
                        530,
                        713
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                619,
                                530,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": "We are starting now to reach the end of our development of fundamental TD learning algorithms. To present the final algorithms in their most general forms, it is useful to generalize the degree of bootstrapping and discounting beyond constant parameters to functions potentially dependent on the state and action. That is, each time step will have a different "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": ", denoted "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": ". We change notation now so that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda : \\mathcal{S} \\times \\mathcal{A} \\rightarrow [0,1]"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": " is now a function from states and actions to the unit interval such that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda_{t} \\doteq \\lambda (S_{t}, A_{t})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": ", and similarly, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma : \\mathcal{S} \\rightarrow [0,1]"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": " is a function from states to the unit interval such that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma_{t} \\doteq \\gamma (S_{t})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        619,
                                        530,
                                        713
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        104,
                        714,
                        529,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                714,
                                529,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        529,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Introducing the function "
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        529,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        714,
                                        529,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", the termination function, is particularly significant because it changes the return, the fundamental random variable whose expectation we seek to"
                                }
                            ]
                        }
                    ],
                    "index": 27
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 20
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        63,
                        140,
                        327,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                140,
                                327,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        140,
                                        327,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "estimate. Now the return is defined more generally as"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        90,
                        159,
                        489,
                        234
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                159,
                                489,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        489,
                                        234
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{G_{t}\\doteq R_{t+1}+\\gamma_{t+1}G_{t+1}}}\\\\ {{\\quad=R_{t+1}+\\gamma_{t+1}R_{t+2}+\\gamma_{t+1}\\gamma_{t+2}R_{t+3}+\\gamma_{t+1}\\gamma_{t+2}\\gamma_{t+3}R_{t+4}+\\cdots}}\\\\ {{\\quad=\\sum_{k=t}^{\\infty}\\left(\\prod_{i=t+1}^{k}\\gamma_{i}\\right)R_{k+1},}}\\end{array} \\tag{12.17}",
                                    "image_path": "c68ccbfef1de2ddb8af929251ac279be74ec3781229cb3f83ea643fd8e033575.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        239,
                        490,
                        386
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                239,
                                490,
                                386
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "text",
                                    "content": "where, to assure the sums are finite, we require that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\textstyle \\prod_{k = t}^{\\infty}\\gamma_{k} = 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "text",
                                    "content": " with probability one for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "text",
                                    "content": " . One convenient aspect of this definition is that it enables the episodic setting and its algorithms to be presented in terms of a single stream of experience, without special terminal states, start distributions, or termination times. An erstwhile terminal state becomes a state at which "
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma (s) = 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "text",
                                    "content": " and which transitions to the start distribution. In that way (and by choosing "
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma (\\cdot)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        239,
                                        490,
                                        386
                                    ],
                                    "type": "text",
                                    "content": " as a constant in all other states) we can recover the classical episodic setting as a special case. State dependent termination includes other prediction cases such as pseudo termination, in which we seek to predict a quantity without altering the flow of the Markov process. Discounted returns can be thought of as such a quantity, in which case state- dependent termination unifies the episodic and discounted- continuing cases. (The undiscounted- continuing case still needs some special treatment.)"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        387,
                        490,
                        439
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                387,
                                490,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        490,
                                        439
                                    ],
                                    "type": "text",
                                    "content": "The generalization to variable bootstrapping is not a change in the problem, like discounting, but a change in the solution strategy. The generalization affects the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        490,
                                        439
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        490,
                                        439
                                    ],
                                    "type": "text",
                                    "content": " returns for states and actions. The new state- based "
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        490,
                                        439
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        387,
                                        490,
                                        439
                                    ],
                                    "type": "text",
                                    "content": " - return can be written recursively as"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        91,
                        446,
                        489,
                        463
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                446,
                                489,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        446,
                                        489,
                                        463
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda s}\\doteq R_{t + 1} + \\gamma_{t + 1}\\left((1 - \\lambda_{t + 1})\\hat{v} (S_{t + 1},\\mathbf{w}_{t}) + \\lambda_{t + 1}G_{t + 1}^{\\lambda s}\\right), \\tag{12.18}",
                                    "image_path": "ea831d42dfa48d3b9bec6d392c231c296fb81e93144d56998fcad4a0f3ad7f4c.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        468,
                        490,
                        614
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                468,
                                490,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": "where now we have added the \" "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " \" to the superscript "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " to remind us that this is a return that bootstraps from state values, distinguishing it from returns that bootstrap from action values, which we present below with \" "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " \" in the superscript. This equation says that the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " - return is the first reward, undiscounted and unaffected by bootstrapping, plus possibly a second term to the extent that we are not discounting at the next state (that is, according to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " ; recall that this is zero if the next state is terminal). To the extent that we aren't terminating at the next state, we have a second term which is itself divided into two cases depending on the degree of bootstrapping in the state. To the extent we are bootstrapping, this term is the estimated value at the state, whereas, to the extent that we are not bootstrapping, the term is the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " - return for the next time step. The action- based "
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        468,
                                        490,
                                        614
                                    ],
                                    "type": "text",
                                    "content": " - return is either the Sarsa form"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        618,
                        489,
                        641
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                618,
                                489,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        618,
                                        489,
                                        641
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda a}\\doteq R_{t + 1} + \\gamma_{t + 1}\\Big((1 - \\lambda_{t + 1})\\hat{q} (S_{t + 1},A_{t + 1},\\mathbf{w}_{t}) + \\lambda_{t + 1}G_{t + 1}^{\\lambda a}\\Big), \\tag{12.19}",
                                    "image_path": "aaa8e714d2a92ec2ece2e5ae63a3f8c51b9eb665b95634f9e91e632189392ab1.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        647,
                        202,
                        660
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                647,
                                202,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        647,
                                        202,
                                        660
                                    ],
                                    "type": "text",
                                    "content": "or the Expected Sarsa form,"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        91,
                        666,
                        489,
                        689
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                666,
                                489,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        666,
                                        489,
                                        689
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda a}\\doteq R_{t + 1} + \\gamma_{t + 1}\\Big((1 - \\lambda_{t + 1})\\bar{V}_{t}(S_{t + 1}) + \\lambda_{t + 1}G_{t + 1}^{\\lambda a}\\Big), \\tag{12.20}",
                                    "image_path": "ba00581e87e3eb242565d40b2b0c38af716447aeece0fecfa14619ec172c9a30.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        64,
                        695,
                        333,
                        708
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                695,
                                333,
                                708
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        695,
                                        333,
                                        708
                                    ],
                                    "type": "text",
                                    "content": "where (7.8) is generalized to function approximation as"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        92,
                        714,
                        489,
                        742
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                714,
                                489,
                                742
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        714,
                                        489,
                                        742
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\bar{V}_{t}(s)\\doteq \\sum_{a}\\pi (a|s)\\hat{q} (s,a,\\mathbf{w}_{t}). \\tag{12.21}",
                                    "image_path": "2e417e0ee2845db863183d7ff0b5b8c2df38c975d82f5331d43351a954572934.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 21
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.7 Generalize the three recursive equations above to their truncated versions, defining "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:h}^{\\lambda s}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:h}^{\\lambda g}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "text",
                                    "content": ". "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        189,
                        465,
                        207
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                189,
                                465,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        189,
                                        465,
                                        207
                                    ],
                                    "type": "text",
                                    "content": "12.9 Off-policy Traces with Control Variates"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        218,
                        530,
                        286
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                218,
                                530,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        218,
                                        530,
                                        286
                                    ],
                                    "type": "text",
                                    "content": "The final step is to incorporate importance sampling. For methods using non- truncated "
                                },
                                {
                                    "bbox": [
                                        104,
                                        218,
                                        530,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        218,
                                        530,
                                        286
                                    ],
                                    "type": "text",
                                    "content": "- returns, there is not a practical option in which the importance- sampling weighting is applied to the target return (as there is for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        218,
                                        530,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        218,
                                        530,
                                        286
                                    ],
                                    "type": "text",
                                    "content": "- step methods as explained in Section 7.3). Instead, we move directly to the bootstrapping generalization of per- decision importance sampling with control variates (Section 7.4)."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        102,
                        287,
                        529,
                        314
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                287,
                                529,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        287,
                                        529,
                                        314
                                    ],
                                    "type": "text",
                                    "content": "In the state case, our final definition of the "
                                },
                                {
                                    "bbox": [
                                        102,
                                        287,
                                        529,
                                        314
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        102,
                                        287,
                                        529,
                                        314
                                    ],
                                    "type": "text",
                                    "content": "- return generalizes (12.18), after the model of (7.13), to"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        119,
                        325,
                        528,
                        346
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                119,
                                325,
                                528,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        119,
                                        325,
                                        528,
                                        346
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda s}\\doteq \\rho_{t}\\Big(R_{t + 1} + \\gamma_{t + 1}\\big((1 - \\lambda_{t + 1})\\hat{v} (S_{t + 1},\\mathbf{w}_{t}) + \\lambda_{t + 1}G_{t + 1}^{\\lambda s}\\big)\\Big) + (1 - \\rho_{t})\\hat{v} (S_{t},\\mathbf{w}_{t}), \\tag{12.22}",
                                    "image_path": "a37c4304fd588c01cd5b129e521f4ba2d44b8de9c5de64b6d838414745860b10.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        103,
                        357,
                        529,
                        401
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                357,
                                529,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        357,
                                        529,
                                        401
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        103,
                                        357,
                                        529,
                                        401
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t} = \\frac{\\pi(A_{t}|S_{t})}{b(A_{t}|S_{t})}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        357,
                                        529,
                                        401
                                    ],
                                    "type": "text",
                                    "content": " is the usual single- step importance sampling ratio. Much like the other returns we have seen in this book, this final "
                                },
                                {
                                    "bbox": [
                                        103,
                                        357,
                                        529,
                                        401
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        357,
                                        529,
                                        401
                                    ],
                                    "type": "text",
                                    "content": "- return can be approximated simply in terms of sums of the state- based TD error,"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        131,
                        412,
                        528,
                        426
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                412,
                                528,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        412,
                                        528,
                                        426
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t}^{s}\\doteq R_{t + 1} + \\gamma_{t + 1}\\hat{v} (S_{t + 1},\\mathbf{w}_{t}) - \\hat{v} (S_{t},\\mathbf{w}_{t}), \\tag{12.23}",
                                    "image_path": "31f993a9312231505ab221c5626182eb4f9ec34dce4b6095a4b28941d001681b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        103,
                        440,
                        116,
                        450
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                440,
                                116,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        440,
                                        116,
                                        450
                                    ],
                                    "type": "text",
                                    "content": "as"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        459,
                        528,
                        496
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                459,
                                528,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        459,
                                        528,
                                        496
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda s}\\approx \\hat{v} (S_{t},\\mathbf{w}_{t}) + \\rho_{t}\\sum_{k = t}^{\\infty}\\delta_{k}^{s}\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}, \\tag{12.24}",
                                    "image_path": "591cc57f6981d6300276959ff4fc4d999ebf15d4d2c2abe1ca268b5150486daa.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        102,
                        506,
                        531,
                        521
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                506,
                                531,
                                521
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        506,
                                        531,
                                        521
                                    ],
                                    "type": "text",
                                    "content": "with the approximation becoming exact if the approximate value function does not change."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        104,
                        525,
                        530,
                        551
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                525,
                                530,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.8 Prove that (12.24) becomes exact if the value function does not change. To save writing, consider the case of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "text",
                                    "content": ", and use the notation "
                                },
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{k}\\doteq \\hat{v} (S_{k},\\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "text",
                                    "content": ". "
                                },
                                {
                                    "bbox": [
                                        104,
                                        525,
                                        530,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        104,
                        556,
                        530,
                        583
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                556,
                                530,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        530,
                                        583
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.9 The truncated version of the general off- policy return is denoted "
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        530,
                                        583
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:h}^{\\lambda s}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        530,
                                        583
                                    ],
                                    "type": "text",
                                    "content": ". Guess the correct equation, based on (12.24). "
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        530,
                                        583
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        114,
                        585,
                        530,
                        598
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                114,
                                585,
                                530,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        114,
                                        585,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": "The above form of the "
                                },
                                {
                                    "bbox": [
                                        114,
                                        585,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        114,
                                        585,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": "- return (12.24) is convenient to use in a forward- view update,"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        131,
                        607,
                        376,
                        666
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                607,
                                376,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        607,
                                        376,
                                        666
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {{\\bf w}_{t + 1} = {\\bf w}_{t} + \\alpha \\left(G_{t}^{\\lambda s} - \\hat{v}\\left(S_{t},{\\bf w}_{t}\\right)\\right)\\nabla \\hat{v}\\left(S_{t},{\\bf w}_{t}\\right)}\\\\ & {\\quad \\quad \\approx {\\bf w}_{t} + \\alpha \\rho_{t}\\left(\\sum_{k = t}^{\\infty}\\delta_{k}^{s}\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}\\right)\\nabla \\hat{v}\\left(S_{t},{\\bf w}_{t}\\right),} \\end{array}",
                                    "image_path": "3aa7c5a68c6c67660707196c2e756b361661a47d0af51264043a34caaf074fc5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        104,
                        673,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                673,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "which to the experienced eye looks like an eligibility- based TD update—the product is like an eligibility trace and it is multiplied by TD errors. But this is just one time step of a forward view. The relationship that we are looking for is that the forward- view update, summed over time, is approximately equal to a backward- view update, summed over time (this relationship is only approximate because again we ignore changes in the value"
                                }
                            ]
                        }
                    ],
                    "index": 14
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 22
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        63,
                        140,
                        355,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                140,
                                355,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        140,
                                        355,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "function). The sum of the forward- view update over time is"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        90,
                        165,
                        491,
                        299
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                165,
                                491,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        165,
                                        491,
                                        299
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\sum_{t = 0}^{\\infty}(\\mathbf{w}_{t + 1} - \\mathbf{w}_{t})\\approx \\sum_{t = 0}^{\\infty}\\sum_{k = t}^{\\infty}\\alpha \\rho_{t}\\delta_{k}^{s}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}}\\\\ & {\\qquad = \\sum_{k = 0}^{\\infty}\\sum_{t = 0}^{k}\\alpha \\rho_{t}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\delta_{k}^{s}\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}}\\\\ & {\\qquad \\mathrm{(using~the~summation~rule:~}\\sum_{t = x}^{y}\\sum_{k = t}^{y} = \\sum_{k = x}^{y}\\sum_{t = x}^{k})}\\\\ & {\\qquad = \\sum_{k = 0}^{\\infty}\\alpha \\delta_{k}^{s}\\sum_{t = 0}^{k}\\rho_{t}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i},} \\end{array}",
                                    "image_path": "584fb3961680ecf5922758ec21fc55790de6841d07c6b9dc9b8b6d07d402f426.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        305,
                        490,
                        360
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                305,
                                490,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        305,
                                        490,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "which would be in the form of the sum of a backward- view TD update if the entire expression from the second sum on could be written and updated incrementally as an eligibility trace, which we now show can be done. That is, we show that if this expression was the trace at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        305,
                                        490,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        64,
                                        305,
                                        490,
                                        360
                                    ],
                                    "type": "text",
                                    "content": ", then we could update it from its value at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        305,
                                        490,
                                        360
                                    ],
                                    "type": "inline_equation",
                                    "content": "k - 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        305,
                                        490,
                                        360
                                    ],
                                    "type": "text",
                                    "content": " by:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        90,
                        369,
                        388,
                        523
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                90,
                                369,
                                388,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        369,
                                        388,
                                        523
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{z}_{k} = \\sum_{t = 0}^{k}\\rho_{t}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}}\\\\ & {\\quad = \\sum_{t = 0}^{k - 1}\\rho_{t}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\prod_{i = t + 1}^{k}\\gamma_{i}\\lambda_{i}\\rho_{i}\\quad +\\quad \\rho_{k}\\nabla \\hat{v} (S_{k},\\mathbf{w}_{k})}\\\\ & {\\quad = \\gamma_{k}\\lambda_{k}\\rho_{k}\\sum_{t = 0}^{k - 1}\\rho_{t}\\nabla \\hat{v} (S_{t},\\mathbf{w}_{t})\\prod_{i = t + 1}^{k - 1}\\gamma_{i}\\lambda_{i}\\rho_{i}\\quad +\\quad \\rho_{k}\\nabla \\hat{v} (S_{k},\\mathbf{w}_{k})}\\\\ & {\\quad = \\rho_{k}\\big(\\gamma_{k}\\lambda_{k}\\mathbf{z}_{k - 1} + \\nabla \\hat{v} (S_{k},\\mathbf{w}_{k})\\big),} \\end{array}",
                                    "image_path": "df123cadb6ddb2d12a3b28ca2f9e476726d10b9295a45cdb556aabaa93e123a5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        531,
                        489,
                        557
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                531,
                                489,
                                557
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        531,
                                        489,
                                        557
                                    ],
                                    "type": "text",
                                    "content": "which, changing the index from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        531,
                                        489,
                                        557
                                    ],
                                    "type": "inline_equation",
                                    "content": "k"
                                },
                                {
                                    "bbox": [
                                        64,
                                        531,
                                        489,
                                        557
                                    ],
                                    "type": "text",
                                    "content": " to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        531,
                                        489,
                                        557
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        531,
                                        489,
                                        557
                                    ],
                                    "type": "text",
                                    "content": ", is the general accumulating trace update for state values:"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        91,
                        567,
                        489,
                        583
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                567,
                                489,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        567,
                                        489,
                                        583
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{z}_{t} \\doteq \\rho_{t} \\big(\\gamma_{t} \\lambda_{t} \\mathbf{z}_{t - 1} + \\nabla \\hat{v} (S_{t}, \\mathbf{w}_{t}) \\big), \\tag{12.25}",
                                    "image_path": "e8a345e21a359c81b4a3a334b0484c63d2068aef7c6cb792ca6dc2c473301f46.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        592,
                        490,
                        686
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                592,
                                490,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": "This eligibility trace, together with the usual semi- gradient parameter- update rule for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": " (12.7), forms a general "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": " algorithm that can be applied to either on- policy or off- policy data. In the on- policy case, the algorithm is exactly "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": " because "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": " is always 1 and (12.25) becomes the usual accumulating trace (12.5) (extended to variable "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        592,
                                        490,
                                        686
                                    ],
                                    "type": "text",
                                    "content": "). In the off- policy case, the algorithm often works well but, as a semi- gradient method, is not guaranteed to be stable. In the next few sections we will consider extensions of it that do guarantee stability."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        687,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                687,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "A very similar series of steps can be followed to derive the off- policy eligibility traces for action- value methods and corresponding general Sarsa("
                                },
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ") algorithms. One could start with either recursive form for the general action- based "
                                },
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return, (12.19) or (12.20), but the latter (the Expected Sarsa form) works out to be simpler. We extend (12.20) to the"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 23
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        103,
                        140,
                        354,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                140,
                                354,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        140,
                                        354,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "off- policy case after the model of (7.14) to produce"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        103,
                        165,
                        531,
                        216
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                165,
                                531,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        165,
                                        531,
                                        216
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {G_{t}^{\\lambda a}\\doteq R_{t + 1} + \\gamma_{t + 1}\\Big((1 - \\lambda_{t + 1})\\bar{V}_{t}(S_{t + 1}) + \\lambda_{t + 1}\\big[\\rho_{t + 1}G_{t + 1}^{\\lambda a} + \\bar{V}_{t}(S_{t + 1}) - \\rho_{t + 1}\\hat{q} (S_{t + 1},A_{t + 1},\\mathbf{w}_{t})\\big]\\Big)}\\\\ & {\\qquad = R_{t + 1} + \\gamma_{t + 1}\\Big(\\bar{V}_{t}(S_{t + 1}) + \\lambda_{t + 1}\\rho_{t + 1}\\big[G_{t + 1}^{\\lambda a} - \\hat{q} (S_{t + 1},A_{t + 1},\\mathbf{w}_{t})\\big]\\Big)} \\end{array} \\tag{12.26}",
                                    "image_path": "3e26dec02234de316af6f11fe57848665947ac7aaea39b228e276932eb9c4cb8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        103,
                        224,
                        530,
                        251
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                224,
                                530,
                                251
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        530,
                                        251
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        530,
                                        251
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{V}_{t}(S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        530,
                                        251
                                    ],
                                    "type": "text",
                                    "content": " is as given by (12.21). Again the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        530,
                                        251
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        103,
                                        224,
                                        530,
                                        251
                                    ],
                                    "type": "text",
                                    "content": "- return can be written approximately as the sum of TD errors,"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        132,
                        256,
                        528,
                        294
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                256,
                                528,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        256,
                                        528,
                                        294
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda a} \\approx \\hat{q} (S_{t}, A_{t}, \\mathbf{w}_{t}) + \\sum_{k = t}^{\\infty} \\delta_{k}^{a} \\prod_{i = t + 1}^{k} \\gamma_{i} \\lambda_{i} \\rho_{i}, \\tag{12.27}",
                                    "image_path": "5d8b7c5badcd971ba61b2cf041d43ab5d18fbc6f39046dd6cf5253cb91d8ff09.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        301,
                        382,
                        314
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                301,
                                382,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        301,
                                        382,
                                        314
                                    ],
                                    "type": "text",
                                    "content": "using the expectation form of the action- based TD error:"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        132,
                        320,
                        528,
                        335
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                320,
                                528,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        320,
                                        528,
                                        335
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t}^{a} = R_{t + 1} + \\gamma_{t + 1} \\bar{V}_{t}(S_{t + 1}) - \\hat{q} (S_{t}, A_{t}, \\mathbf{w}_{t}). \\tag{12.28}",
                                    "image_path": "4af08f2891be3112f926c34c461e4d7e3c175919be77f977d595a8c1d0bc5f5a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        103,
                        343,
                        530,
                        370
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                343,
                                530,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        343,
                                        530,
                                        370
                                    ],
                                    "type": "text",
                                    "content": "As before, the approximation becomes exact if the approximate value function does not change."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        373,
                        531,
                        415
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                373,
                                531,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.10 Prove that (12.27) becomes exact if the value function does not change. To save writing, consider the case of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": ", and use the notation "
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q_{k} = \\hat{q} (S_{k}, A_{k}, \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": ". Hint: Start by writing out "
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{0}^{a}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{0}^{\\lambda a}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": ", then "
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{0}^{\\lambda a} - Q_{0}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        373,
                                        531,
                                        415
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        104,
                        419,
                        530,
                        445
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                419,
                                530,
                                445
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        419,
                                        530,
                                        445
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.11 The truncated version of the general off- policy return is denoted "
                                },
                                {
                                    "bbox": [
                                        104,
                                        419,
                                        530,
                                        445
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t;h}^{\\lambda a}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        419,
                                        530,
                                        445
                                    ],
                                    "type": "text",
                                    "content": ". Guess the correct equation for it, based on (12.27)."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        447,
                        530,
                        487
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                447,
                                530,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        487
                                    ],
                                    "type": "text",
                                    "content": "Using steps entirely analogous to those for the state case, one can write a forward- view update based on (12.27), transform the sum of the updates using the summation rule, and finally derive the following form for the eligibility trace for action values:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        132,
                        497,
                        528,
                        511
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                497,
                                528,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        497,
                                        528,
                                        511
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{z}_{t} \\doteq \\gamma_{t} \\lambda_{t} \\rho_{t} \\mathbf{z}_{t - 1} + \\nabla \\hat{q} (S_{t}, A_{t}, \\mathbf{w}_{t}). \\tag{12.29}",
                                    "image_path": "fecc67f03673dd1b99d4f192613eedb2f010731e11c48d90c3b8035514ad1dad.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        104,
                        522,
                        530,
                        629
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                522,
                                530,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "text",
                                    "content": "This eligibility trace, together with the expectation- based TD error (12.28) and the usual semi- gradient parameter- update rule (12.7), forms an elegant, efficient Expected Sarsa("
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "text",
                                    "content": ") algorithm that can be applied to either on- policy or off- policy data. It is probably the best algorithm of this type at the current time (though of course it is not guaranteed to be stable until combined in some way with one of the methods presented in the following sections). In the on- policy case with constant "
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "text",
                                    "content": ", and the usual state- action TD error (12.16), the algorithm would be identical to the Sarsa("
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        629
                                    ],
                                    "type": "text",
                                    "content": ") algorithm presented in Section 12.7."
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        104,
                        634,
                        530,
                        674
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                634,
                                530,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        634,
                                        530,
                                        674
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.12 Show in detail the steps outlined above for deriving (12.29) from (12.27). Start with the update (12.15), substitute "
                                },
                                {
                                    "bbox": [
                                        104,
                                        634,
                                        530,
                                        674
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}^{\\lambda a}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        634,
                                        530,
                                        674
                                    ],
                                    "type": "text",
                                    "content": " from (12.26) for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        634,
                                        530,
                                        674
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t}^{\\lambda}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        634,
                                        530,
                                        674
                                    ],
                                    "type": "text",
                                    "content": ", then follow similar steps as led to (12.25)."
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        104,
                        675,
                        531,
                        741
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                675,
                                531,
                                741
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        675,
                                        531,
                                        741
                                    ],
                                    "type": "text",
                                    "content": "At "
                                },
                                {
                                    "bbox": [
                                        104,
                                        675,
                                        531,
                                        741
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        675,
                                        531,
                                        741
                                    ],
                                    "type": "text",
                                    "content": ", these algorithms become closely related to corresponding Monte Carlo algorithms. One might expect that an exact equivalence would hold for episodic problems and off- line updating, but in fact the relationship is subtler and slightly weaker than that. Under these most favorable conditions still there is not an episode by episode equivalence of updates, only of their expectations. This should not be surprising as these methods"
                                }
                            ]
                        }
                    ],
                    "index": 13
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 24
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        286
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": "make irrevocable updates as a trajectory unfolds, whereas true Monte Carlo methods would make no update for a trajectory if any action within it has zero probability under the target policy. In particular, all of these methods, even at "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": ", still bootstrap in the sense that their targets depend on the current value estimates—it's just that the dependence cancels out in expected value. Whether this is a good or bad property in practice is another question. Recently, methods have been proposed that do achieve an exact equivalence (Sutton, Mahmood, Precup and van Hasselt, 2014). These methods require an additional vector of \"provisional weights\" that keep track of updates which have been made but may need to be retracted (or emphasized) depending on the actions taken later. The state and state- action versions of these methods are called "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{PTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{PQ}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        286
                                    ],
                                    "type": "text",
                                    "content": " respectively, where the 'P' stands for Provisional."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        288,
                        489,
                        328
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                288,
                                489,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        288,
                                        489,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "The practical consequences of all these new off- policy methods have not yet been established. Undoubtedly, issues of high variance will arise as they do in all off- policy methods using importance sampling (Section 11.9)."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        329,
                        489,
                        461
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                329,
                                489,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        329,
                                        489,
                                        461
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        329,
                                        489,
                                        461
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda < 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        329,
                                        489,
                                        461
                                    ],
                                    "type": "text",
                                    "content": ", then all these off- policy algorithms involve bootstrapping and the deadly triad applies (Section 11.3), meaning that they can be guaranteed stable only for the tabular case, for state aggregation, and for other limited forms of function approximation. For linear and more- general forms of function approximation the parameter vector may diverge to infinity as in the examples in Chapter 11. As we discussed there, the challenge of off- policy learning has two parts. Off- policy eligibility traces deal effectively with the first part of the challenge, correcting for the expected value of the targets, but not at all with the second part of the challenge, having to do with the distribution of updates. Algorithmic strategies for meeting the second part of the challenge of off- policy learning with eligibility traces are summarized in Section 12.11."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        467,
                        489,
                        493
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                467,
                                489,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        467,
                                        489,
                                        493
                                    ],
                                    "type": "text",
                                    "content": "Exercise 12.13 What are the dutch- trace and replacing- trace versions of off- policy eligibility traces for state- value and action- value methods?"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        65,
                        517,
                        398,
                        536
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                517,
                                398,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        517,
                                        398,
                                        536
                                    ],
                                    "type": "text",
                                    "content": "12.10 Watkins's "
                                },
                                {
                                    "bbox": [
                                        65,
                                        517,
                                        398,
                                        536
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{Q}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        65,
                                        517,
                                        398,
                                        536
                                    ],
                                    "type": "text",
                                    "content": " to Tree-Backup "
                                },
                                {
                                    "bbox": [
                                        65,
                                        517,
                                        398,
                                        536
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        547,
                        489,
                        720
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                547,
                                489,
                                720
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": "Several methods have been proposed over the years to extend Q- learning to eligibility traces. The original is Watkins's "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": ", which decays its eligibility traces in the usual way as long as a greedy action was taken, then cuts the traces to zero after the first non- greedy action. The backup diagram for Watkins's "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": " is shown in Figure 12.12. In Chapter 6, we unified Q- learning and Expected Sarsa in the off- policy version of the latter, which includes Q- learning as a special case, and generalizes it to arbitrary target policies, and in the previous section of this chapter we completed our treatment of Expected Sarsa by generalizing it to off- policy eligibility traces. In Chapter 7, however, we distinguished "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": "- step Expected Sarsa from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": "- step Tree Backup, where the latter retained the property of not using importance sampling. It remains then to present the eligibility trace version of Tree Backup, which we will call Tree- Backup "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": ", or "
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "TB(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        547,
                                        489,
                                        720
                                    ],
                                    "type": "text",
                                    "content": " for short. This is arguably the true successor to Q- learning because it retains its appealing absence of importance sampling even though it can be applied to off- policy data."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 25
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        138,
                        136,
                        456,
                        389
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                138,
                                136,
                                456,
                                389
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        138,
                                        136,
                                        456,
                                        389
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                138,
                                                136,
                                                456,
                                                389
                                            ],
                                            "type": "image",
                                            "image_path": "ba4586ee4f755e6076fefd46a17cd6c8eccc5296a558eef031995bba196a5b08.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                102,
                                400,
                                530,
                                426
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        102,
                                        400,
                                        530,
                                        426
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                102,
                                                400,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.12: The backup diagram for Watkins's "
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                400,
                                                530,
                                                426
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\mathsf{Q}(\\lambda)"
                                        },
                                        {
                                            "bbox": [
                                                102,
                                                400,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": ". The series of component updates ends either with the end of the episode or with the first nongreedy action, whichever comes first."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        448,
                        531,
                        530
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                448,
                                531,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "text",
                                    "content": "The concept of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TB}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "text",
                                    "content": " is straightforward. As shown in its backup diagram in Figure 12.13, the tree- backup updates of each length (from Section 7.5) are weighted in the usual way dependent on the bootstrapping parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "text",
                                    "content": ". To get the detailed equations, with the right indices on the general bootstrapping and discounting parameters, it is best to start with a recursive form (12.20) for the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        448,
                                        531,
                                        530
                                    ],
                                    "type": "text",
                                    "content": "- return using action values, and then expand the bootstrapping case of the target after the model of (7.16):"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        538,
                        555,
                        602
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                538,
                                555,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        538,
                                        555,
                                        602
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{G_{t}^{\\lambda a}\\doteq R_{t+1}+\\gamma_{t+1}\\biggl((1-\\lambda_{t+1})\\bar{V}_{t}(S_{t+1})+\\lambda_{t+1}\\biggl[\\sum_{a\\not=A_{t+1}}\\pi(a|S_{t+1})\\hat{q}(S_{t+1},a,{\\bf w}_{t})+\\pi(A_{t+1}|S_{t+1})G_{t+1}^{\\lambda a}\\biggr]\\biggr)}}\\\\ {{\\qquad=R_{t+1}+\\gamma_{t+1}\\biggl(\\bar{V}_{t}(S_{t+1})+\\lambda_{t+1}\\pi(A_{t+1}|S_{t+1})\\biggl(G_{t+1}^{\\lambda a}-\\hat{q}(S_{t+1},A_{t+1},{\\bf w}_{t})\\biggr)\\biggr)}}\\end{array}",
                                    "image_path": "90cb8772e815e5f36dae17be4e76b21f781940290b025b3b511d7b73ba83ed61.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        602,
                        530,
                        628
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                602,
                                530,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        602,
                                        530,
                                        628
                                    ],
                                    "type": "text",
                                    "content": "As per the usual pattern, it can also be written approximately (ignoring changes in the approximate value function) as a sum of TD errors,"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        132,
                        636,
                        361,
                        674
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                636,
                                361,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        636,
                                        361,
                                        674
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t}^{\\lambda a} \\approx \\hat{q} (S_{t}, A_{t}, \\mathbf{w}_{t}) + \\sum_{k = t}^{\\infty} \\delta_{k}^{a} \\prod_{i = t + 1}^{k} \\gamma_{i} \\lambda_{i} \\pi (A_{i} | S_{i}),",
                                    "image_path": "d10f860646b3e0281d5f4decbefa200ca4c09d43c5f7eec83ba2121f370442ac.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        679,
                        419,
                        692
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                679,
                                419,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        679,
                                        419,
                                        692
                                    ],
                                    "type": "text",
                                    "content": "using the expectation form of the action- based TD error (12.28)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        694,
                        530,
                        721
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                694,
                                530,
                                721
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        694,
                                        530,
                                        721
                                    ],
                                    "type": "text",
                                    "content": "Following the same steps as in the previous section, we arrive at a special eligibility trace update involving the target- policy probabilities of the selected actions,"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        730,
                        326,
                        743
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                730,
                                326,
                                743
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        730,
                                        326,
                                        743
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{z}_{t} \\doteq \\gamma_{t} \\lambda_{t} \\pi (A_{t} | S_{t}) \\mathbf{z}_{t - 1} + \\nabla \\hat{q} (S_{t}, A_{t}, \\mathbf{w}_{t}).",
                                    "image_path": "6a4ae426d548bed75eea2b330feb0caa3e4dd784446cb557927ed619b48f12ee.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 26
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        132,
                        136,
                        423,
                        390
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                132,
                                136,
                                423,
                                390
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        132,
                                        136,
                                        423,
                                        390
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                132,
                                                136,
                                                423,
                                                390
                                            ],
                                            "type": "image",
                                            "image_path": "a588631cd27f1afe6a7d6a1399420f6ef4b0183e09751e8e1ae9d48aa8a8e086.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                85,
                                399,
                                468,
                                412
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        85,
                                        399,
                                        468,
                                        412
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                85,
                                                399,
                                                468,
                                                412
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.13: The backup diagram for the "
                                        },
                                        {
                                            "bbox": [
                                                85,
                                                399,
                                                468,
                                                412
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                85,
                                                399,
                                                468,
                                                412
                                            ],
                                            "type": "text",
                                            "content": " version of the Tree Backup algorithm."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        442,
                        490,
                        495
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                442,
                                490,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "This, together with the usual parameter- update rule (12.7), defines the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TB}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " algorithm. Like all semi- gradient algorithms, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TB}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " is not guaranteed to be stable when used with off- policy data and with a powerful function approximator. To obtain those assurances, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TB}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        490,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " would have to be combined with one of the methods presented in the next section."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        65,
                        501,
                        488,
                        516
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                501,
                                488,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        501,
                                        488,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "*Exercise 12.14 How might Double Expected Sarsa be extended to eligibility traces? "
                                },
                                {
                                    "bbox": [
                                        65,
                                        501,
                                        488,
                                        516
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        65,
                        545,
                        433,
                        564
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                545,
                                433,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        545,
                                        433,
                                        564
                                    ],
                                    "type": "text",
                                    "content": "12.11 Stable Off-policy Methods with Traces"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        577,
                        490,
                        656
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                577,
                                490,
                                656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        577,
                                        490,
                                        656
                                    ],
                                    "type": "text",
                                    "content": "Several methods using eligibility traces have been proposed that achieve guarantees of stability under off- policy training, and here we present four of the most important using this book's standard notation, including general bootstrapping and discounting functions. All are based on either the Gradient- TD or the Emphatic- TD ideas presented in Sections 11.7 and 11.8. All the algorithms assume linear function approximation, though extensions to nonlinear function approximation can also be found in the literature."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        658,
                        489,
                        711
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                658,
                                489,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "inline_equation",
                                    "content": "G T D(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "text",
                                    "content": " is the eligibility- trace algorithm analogous to TDC, the better of the two state- value Gradient- TD prediction algorithms discussed in Section 11.7. Its goal is to learn a parameter "
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{v} (s,\\mathbf{w})\\doteq \\mathbf{w}_{t}^{\\top}\\mathbf{x}(s)\\approx v_{\\pi}(s)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "text",
                                    "content": ", even from data that is due to following another policy "
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        64,
                                        658,
                                        489,
                                        711
                                    ],
                                    "type": "text",
                                    "content": ". Its update is"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        726,
                        338,
                        741
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                726,
                                338,
                                741
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        726,
                                        338,
                                        741
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t}^{s}\\mathbf{z}_{t} - \\alpha \\gamma_{t + 1}(1 - \\lambda_{t + 1})\\left(\\mathbf{z}_{t}^{\\top}\\mathbf{v}_{t}\\right)\\mathbf{x}_{t + 1},",
                                    "image_path": "de9fcb5d9fdb7fedee3baa6cd8c35dac67ddc567ae5a732696f2f0f24bd858c6.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 27
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        102,
                        140,
                        527,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                140,
                                527,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "with "
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_t^s"
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t"
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_t"
                                },
                                {
                                    "bbox": [
                                        102,
                                        140,
                                        527,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " defined in the usual ways for state values (12.23) (12.25) (11.1), and"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        131,
                        165,
                        528,
                        181
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                165,
                                528,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        165,
                                        528,
                                        181
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{v}_{t + 1}\\doteq \\mathbf{v}_t + \\beta \\delta_t^s\\mathbf{z}_t - \\beta \\left(\\mathbf{v}_t^\\top \\mathbf{x}_t\\right)\\mathbf{x}_t, \\tag{12.30}",
                                    "image_path": "a27432a8c5848c89a4585ecc65b89e93760b509f89e44855dd7841b81f021f38.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        103,
                        192,
                        530,
                        219
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                192,
                                530,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": "where, as in Section 11.7, "
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{v}\\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": " is a vector of the same dimension as "
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": ", initialized to "
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{v}_0 = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\beta >0"
                                },
                                {
                                    "bbox": [
                                        103,
                                        192,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": " is a second step- size parameter."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        220,
                        530,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                220,
                                530,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "GQ(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " is the Gradient- TD algorithm for action values with eligibility traces. Its goal is to learn a parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (s,a,\\mathbf{w}_t)\\doteq \\mathbf{w}_t^\\top \\mathbf{x}(s,a)\\approx q_\\pi (s,a)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " from off- policy data. If the target policy is "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "- greedy, or otherwise biased toward the greedy policy for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": ", then "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{GQ}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " can be used as a control algorithm. Its update is"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        132,
                        286,
                        379,
                        301
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                286,
                                379,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        286,
                                        379,
                                        301
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_t + \\alpha \\delta_t^a\\mathbf{z}_t - \\alpha \\gamma_{t + 1}(1 - \\lambda_{t + 1})\\left(\\mathbf{z}_t^\\top \\mathbf{v}_t\\right)\\bar{\\mathbf{x}}_{t + 1},",
                                    "image_path": "375592ab63d014d2854edfce7857477fcefa84c19981894592d7128585f80359.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        103,
                        312,
                        437,
                        325
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                312,
                                437,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        312,
                                        437,
                                        325
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        103,
                                        312,
                                        437,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{\\mathbf{x}}_t"
                                },
                                {
                                    "bbox": [
                                        103,
                                        312,
                                        437,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " is the average feature vector for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        312,
                                        437,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_t"
                                },
                                {
                                    "bbox": [
                                        103,
                                        312,
                                        437,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " under the target policy,"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        132,
                        337,
                        251,
                        364
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                337,
                                251,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        337,
                                        251,
                                        364
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\bar{\\mathbf{x}}_t\\doteq \\sum_a\\pi (a|S_t)\\mathbf{x}(S_t,a),",
                                    "image_path": "73eb402d0a678b0b0a40c1f70cdb5495f0859d3b94aca201840d049ac3dd94ca.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        103,
                        374,
                        421,
                        389
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                374,
                                421,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        374,
                                        421,
                                        389
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_t^a"
                                },
                                {
                                    "bbox": [
                                        103,
                                        374,
                                        421,
                                        389
                                    ],
                                    "type": "text",
                                    "content": " is the expectation form of the TD error, which can be written"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        400,
                        299,
                        415
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                400,
                                299,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        400,
                                        299,
                                        415
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_t^a\\doteq R_{t + 1} + \\gamma_{t + 1}\\mathbf{w}_t^\\top \\bar{\\mathbf{x}}_{t + 1} - \\mathbf{w}_t^\\top \\mathbf{x}_t,",
                                    "image_path": "d1733fe2f85f98b2bf6b504b3cffd50c7847731fc2ce9d8d17733d97c4d5db1b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        103,
                        426,
                        530,
                        452
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                426,
                                530,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t"
                                },
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "text",
                                    "content": " is defined in the usual way for action values (12.29), and the rest is as in "
                                },
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{GTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "text",
                                    "content": ", including the update for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{v}_t"
                                },
                                {
                                    "bbox": [
                                        103,
                                        426,
                                        530,
                                        452
                                    ],
                                    "type": "text",
                                    "content": " (12.30)."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        104,
                        454,
                        531,
                        535
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                454,
                                531,
                                535
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "HTD(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " is a hybrid state- value algorithm combining aspects of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{GTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": ". Its most appealing feature is that it is a strict generalization of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " to off- policy learning, meaning that if the behavior policy happens to be the same as the target policy, then "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{HTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " becomes the same as "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": ", which is not true for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{GTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": ". This is appealing because "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " is often faster than "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{GTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " when both algorithms converge, and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " requires setting only a single step size. "
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{HTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        454,
                                        531,
                                        535
                                    ],
                                    "type": "text",
                                    "content": " is defined by"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        132,
                        543,
                        445,
                        623
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                543,
                                445,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        543,
                                        445,
                                        623
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t}^{s}\\mathbf{z}_{t} + \\alpha \\left((\\mathbf{z}_{t} - \\mathbf{z}_{t}^{b})^{\\top}\\mathbf{v}_{t}\\right)(\\mathbf{x}_{t} - \\gamma_{t + 1}\\mathbf{x}_{t + 1}),}\\\\ & {\\mathbf{v}_{t + 1}\\doteq \\mathbf{v}_{t} + \\beta \\delta_{t}^{s}\\mathbf{z}_{t} - \\beta \\left(\\mathbf{z}_{t}^{b}^{\\top}\\mathbf{v}_{t}\\right)(\\mathbf{x}_{t} - \\gamma_{t + 1}\\mathbf{x}_{t + 1}),\\quad \\mathrm{with~}\\mathbf{v}_{0}\\doteq \\mathbf{0},}\\\\ & {\\quad \\mathbf{z}_{t}\\doteq \\rho_{t}(\\gamma_{t}\\lambda_{t}\\mathbf{z}_{t - 1} + \\mathbf{x}_{t}),\\quad \\mathrm{with~}\\mathbf{z}_{-1}\\doteq \\mathbf{0},}\\\\ & {\\quad \\mathbf{z}_{t}^{b}\\doteq \\gamma_{t}\\lambda_{t}\\mathbf{z}_{t - 1}^{b} + \\mathbf{x}_{t},\\quad \\mathrm{with~}\\mathbf{z}_{-1}^{b}\\doteq \\mathbf{0},} \\end{array}",
                                    "image_path": "9a67441fdbb685bdd7040684ecbc5b10a87ae0c7247e2bbe9c13c1a9cd7b8c24.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        104,
                        632,
                        531,
                        699
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                632,
                                531,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\beta >0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " again is a second step- size parameter. In addition to the second set of weights, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{v}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{HTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " also has a second set of eligibility traces, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t^b"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": ". These are conventional accumulating eligibility traces for the behavior policy and become equal to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{z}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " if all the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " are 1, which causes the last term in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " update to be zero and the overall update to reduce to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        632,
                                        531,
                                        699
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        104,
                        700,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                700,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        700,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Emphatic "
                                },
                                {
                                    "bbox": [
                                        104,
                                        700,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "TD(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        700,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is the extension of the one- step Emphatic- TD algorithm (Sections 9.11 and 11.8) to eligibility traces. The resultant algorithm retains strong off- policy convergence guarantees while enabling any degree of bootstrapping, albeit at the cost of"
                                }
                            ]
                        }
                    ],
                    "index": 13
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 28
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        63,
                        140,
                        448,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                140,
                                448,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        140,
                                        448,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "high variance and potentially slow convergence. Emphatic "
                                },
                                {
                                    "bbox": [
                                        63,
                                        140,
                                        448,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        63,
                                        140,
                                        448,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " is defined by"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        168,
                        318,
                        255
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                168,
                                318,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        168,
                                        318,
                                        255
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\mathbf{w}_{t + 1}\\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t}\\mathbf{z}_{t}}\\\\ & {\\quad \\delta_{t}\\doteq R_{t + 1} + \\gamma_{t + 1}\\mathbf{w}_{t}^{\\top}\\mathbf{x}_{t + 1} - \\mathbf{w}_{t}^{\\top}\\mathbf{x}_{t}}\\\\ & {\\quad \\mathbf{z}_{t} = \\rho_{t}\\big(\\gamma_{t}\\lambda_{t}\\mathbf{z}_{t - 1} + M_{t}\\mathbf{x}_{t}\\big),\\quad \\mathrm{with~}\\mathbf{z}_{-1} = \\mathbf{0},}\\\\ & {M_{t}\\doteq \\lambda_{t}I_{t} + (1 - \\lambda_{t})F_{t}}\\\\ & {F_{t}\\doteq \\rho_{t - 1}\\gamma_{t}F_{t - 1} + I_{t},\\quad \\mathrm{with~}F_{0}\\doteq i(S_{0}),} \\end{array}",
                                    "image_path": "c2a5bbbaef078a8ffa50f90ff3c42e1d938fa719388f2e3b8001b5c8dc72a8ba.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        266,
                        489,
                        332
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                266,
                                489,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "M_{t}\\geq 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " is the general form of emphasis, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "F_{t}\\geq 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " is termed the followon trace, and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "I_{t}\\geq 0"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " is the interest, as described in Section 11.8. Note that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "M_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " , like "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " , is not really an additional memory variable. It can be removed from the algorithm by substituting its definition into the eligibility- trace equation. Pseudocode and software for the true online version of Emphatic- "
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        266,
                                        489,
                                        332
                                    ],
                                    "type": "text",
                                    "content": " are available on the web (Sutton, 2015b)."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        334,
                        489,
                        400
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                334,
                                489,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "In the on- policy case ( "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t} = 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " , for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " ), Emphatic- "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " is similar to conventional "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " , but still significantly different. In fact, whereas Emphatic- "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " is guaranteed to converge for all state- dependent "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " functions, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " is not. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " is guaranteed convergent only for all constant "
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        334,
                                        489,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " . See Yu's counterexample (Ghiassian, Rafiee, and Sutton, 2016)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        429,
                        306,
                        447
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                429,
                                306,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        429,
                                        306,
                                        447
                                    ],
                                    "type": "text",
                                    "content": "12.12 Implementation Issues"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        460,
                        490,
                        592
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                460,
                                490,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        460,
                                        490,
                                        592
                                    ],
                                    "type": "text",
                                    "content": "It might at first appear that tabular methods using eligibility traces are much more complex than one- step methods. A naive implementation would require every state (or state- action pair) to update both its value estimate and its eligibility trace on every time step. This would not be a problem for implementations on single- instruction, multiple- data, parallel computers or in plausible artificial neural network (ANN) implementations, but it is a problem for implementations on conventional serial computers. Fortunately, for typical values of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        460,
                                        490,
                                        592
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        460,
                                        490,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        460,
                                        490,
                                        592
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        460,
                                        490,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " the eligibility traces of almost all states are almost always nearly zero; only those states that have recently been visited will have traces significantly greater than zero and only these few states need to be updated to closely approximate these algorithms."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        594,
                        490,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                594,
                                490,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "In practice, then, implementations on conventional computers may keep track of and update only the few traces that are significantly greater than zero. Using this trick, the computational expense of using traces in tabular methods is typically just a few times that of a one- step method. The exact multiple of course depends on "
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and on the expense of the other computations. Note that the tabular case is in some sense the worst case for the computational complexity of eligibility traces. When function approximation is used, the computational advantages of not using traces generally decrease. For example, if ANNs and backpropagation are used, then eligibility traces generally cause only a doubling of the required memory and computation per step. Truncated "
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        594,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- return methods (Section 12.3) can be computationally efficient on conventional computers though they always require some additional memory."
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 29
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        137,
                        263,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                137,
                                263,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        137,
                                        263,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "12.13 Conclusions"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        530,
                        338
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                530,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        338
                                    ],
                                    "type": "text",
                                    "content": "12.13 ConclusionsEligibility traces in conjunction with TD errors provide an efficient, incremental way of shifting and choosing between Monte Carlo and TD methods. The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        338
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        338
                                    ],
                                    "type": "text",
                                    "content": "- step methods of Chapter 7 also enabled this, but eligibility trace methods are more general, often faster to learn, and offer different computational complexity tradeoffs. This chapter has offered an introduction to the elegant, emerging theoretical understanding of eligibility traces for on- and off- policy learning and for variable bootstrapping and discounting. One aspect of this elegant theory is true online methods, which exactly reproduce the behavior of expensive ideal methods while retaining the computational congeniality of conventional TD methods. Another aspect is the possibility of derivations that automatically convert from intuitive forward- view methods to more efficient incremental backward- view algorithms. We illustrated this general idea in a derivation that started with a classical, expensive Monte Carlo algorithm and ended with a cheap incremental non- TD implementation using the same novel eligibility trace used in true online TD methods."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        340,
                        530,
                        431
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                340,
                                530,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        431
                                    ],
                                    "type": "text",
                                    "content": "As we mentioned in Chapter 5, Monte Carlo methods may have advantages in non- Markov tasks because they do not bootstrap. Because eligibility traces make TD methods more like Monte Carlo methods, they also can have advantages in these cases. If one wants to use TD methods because of their other advantages, but the task is at least partially non- Markov, then the use of an eligibility trace method is indicated. Eligibility traces are the first line of defense against both long- delayed rewards and non- Markov tasks."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        433,
                        530,
                        579
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                433,
                                530,
                                579
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        433,
                                        530,
                                        579
                                    ],
                                    "type": "text",
                                    "content": "By adjusting "
                                },
                                {
                                    "bbox": [
                                        104,
                                        433,
                                        530,
                                        579
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        433,
                                        530,
                                        579
                                    ],
                                    "type": "text",
                                    "content": ", we can place eligibility trace methods anywhere along a continuum from Monte Carlo to one- step TD methods. Where shall we place them? We do not yet have a good theoretical answer to this question, but a clear empirical answer appears to be emerging. On tasks with many steps per episode, or many steps within the half- life of discounting, it appears significantly better to use eligibility traces than not to (e.g., see Figure 12.14). On the other hand, if the traces are so long as to produce a pure Monte Carlo method, or nearly so, then performance degrades sharply. An intermediate mixture appears to be the best choice. Eligibility traces should be used to bring us toward Monte Carlo methods, but not all the way there. In the future it may be possible to more finely vary the trade- off between TD and Monte Carlo methods by using variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        433,
                                        530,
                                        579
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        433,
                                        530,
                                        579
                                    ],
                                    "type": "text",
                                    "content": ", but at present it is not clear how this can be done reliably and usefully."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        580,
                        530,
                        700
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                580,
                                530,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        580,
                                        530,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "Methods using eligibility traces require more computation than one- step methods, but in return they offer significantly faster learning, particularly when rewards are delayed by many steps. Thus it often makes sense to use eligibility traces when data are scarce and cannot be repeatedly processed, as is often the case in online applications. On the other hand, in off- line applications in which data can be generated cheaply, perhaps from an inexpensive simulation, then it often does not pay to use eligibility traces. In these cases the objective is not to get more out of a limited amount of data, but simply to process as much data as possible as quickly as possible. In these cases the speedup per datum due to traces is typically not worth their computational cost, and one- step methods are favored."
                                }
                            ]
                        }
                    ],
                    "index": 4
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 30
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        79,
                        139,
                        473,
                        442
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                79,
                                139,
                                473,
                                442
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        79,
                                        139,
                                        473,
                                        442
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                139,
                                                473,
                                                442
                                            ],
                                            "type": "image",
                                            "image_path": "e8a4e77b1a5eaef08e4b8c14060f1df7eb89275e18707c7b0a96ae047927dcfc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                457,
                                490,
                                543
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        457,
                                        490,
                                        543
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "text",
                                            "content": "Figure 12.14: The effect of "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "text",
                                            "content": " on reinforcement learning performance in four different test problems. In all cases, performance is generally best (a lower number in the graph) at an intermediate value of "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "text",
                                            "content": ". The two left panels are applications to simple continuous-state control tasks using the Sarsa("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "text",
                                            "content": ") algorithm and tile coding, with either replacing or accumulating traces (Sutton, 1996). The upper-right panel is for policy evaluation on a random walk task using TD("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\lambda"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                457,
                                                490,
                                                543
                                            ],
                                            "type": "text",
                                            "content": ") (Singh and Sutton, 1996). The lower right panel is unpublished data for the pole-balancing task (Example 3.4) from an earlier study (Sutton, 1984)."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 31
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        415,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                415,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        415,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical Remarks"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        531,
                        272
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                531,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        531,
                                        272
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical RemarksEligibility traces came into reinforcement learning via the fecund ideas of Klopf (1972). Our use of eligibility traces is based on Klopf's work (Sutton, 1978a, 1978b, 1978c; Barto and Sutton, 1981a, 1981b; Sutton and Barto, 1981a; Barto, Sutton, and Anderson, 1983; Sutton, 1984). We may have been the first to use the term \"eligibility trace\" (Sutton and Barto, 1981a). The idea that stimuli produce after effects in the nervous system that are important for learning is very old (see Chapter 14). Some of the earliest uses of eligibility traces were in the actor- critic methods discussed in Chapter 13 (Barto, Sutton, and Anderson, 1983; Sutton, 1984)."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        284,
                        530,
                        311
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                284,
                                530,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        284,
                                        530,
                                        311
                                    ],
                                    "type": "text",
                                    "content": "12.1 Compound updates were called \"complex backups\" in the first edition of this book."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        143,
                        316,
                        530,
                        409
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                316,
                                530,
                                409
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        316,
                                        530,
                                        409
                                    ],
                                    "type": "text",
                                    "content": "12.1 Compound updates were called \"complex backups\" in the first edition of this book.The "
                                },
                                {
                                    "bbox": [
                                        143,
                                        316,
                                        530,
                                        409
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        143,
                                        316,
                                        530,
                                        409
                                    ],
                                    "type": "text",
                                    "content": "- return and its error- reduction properties were introduced by Watkins (1989) and further developed by Jaakkola, Jordan, and Singh (1994). The random walk results in this and subsequent sections are new to this text, as are the terms \"forward view\" and \"backward view.\" The notion of a "
                                },
                                {
                                    "bbox": [
                                        143,
                                        316,
                                        530,
                                        409
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        143,
                                        316,
                                        530,
                                        409
                                    ],
                                    "type": "text",
                                    "content": "- return algorithm was introduced in the first edition of this text. The more refined treatment presented here was developed in conjunction with Harm van Seijen (e.g., van Seijen and Sutton, 2014)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        105,
                        421,
                        530,
                        500
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                421,
                                530,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "12.2 "
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "text",
                                    "content": " with accumulating traces was introduced by Sutton (1988, 1984). Convergence in the mean was proved by Dayan (1992), and with probability 1 by many researchers, including Peng (1993), Dayan and Sejnowski (1994), Tsitsiklis (1994), and Gurvits, Lin, and Hanson (1994). The bound on the error of the asymptotic "
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "- dependent solution of linear "
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        105,
                                        421,
                                        530,
                                        500
                                    ],
                                    "type": "text",
                                    "content": " is due to Tsitsiklis and Van Roy (1997)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        513,
                        530,
                        526
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                513,
                                530,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        513,
                                        530,
                                        526
                                    ],
                                    "type": "text",
                                    "content": "12.3 Truncated TD methods were developed by Cichosz (1995) and van Seijen (2016)."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        105,
                        539,
                        530,
                        579
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                539,
                                530,
                                579
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        539,
                                        530,
                                        579
                                    ],
                                    "type": "text",
                                    "content": "12.4 The idea of redoing updates was extensively developed by van Seijen, originally under the name \"best- match learning\" (van Seijen, 2011; van Seijen, Whiteson, van Hasselt, and Weiring, 2011)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        105,
                        602,
                        530,
                        669
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                602,
                                530,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        602,
                                        530,
                                        669
                                    ],
                                    "type": "text",
                                    "content": "12.5 True online "
                                },
                                {
                                    "bbox": [
                                        105,
                                        602,
                                        530,
                                        669
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        105,
                                        602,
                                        530,
                                        669
                                    ],
                                    "type": "text",
                                    "content": " is primarily due to Harm van Seijen (van Seijen and Sutton, 2014; van Seijen et al., 2016) though some of its key ideas were discovered independently by Hado van Hasselt (personal communication). The name \"dutch traces\" is in recognition of the contributions of both scientists. Replacing traces are due to Singh and Sutton (1996)."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        104,
                        681,
                        470,
                        694
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                681,
                                470,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        681,
                                        470,
                                        694
                                    ],
                                    "type": "text",
                                    "content": "12.6 The material in this section is from van Hasselt and Sutton (2015)."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        707,
                        530,
                        734
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                707,
                                530,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        707,
                                        530,
                                        734
                                    ],
                                    "type": "text",
                                    "content": "12.7 Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        707,
                                        530,
                                        734
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        707,
                                        530,
                                        734
                                    ],
                                    "type": "text",
                                    "content": " with accumulating traces was first explored as a control method by Rummery and Niranjan (1994; Rummery, 1995). True Online Sarsa "
                                },
                                {
                                    "bbox": [
                                        104,
                                        707,
                                        530,
                                        734
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        707,
                                        530,
                                        734
                                    ],
                                    "type": "text",
                                    "content": " was"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 32
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        489,
                        193
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                489,
                                193
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        489,
                                        193
                                    ],
                                    "type": "text",
                                    "content": "introduced by van Seijen and Sutton (2014). The algorithm on page 307 was adapted from van Seijen et al. (2016). The Mountain Car results were made for this text, except for Figure 12.11 which is adapted from van Seijen and Sutton (2014)."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        65,
                        205,
                        489,
                        258
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                205,
                                489,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "12.8 Perhaps the first published discussion of variable "
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "text",
                                    "content": " was by Watkins (1989), who pointed out that the cutting off of the update sequence (Figure 12.12) in his "
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{Q}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "text",
                                    "content": " when a nongreedy action was selected could be implemented by temporarily setting "
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        65,
                                        205,
                                        489,
                                        258
                                    ],
                                    "type": "text",
                                    "content": " to 0."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        263,
                        489,
                        316
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                263,
                                489,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "Variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "text",
                                    "content": " was introduced in the first edition of this text. The roots of variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "text",
                                    "content": " are in the work on options (Sutton, Precup, and Singh, 1999) and its precursors (Sutton, 1995a), becoming explicit in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{GQ}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "text",
                                    "content": " paper (Maei and Sutton, 2010), which also introduced some of these recursive forms for the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        263,
                                        489,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "- returns."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        320,
                        421,
                        334
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                320,
                                421,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        421,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "A different notion of variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        421,
                                        334
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        421,
                                        334
                                    ],
                                    "type": "text",
                                    "content": " has been developed by Yu (2012)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        346,
                        490,
                        426
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                346,
                                490,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        490,
                                        426
                                    ],
                                    "type": "text",
                                    "content": "12.9 Off- policy eligibility traces were introduced by Precup et al. (2000, 2001), then further developed by Bertsekas and Yu (2009), Maei (2011; Maei and Sutton, 2010), Yu (2012), and by Sutton, Mahmood, Precup, and van Hasselt (2014). The last reference in particular gives a powerful forward view for off- policy TD methods with general state- dependent "
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        490,
                                        426
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        490,
                                        426
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        490,
                                        426
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        490,
                                        426
                                    ],
                                    "type": "text",
                                    "content": ". The presentation here seems to be new."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        430,
                        489,
                        469
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                430,
                                489,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        430,
                                        489,
                                        469
                                    ],
                                    "type": "text",
                                    "content": "This section ends with an elegant Expected Sarsa("
                                },
                                {
                                    "bbox": [
                                        104,
                                        430,
                                        489,
                                        469
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        104,
                                        430,
                                        489,
                                        469
                                    ],
                                    "type": "text",
                                    "content": ") algorithm. Although it is a natural algorithm, to our knowledge it has not previously been described or tested in the literature."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        482,
                        489,
                        548
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                482,
                                489,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "text",
                                    "content": "12.10 Watkins's "
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{Q}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "text",
                                    "content": " is due to Watkins (1989). The tabular, episodic, off- line version has been proven convergent by Munos, Stepleton, Harutyunyan, and Bellemare (2016). Alternative "
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{Q}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "text",
                                    "content": " algorithms were proposed by Peng and Williams (1994, 1996) and by Sutton, Mahmood, Precup, and van Hasselt (2014). Tree Backup("
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        482,
                                        489,
                                        548
                                    ],
                                    "type": "text",
                                    "content": ") is due to Precup, Sutton, and Singh (2000)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        560,
                        489,
                        654
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                560,
                                489,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "12.11 GTD("
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "text",
                                    "content": ") is due to Maei (2011). "
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathsf{GQ}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "text",
                                    "content": " is due to Maei and Sutton (2010). "
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{HTD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "text",
                                    "content": " is due to White and White (2016) based on the one- step HTD algorithm introduced by Hackman (2012). The latest developments in the theory of Gradient- TD methods are by Yu (2017). Emphatic "
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathrm{TD}(\\lambda)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        560,
                                        489,
                                        654
                                    ],
                                    "type": "text",
                                    "content": " was introduced by Sutton, Mahmood, and White (2016), who proved its stability. Yu (2015, 2016) proved its convergence, and the algorithm was developed further by Hallak et al. (2015, 2016)."
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 33
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.0.6"
}
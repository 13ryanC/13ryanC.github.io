{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        214,
                        233,
                        239
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                214,
                                233,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        214,
                                        233,
                                        239
                                    ],
                                    "type": "text",
                                    "content": "Chapter 10"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        267,
                        421,
                        330
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                267,
                                421,
                                330
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        267,
                                        421,
                                        330
                                    ],
                                    "type": "text",
                                    "content": "On-policy Control with Approximation"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        372,
                        530,
                        505
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                372,
                                530,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        372,
                                        530,
                                        505
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we return to the control problem, now with parametric approximation of the action- value function "
                                },
                                {
                                    "bbox": [
                                        104,
                                        372,
                                        530,
                                        505
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (s,a,\\mathbf{w})\\approx q_{*}(s,a)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        372,
                                        530,
                                        505
                                    ],
                                    "type": "text",
                                    "content": " , where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        372,
                                        530,
                                        505
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        372,
                                        530,
                                        505
                                    ],
                                    "type": "text",
                                    "content": " is a finite- dimensional weight vector. We continue to restrict attention to the on- policy case, leaving off- policy methods to Chapter 11. The present chapter features the semi- gradient Sarsa algorithm, the natural extension of semi- gradient TD(0) (last chapter) to action values and to on- policy control. In the episodic case, the extension is straightforward, but in the continuing case we have to take a few steps backward and re- examine how we have used discounting to define an optimal policy. Surprisingly, once we have genuine function approximation we have to give up discounting and switch to a new \"average- reward' formulation of the control problem, with new \"differential' value functions."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        506,
                        530,
                        586
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                506,
                                530,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        506,
                                        530,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "Starting first in the episodic case, we extend the function approximation ideas presented in the last chapter from state values to action values. Then we extend them to control following the general pattern of on- policy GPI, using "
                                },
                                {
                                    "bbox": [
                                        104,
                                        506,
                                        530,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        104,
                                        506,
                                        530,
                                        586
                                    ],
                                    "type": "text",
                                    "content": " - greedy for action selection. We show results for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        506,
                                        530,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        506,
                                        530,
                                        586
                                    ],
                                    "type": "text",
                                    "content": " - step linear Sarsa on the Mountain Car problem. Then we turn to the continuing case and repeat the development of these ideas for the average- reward case with differential values."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        105,
                        615,
                        402,
                        634
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                615,
                                402,
                                634
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        615,
                                        402,
                                        634
                                    ],
                                    "type": "text",
                                    "content": "10.1 Episodic Semi-gradient Control"
                                }
                            ]
                        }
                    ],
                    "index": 4,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        647,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                647,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "10.1 Episodic Semi- gradient ControlThe extension of the semi- gradient prediction methods of Chapter 9 to action values is straightforward. In this case it is the approximate action- value function, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} \\approx q_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", that is represented as a parameterized functional form with weight vector "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". Whereas before we considered random training examples of the form "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t} \\mapsto U_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", now we consider examples of the form "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}, A_{t} \\mapsto U_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". The update target "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "U_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " can be any approximation of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}(S_{t}, A_{t})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", including the usual backed- up values such as the full Monte Carlo return "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "(G_{t})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " or any of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        647,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa returns (7.4). The general gradient- descent update for action- value"
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 0
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        63,
                        141,
                        126,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                141,
                                126,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        141,
                                        126,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "prediction is"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        162,
                        489,
                        185
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                162,
                                489,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        162,
                                        489,
                                        185
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_t + \\alpha \\Big[U_t - \\hat{q} (S_t, A_t, \\mathbf{w}_t)\\Big] \\nabla \\hat{q} (S_t, A_t, \\mathbf{w}_t). \\tag{10.1}",
                                    "image_path": "2d934325b8f62a43b22ca0119e69b9a058b17497066a32b054e94bcf3534ac91.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        192,
                        346,
                        206
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                192,
                                346,
                                206
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        192,
                                        346,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "For example, the update for the one- step Sarsa method is"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        214,
                        489,
                        236
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                214,
                                489,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        214,
                                        489,
                                        236
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_t + \\alpha \\Big[R_{t + 1} + \\gamma \\hat{q} (S_{t + 1}, A_{t + 1}, \\mathbf{w}_t) - \\hat{q} (S_t, A_t, \\mathbf{w}_t)\\Big] \\nabla \\hat{q} (S_t, A_t, \\mathbf{w}_t). \\tag{10.2}",
                                    "image_path": "cc0e8bb9b4e84117300c315a71104d7919e767a56313ef4bdaf739c2b82a0216.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        245,
                        489,
                        285
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                245,
                                489,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        245,
                                        489,
                                        285
                                    ],
                                    "type": "text",
                                    "content": "We call this method episodic semi- gradient one- step Sarsa. For a constant policy, this method converges in the same way that TD(0) does, with the same kind of error bound (9.14)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        286,
                        489,
                        419
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                286,
                                489,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": "To form control methods, we need to couple such action- value prediction methods with techniques for policy improvement and action selection. Suitable techniques applicable to continuous actions, or to actions from large discrete sets, are a topic of ongoing research with as yet no clear resolution. On the other hand, if the action set is discrete and not too large, then we can use the techniques already developed in previous chapters. That is, for each possible action "
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": " available in the next state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": ", we can compute "
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S_{t + 1}, a, \\mathbf{w}_t)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": " and then find the greedy action "
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}^{\\prime} = \\operatorname{argmax}_a \\hat{q} (S_{t + 1}, a, \\mathbf{w}_t)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": ". Policy improvement is then done (in the on- policy case treated in this chapter) by changing the estimation policy to a soft approximation of the greedy policy such as the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        286,
                                        489,
                                        419
                                    ],
                                    "type": "text",
                                    "content": "- greedy policy. Actions are selected according to this same policy. Pseudocode for the complete algorithm is given in the box."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        76,
                        432,
                        361,
                        446
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                432,
                                361,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        432,
                                        361,
                                        446
                                    ],
                                    "type": "text",
                                    "content": "Episodic Semi-gradient Sarsa for Estimating "
                                },
                                {
                                    "bbox": [
                                        76,
                                        432,
                                        361,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} \\approx q_*"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        455,
                        476,
                        481
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                455,
                                476,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable action- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}: S \\times \\mathcal{A} \\times \\mathbb{R}^d \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "text",
                                    "content": " Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha > 0"
                                },
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "text",
                                    "content": ", small "
                                },
                                {
                                    "bbox": [
                                        77,
                                        455,
                                        476,
                                        481
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon > 0"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        77,
                        482,
                        393,
                        495
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                482,
                                393,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        482,
                                        393,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        77,
                                        482,
                                        393,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        77,
                                        482,
                                        393,
                                        495
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        77,
                                        482,
                                        393,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        482,
                                        393,
                                        495
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        77,
                        502,
                        188,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                502,
                                188,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        502,
                                        188,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        91,
                        516,
                        368,
                        528
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                516,
                                368,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        516,
                                        368,
                                        528
                                    ],
                                    "type": "inline_equation",
                                    "content": "S, A \\leftarrow"
                                },
                                {
                                    "bbox": [
                                        91,
                                        516,
                                        368,
                                        528
                                    ],
                                    "type": "text",
                                    "content": " initial state and action of episode (e.g., "
                                },
                                {
                                    "bbox": [
                                        91,
                                        516,
                                        368,
                                        528
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        91,
                                        516,
                                        368,
                                        528
                                    ],
                                    "type": "text",
                                    "content": "- greedy)"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        91,
                        530,
                        239,
                        542
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                530,
                                239,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        530,
                                        239,
                                        542
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step of episode:"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        107,
                        543,
                        246,
                        554
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                543,
                                246,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        543,
                                        246,
                                        554
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        107,
                                        543,
                                        246,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        107,
                                        543,
                                        246,
                                        554
                                    ],
                                    "type": "text",
                                    "content": ", observe "
                                },
                                {
                                    "bbox": [
                                        107,
                                        543,
                                        246,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "R, S'"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        107,
                        555,
                        188,
                        567
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                555,
                                188,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        555,
                                        188,
                                        567
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        107,
                                        555,
                                        188,
                                        567
                                    ],
                                    "type": "inline_equation",
                                    "content": "S'"
                                },
                                {
                                    "bbox": [
                                        107,
                                        555,
                                        188,
                                        567
                                    ],
                                    "type": "text",
                                    "content": " is terminal:"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        121,
                        568,
                        316,
                        582
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                568,
                                316,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        568,
                                        316,
                                        582
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha \\big[R - \\hat{q} (S, A, \\mathbf{w}) \\big] \\nabla \\hat{q} (S, A, \\mathbf{w})",
                                    "image_path": "f6766e167e521c9185bbc6d40068b7e47b842c1133ea7902959f78efd40686ce.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        121,
                        583,
                        215,
                        595
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                583,
                                215,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        583,
                                        215,
                                        595
                                    ],
                                    "type": "text",
                                    "content": "Go to next episode"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        107,
                        596,
                        362,
                        608
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                596,
                                362,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "text",
                                    "content": "Choose "
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "inline_equation",
                                    "content": "A'"
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "text",
                                    "content": " as a function of "
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S', \\cdot , \\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "text",
                                    "content": " (e.g., "
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        107,
                                        596,
                                        362,
                                        608
                                    ],
                                    "type": "text",
                                    "content": "- greedy)"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        106,
                        608,
                        376,
                        623
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                608,
                                376,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        608,
                                        376,
                                        623
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha \\big[R + \\gamma \\hat{q} (S', A', \\mathbf{w}) - \\hat{q} (S, A, \\mathbf{w}) \\big] \\nabla \\hat{q} (S, A, \\mathbf{w})",
                                    "image_path": "3226d9e06f213e59f09d6974307aa8435dd5b408995c032142c74b7c0a395411.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        106,
                        623,
                        145,
                        635
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                623,
                                145,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        623,
                                        145,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "S \\leftarrow S'"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        107,
                        636,
                        145,
                        647
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                636,
                                145,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        636,
                                        145,
                                        647
                                    ],
                                    "type": "inline_equation",
                                    "content": "A \\leftarrow A'"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        64,
                        672,
                        490,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                672,
                                490,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        672,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Example 10.1: Mountain Car Task Consider the task of driving an underpowered car up a steep mountain road, as suggested by the diagram in the upper left of Figure 10.1. The difficulty is that gravity is stronger than the car's engine, and even at full throttle the car cannot accelerate up the steep slope. The only solution is to first move away from the goal and up the opposite slope on the left. Then, by applying full throttle the car"
                                }
                            ]
                        }
                    ],
                    "index": 20
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 1
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        107,
                        136,
                        527,
                        402
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                107,
                                136,
                                527,
                                402
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        107,
                                        136,
                                        527,
                                        402
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                107,
                                                136,
                                                527,
                                                402
                                            ],
                                            "type": "image",
                                            "image_path": "b15182cefe72468b6aae1e0e196cc1948b38a9cf0ced6b1e0c5eac5df17fb468.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                103,
                                412,
                                530,
                                437
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        103,
                                        412,
                                        530,
                                        437
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                103,
                                                412,
                                                530,
                                                437
                                            ],
                                            "type": "text",
                                            "content": "Figure 10.1: The Mountain Car task (upper left panel) and the cost-to-go function "
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                412,
                                                530,
                                                437
                                            ],
                                            "type": "inline_equation",
                                            "content": "(- \\max_{a} q(s, a, \\mathbf{w}))"
                                        },
                                        {
                                            "bbox": [
                                                103,
                                                412,
                                                530,
                                                437
                                            ],
                                            "type": "text",
                                            "content": " learned during one run."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        464,
                        530,
                        531
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                464,
                                530,
                                531
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        464,
                                        530,
                                        531
                                    ],
                                    "type": "text",
                                    "content": "can build up enough inertia to carry it up the steep slope even though it is slowing down the whole way. This is a simple example of a continuous control task where things have to get worse in a sense (farther from the goal) before they can get better. Many control methodologies have great difficulties with tasks of this kind unless explicitly aided by a human designer."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        532,
                        530,
                        598
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                532,
                                530,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": "The reward in this problem is "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": " on all time steps until the car moves past its goal position at the top of the mountain, which ends the episode. There are three possible actions: full throttle forward "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "(+1)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ", full throttle reverse "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "(- 1)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ", and zero throttle "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "(0)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ". The car moves according to a simplified physics. Its position, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "x_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ", and velocity, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\dot{x}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ", are updated by"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        132,
                        609,
                        356,
                        655
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                609,
                                356,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        609,
                                        356,
                                        655
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & x_{t + 1}\\doteq bound\\big[x_t + \\dot{x}_{t + 1}\\big]\\\\ & \\dot{x}_{t + 1}\\doteq bound\\big[\\dot{x}_t + 0.001A_t - 0.0025\\cos (3x_t)\\big], \\end{array}",
                                    "image_path": "e0d29640465d3140210bcc1f4216c0cbe54e7b3fa0754aa2618ba28d424b06c6.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        660,
                        531,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                660,
                                531,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "where the bound operation enforces "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 1.2 \\leq x_{t + 1} \\leq 0.5"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 0.07 \\leq \\dot{x}_{t + 1} \\leq 0.07"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". In addition, when "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "x_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " reached the left bound, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\dot{x}_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " was reset to zero. When it reached the right bound, the goal was reached and the episode was terminated. Each episode started from a random position "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "x_{t} \\in [- 0.6, - 0.4)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and zero velocity. To convert the two continuous state variables to binary features, we used grid- tilings as in Figure 9.9. We used 8 tilings, with each tile covering "
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 / 8"
                                },
                                {
                                    "bbox": [
                                        104,
                                        660,
                                        531,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "th of the bounded distance in each dimension,"
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 2
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        490,
                        180
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                490,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        180
                                    ],
                                    "type": "text",
                                    "content": "and asymmetrical offsets as described in Section 9.5.4. <sup>1</sup> The feature vectors "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        180
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{x}(s, a)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        490,
                                        180
                                    ],
                                    "type": "text",
                                    "content": " created by tile coding were then combined linearly with the parameter vector to approximate the action- value function:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        187,
                        489,
                        224
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                187,
                                489,
                                224
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        187,
                                        489,
                                        224
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\hat{\\phi} (s, a, \\mathbf{w}) \\doteq \\mathbf{w}^{\\top} \\mathbf{x}(s, a) = \\sum_{i = 1}^{d} u_{i} \\cdot x_{i}(s, a), \\tag{10.3}",
                                    "image_path": "b9f5ac10f19fe819f74de1bcd6b1a007285284f1826c7ef7c9520240a5a07fee.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        234,
                        251,
                        247
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                234,
                                251,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        251,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "for each pair of state, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        251,
                                        247
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        251,
                                        247
                                    ],
                                    "type": "text",
                                    "content": ", and action, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        251,
                                        247
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        234,
                                        251,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        248,
                        490,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                248,
                                490,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        248,
                                        490,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "Figure 10.1 shows what typically happens while learning to solve this task with this form of function approximation.<sup>2</sup> Shown is the negative of the value function (the cost- to- go function) learned on a single run. The initial action values were all zero, which was optimistic (all true values are negative in this task), causing extensive exploration to occur even though the exploration parameter, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        248,
                                        490,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        248,
                                        490,
                                        394
                                    ],
                                    "type": "text",
                                    "content": ", was 0. This can be seen in the middle- top panel of the figure, labeled \"Step 428\". At this time not even one episode had been completed, but the car has oscillated back and forth in the valley, following circular trajectories in state space. All the states visited frequently are valued worse than unexplored states, because the actual rewards have been worse than what was (unrealistically) expected. This continually drives the agent away from wherever it has been, to explore new states, until a solution is found."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        395,
                        489,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                395,
                                489,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        395,
                                        489,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "Figure 10.2 shows several learning curves for semi- gradient Sarsa on this problem, with various step sizes."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "image",
                    "bbox": [
                        94,
                        434,
                        430,
                        587
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                94,
                                434,
                                430,
                                587
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        434,
                                        430,
                                        587
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                434,
                                                430,
                                                587
                                            ],
                                            "type": "image",
                                            "image_path": "d994df56931931289e7d175fa7e055c7a0589164229b971c49c3bb40c0b54b9f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                599,
                                490,
                                623
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        599,
                                        490,
                                        623
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                599,
                                                490,
                                                623
                                            ],
                                            "type": "text",
                                            "content": "Figure 10.2: Mountain Car learning curves for the semi-gradient Sarsa method with tile-coding function approximation and "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                599,
                                                490,
                                                623
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\epsilon"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                599,
                                                490,
                                                623
                                            ],
                                            "type": "text",
                                            "content": "-greedy action selection."
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "type": "image_caption"
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 3
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        368,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                368,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        368,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "10.2 Semi-gradient "
                                },
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        368,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        368,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        529,
                        206
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                529,
                                206
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "We can obtain an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step version of episodic semi- gradient Sarsa by using an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step return as the update target in the semi- gradient Sarsa update equation (10.1). The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        529,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step return immediately generalizes from its tabular form (7.4) to a function approximation form:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        110,
                        213,
                        528,
                        229
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                110,
                                213,
                                528,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        110,
                                        213,
                                        528,
                                        229
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^n \\hat{q} (S_{t + n}, A_{t + n}, \\mathbf{w}_{t + n - 1}), \\quad t + n < T, \\tag{10.4}",
                                    "image_path": "4f576c7ad98fbc35f7f3e24da34c583a18be97b41d574253d8f14e499586d170.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        238,
                        451,
                        252
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                238,
                                451,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "text",
                                    "content": "with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} \\doteq G_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n \\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "text",
                                    "content": ", as usual. The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        451,
                                        252
                                    ],
                                    "type": "text",
                                    "content": "- step update equation is"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        126,
                        264,
                        528,
                        278
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                126,
                                264,
                                528,
                                278
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        264,
                                        528,
                                        278
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + n} \\doteq \\mathbf{w}_{t + n - 1} + \\alpha \\left[ G_{t:t + n} - \\hat{q} (S_t, A_t, \\mathbf{w}_{t + n - 1}) \\right] \\nabla \\hat{q} (S_t, A_t, \\mathbf{w}_{t + n - 1}), \\qquad 0 \\leq t < T. \\tag{0.5}",
                                    "image_path": "5b24af649cf19465de83bfce05dc43663bc39ebd503196b169e2e632bd7187bb.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        506,
                        282,
                        528,
                        294
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                506,
                                282,
                                528,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        506,
                                        282,
                                        528,
                                        294
                                    ],
                                    "type": "text",
                                    "content": "(10.5)"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        107,
                        303,
                        341,
                        316
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                107,
                                303,
                                341,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        303,
                                        341,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "Complete pseudocode is given in the box below."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        117,
                        324,
                        465,
                        337
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                324,
                                465,
                                337
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "text",
                                    "content": "Episodic semi-gradient "
                                },
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} \\approx q_*"
                                },
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        117,
                                        324,
                                        465,
                                        337
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_\\pi"
                                }
                            ]
                        }
                    ],
                    "index": 7,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        346,
                        516,
                        373
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                346,
                                516,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable action- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}: S \\times \\mathcal{A} \\times \\mathbb{R}^d \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "  Input: a policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "text",
                                    "content": " (if estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        346,
                                        516,
                                        373
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        117,
                        374,
                        468,
                        387
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                374,
                                468,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "text",
                                    "content": ", small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "text",
                                    "content": ", a positive integer "
                                },
                                {
                                    "bbox": [
                                        117,
                                        374,
                                        468,
                                        387
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        117,
                        388,
                        432,
                        399
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                388,
                                432,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        388,
                                        432,
                                        399
                                    ],
                                    "type": "text",
                                    "content": "Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        117,
                                        388,
                                        432,
                                        399
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        117,
                                        388,
                                        432,
                                        399
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        388,
                                        432,
                                        399
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        388,
                                        432,
                                        399
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        117,
                        401,
                        506,
                        414
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                401,
                                506,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations ("
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "text",
                                    "content": ") can take their index mod "
                                },
                                {
                                    "bbox": [
                                        117,
                                        401,
                                        506,
                                        414
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        117,
                        420,
                        228,
                        432
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                420,
                                228,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        420,
                                        228,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        129,
                        433,
                        295,
                        446
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                433,
                                295,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        433,
                                        295,
                                        446
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        129,
                                        433,
                                        295,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_0 \\neq"
                                },
                                {
                                    "bbox": [
                                        129,
                                        433,
                                        295,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        132,
                        447,
                        453,
                        460
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                447,
                                453,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_0 \\sim \\pi (\\cdot | S_0)"
                                },
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "text",
                                    "content": "- greedy wrt "
                                },
                                {
                                    "bbox": [
                                        132,
                                        447,
                                        453,
                                        460
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S_0, \\cdot , \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        132,
                        461,
                        170,
                        471
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                461,
                                170,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        461,
                                        170,
                                        471
                                    ],
                                    "type": "inline_equation",
                                    "content": "T \\leftarrow \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        132,
                        474,
                        248,
                        486
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                474,
                                248,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        474,
                                        248,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        132,
                                        474,
                                        248,
                                        486
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0, 1, 2, \\ldots"
                                },
                                {
                                    "bbox": [
                                        132,
                                        474,
                                        248,
                                        486
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        132,
                        487,
                        217,
                        499
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                487,
                                217,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        487,
                                        217,
                                        499
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        487,
                                        217,
                                        499
                                    ],
                                    "type": "inline_equation",
                                    "content": "t < T"
                                },
                                {
                                    "bbox": [
                                        132,
                                        487,
                                        217,
                                        499
                                    ],
                                    "type": "text",
                                    "content": ", then:"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        161,
                        500,
                        235,
                        512
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                500,
                                235,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        500,
                                        235,
                                        512
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        161,
                                        500,
                                        235,
                                        512
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_t"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        161,
                        514,
                        502,
                        526
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                514,
                                502,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        514,
                                        502,
                                        526
                                    ],
                                    "type": "text",
                                    "content": "Observe and store the next reward as "
                                },
                                {
                                    "bbox": [
                                        161,
                                        514,
                                        502,
                                        526
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        161,
                                        514,
                                        502,
                                        526
                                    ],
                                    "type": "text",
                                    "content": " and the next state as "
                                },
                                {
                                    "bbox": [
                                        161,
                                        514,
                                        502,
                                        526
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        161,
                        527,
                        283,
                        539
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                527,
                                283,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        527,
                                        283,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        161,
                                        527,
                                        283,
                                        539
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        161,
                                        527,
                                        283,
                                        539
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then:"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        175,
                        540,
                        225,
                        552
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                175,
                                540,
                                225,
                                552
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        175,
                                        540,
                                        225,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "T \\leftarrow t + 1"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        161,
                        554,
                        183,
                        564
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                554,
                                183,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        554,
                                        183,
                                        564
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        173,
                        566,
                        480,
                        580
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                173,
                                566,
                                480,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "Select and store "
                                },
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1} \\sim \\pi (\\cdot | S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "- greedy wrt "
                                },
                                {
                                    "bbox": [
                                        173,
                                        566,
                                        480,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S_{t + 1}, \\cdot , \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        143,
                        580,
                        460,
                        592
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                580,
                                460,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        580,
                                        460,
                                        592
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\leftarrow t - n + 1"
                                },
                                {
                                    "bbox": [
                                        143,
                                        580,
                                        460,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " ("
                                },
                                {
                                    "bbox": [
                                        143,
                                        580,
                                        460,
                                        592
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        143,
                                        580,
                                        460,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        143,
                        593,
                        188,
                        604
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                593,
                                188,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        593,
                                        188,
                                        604
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        143,
                                        593,
                                        188,
                                        604
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        143,
                                        593,
                                        188,
                                        604
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        161,
                        605,
                        399,
                        622
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                605,
                                399,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        605,
                                        399,
                                        622
                                    ],
                                    "type": "text",
                                    "content": "\\[ G \\leftarrow \\sum_{i = \\tau + 1}^{\\min (\\tau + n, T)} \\gamma^{i - \\tau - 1} R_i \\]"
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        161,
                        622,
                        398,
                        635
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                622,
                                398,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        622,
                                        398,
                                        635
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        161,
                                        622,
                                        398,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau + n \\leq T"
                                },
                                {
                                    "bbox": [
                                        161,
                                        622,
                                        398,
                                        635
                                    ],
                                    "type": "text",
                                    "content": ", then "
                                },
                                {
                                    "bbox": [
                                        161,
                                        622,
                                        398,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "G \\leftarrow G + \\gamma^n \\hat{q} (S_{\\tau + n}, A_{\\tau + n}, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 27
                },
                {
                    "bbox": [
                        161,
                        635,
                        379,
                        648
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                635,
                                379,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        635,
                                        379,
                                        648
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\leftarrow \\mathbf{w} + \\alpha [ G - \\hat{q} (S_\\tau, A_\\tau, \\mathbf{w})] \\nabla \\hat{q} (S_\\tau, A_\\tau, \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 28
                },
                {
                    "bbox": [
                        132,
                        648,
                        209,
                        660
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                648,
                                209,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        648,
                                        209,
                                        660
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        132,
                                        648,
                                        209,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 29
                },
                {
                    "bbox": [
                        104,
                        673,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                673,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "As we have seen before, performance is best if an intermediate level of bootstrapping is used, corresponding to an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " larger than 1. Figure 10.3 shows how this algorithm tends to learn faster and obtain a better asymptotic performance at "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n = 8"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " than at "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n = 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " on the Mountain Car task. Figure 10.4 shows the results of a more detailed study of the effect of the parameters "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        673,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " on the rate of learning on this task."
                                }
                            ]
                        }
                    ],
                    "index": 30
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 4
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        95,
                        138,
                        429,
                        290
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                95,
                                138,
                                429,
                                290
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        138,
                                        429,
                                        290
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                138,
                                                429,
                                                290
                                            ],
                                            "type": "image",
                                            "image_path": "791baaa3997b6f38aec7c0ad41bfb9b6bd875b7e85382b94e389d50bcc49afa5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                303,
                                491,
                                328
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        491,
                                        328
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "text",
                                            "content": "Figure 10.3: Performance of one-step vs 8-step semi-gradient Sarsa on the Mountain Car task. Good step sizes were used: "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha = 0.5 / 8"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "text",
                                            "content": " for "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "inline_equation",
                                            "content": "n = 1"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "text",
                                            "content": " and "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha = 0.3 / 8"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "text",
                                            "content": " for "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "inline_equation",
                                            "content": "n = 8"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                303,
                                                491,
                                                328
                                            ],
                                            "type": "text",
                                            "content": "."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        83,
                        359,
                        419,
                        517
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                83,
                                359,
                                419,
                                517
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        83,
                                        359,
                                        419,
                                        517
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                83,
                                                359,
                                                419,
                                                517
                                            ],
                                            "type": "image",
                                            "image_path": "c63424a57e5b1dc9bf935de5f3c234cd9ebdbff215854827fa1da91d667c5f4f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                529,
                                491,
                                591
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        529,
                                        491,
                                        591
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": "Figure 10.4: Effect of the "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": " and "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": " on early performance of "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": "-step semi-gradient Sarsa and tile-coding function approximation on the Mountain Car task. As usual, an intermediate level of bootstrapping ("
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "n = 4"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": ") performed best. These results are for selected "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": " values, on a log scale, and then connected by straight lines. The standard errors ranged from 0.5 (less than the line width) for "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "n = 1"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": " to about 4 for "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "inline_equation",
                                            "content": "n = 16"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                529,
                                                491,
                                                591
                                            ],
                                            "type": "text",
                                            "content": ", so the main effects are all statistically significant."
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_caption"
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        634,
                        489,
                        674
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                634,
                                489,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        634,
                                        489,
                                        674
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.1 We have not explicitly considered or given pseudocode for any Monte Carlo methods in this chapter. What would they be like? Why is it reasonable not to give pseudocode for them? How would they perform on the Mountain Car task?"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        687,
                        489,
                        700
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                687,
                                489,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        687,
                                        489,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.2 Give pseudocode for semi- gradient one- step Expected Sarsa for control."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        713,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                713,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.3 Why do the results shown in Figure 10.4 have higher standard errors at large "
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " than at small "
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "?"
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 5
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        529,
                        175
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                529,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        529,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "10.3 Average Reward: A New Problem Setting for Continuing Tasks"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        186,
                        530,
                        319
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                186,
                                530,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        186,
                                        530,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "We now introduce a third classical setting- - - alongside the episodic and discounted settings- - - for formulating the goal in Markov decision problems (MDPs). Like the discounted setting, the average reward setting applies to continuing problems, problems for which the interaction between agent and environment goes on and on forever without termination or start states. Unlike that setting, however, there is no discounting- - - the agent cares just as much about delayed rewards as it does about immediate reward. The average- reward setting is one of the major settings commonly considered in the classical theory of dynamic programming and less- commonly in reinforcement learning. As we discuss in the next section, the discounted setting is problematic with function approximation, and thus the average- reward setting is needed to replace it."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        320,
                        529,
                        346
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                320,
                                529,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        529,
                                        346
                                    ],
                                    "type": "text",
                                    "content": "In the average- reward setting, the quality of a policy "
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        529,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        529,
                                        346
                                    ],
                                    "type": "text",
                                    "content": " is defined as the average rate of reward, or simply average reward, while following that policy, which we denote as "
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        529,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        320,
                                        529,
                                        346
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        130,
                        356,
                        528,
                        447
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                356,
                                528,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        356,
                                        528,
                                        447
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{ r(\\pi)\\doteq\\lim _{h\\to\\infty}\\frac{1}{a}\\sum_{t=1}^{h}\\mathbb{E}[R_{t}\\mid S_{0},A_{0:t-1}\\sim\\pi]}}\\\\ {{\\qquad=\\lim _{t\\to\\infty}\\mathbb{E}[R_{t}\\mid S_{0},A_{0:t-1}\\sim\\pi],}}\\\\ {{\\qquad=\\sum_{s}\\mu_{\\pi}(s)\\sum_{a}\\pi(a|s)\\sum_{s^{\\prime},r}p(s^{\\prime},r|s,a)r,}}\\end{array} \\tag{10.7}",
                                    "image_path": "9395b653c6a4f03c0546938a9baafe2c94e4528b90eec01a80baba2fb515e1c0.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        455,
                        530,
                        561
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                455,
                                530,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": "where the expectations are conditioned on the initial state, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " , and on the subsequent actions, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{0},A_{1},\\ldots ,A_{t - 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " , being taken according to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " . The second and third equations hold if the steady- state distribution, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{\\mu_{\\pi}(s)\\doteq \\lim_{t\\to \\infty}\\operatorname *{Pr}\\{S_{t} = s\\mid A_{0:t - 1}\\sim \\pi \\}} \\end{array}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " , exists and is independent of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        455,
                                        530,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " , in other words, if the MDP is ergodic. In an ergodic MDP, the starting state and any early decision made by the agent can have only a temporary effect; in the long run the expectation of being in a state depends only on the policy and the MDP transition probabilities. Ergodicity is sufficient but not necessary to guarantee the existence of the limit in (10.6)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        563,
                        530,
                        643
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                563,
                                530,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "text",
                                    "content": "There are subtle distinctions that can be drawn between different kinds of optimality in the undiscounted continuing case. Nevertheless, for most practical purposes it may be adequate simply to order policies according to their average reward per time step, in other words, according to their "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "text",
                                    "content": " . This quantity is essentially the average reward under "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "text",
                                    "content": " , as suggested by (10.7), or the reward rate. In particular, we consider all policies that attain the maximal value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        563,
                                        530,
                                        643
                                    ],
                                    "type": "text",
                                    "content": " to be optimal."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        644,
                        529,
                        670
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                644,
                                529,
                                670
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        644,
                                        529,
                                        670
                                    ],
                                    "type": "text",
                                    "content": "Note that the steady state distribution "
                                },
                                {
                                    "bbox": [
                                        104,
                                        644,
                                        529,
                                        670
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        644,
                                        529,
                                        670
                                    ],
                                    "type": "text",
                                    "content": " is the special distribution under which, if you select actions according to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        644,
                                        529,
                                        670
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        644,
                                        529,
                                        670
                                    ],
                                    "type": "text",
                                    "content": " , you remain in the same distribution. That is, for which"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        130,
                        680,
                        528,
                        707
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                680,
                                528,
                                707
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        680,
                                        528,
                                        707
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\sum_{s}\\mu_{\\pi}(s)\\sum_{a}\\pi (a|s)p(s^{\\prime}|s,a) = \\mu_{\\pi}(s^{\\prime}). \\tag{10.8}",
                                    "image_path": "d64d87e155d03f53aba315e5fed6bd1bad062e79b05e54d337b17de04fbd3d77.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 6
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        167
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        167
                                    ],
                                    "type": "text",
                                    "content": "In the average- reward setting, returns are defined in terms of differences between rewards and the average reward:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        91,
                        172,
                        488,
                        186
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                172,
                                488,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        172,
                                        488,
                                        186
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t} \\doteq R_{t + 1} - r(\\pi) + R_{t + 2} - r(\\pi) + R_{t + 3} - r(\\pi) + \\dots . \\tag{10.9}",
                                    "image_path": "390ae8b026315581e88243388cd3a0ae116ac673a556298556ca228d74b8131e.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        191,
                        489,
                        298
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                191,
                                489,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": "This is known as the differential return, and the corresponding value functions are known as differential value functions. Differential value functions are defined in terms of the new return just as conventional value functions were defined in terms of the discounted return; thus we will use the same notation, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}(s) \\doteq \\mathbb{E}_{\\pi}[G_{t}|S_{t} = s]"
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}(s,a) \\doteq \\mathbb{E}_{\\pi}[G_{t}|S_{t} = s,A_{t} = a]"
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": " (similarly for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{*}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{*}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": "), for differential value functions. Differential value functions also have Bellman equations, just slightly different from those we have seen earlier. We simply remove all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        191,
                                        489,
                                        298
                                    ],
                                    "type": "text",
                                    "content": " and replace all rewards by the difference between the reward and the true average reward:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        303,
                        347,
                        332
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                303,
                                347,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        303,
                                        347,
                                        332
                                    ],
                                    "type": "interline_equation",
                                    "content": "v_{\\pi}(s) = \\sum_{a} \\pi (a|s) \\sum_{r,s'} p(s',r|s,a) \\bigl [r - r(\\pi) + v_{\\pi}(s') \\bigr ],",
                                    "image_path": "28d294902ac59d45a42213c7f8b2c2ff2a49f7eb909b3ff9e5a3fbc825ad7d21.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        91,
                        337,
                        376,
                        367
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                337,
                                376,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        337,
                                        376,
                                        367
                                    ],
                                    "type": "interline_equation",
                                    "content": "q_{\\pi}(s,a) = \\sum_{r,s'} p(s',r|s,a) \\bigl [r - r(\\pi) + \\sum_{a'} \\pi (a'|s') q_{\\pi}(s',a') \\bigr ],",
                                    "image_path": "10cc86b1555c756c0e4a1c8e9e2007c26bf632085081131284b46980422791f8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        91,
                        371,
                        367,
                        399
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                371,
                                367,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        371,
                                        367,
                                        399
                                    ],
                                    "type": "interline_equation",
                                    "content": "v_{*}(s) = \\max_{a} \\sum_{r,s'} p(s',r|s,a) \\bigl [r - \\max_{\\pi} r(\\pi) + v_{*}(s') \\bigr ],",
                                    "image_path": "6ac3c423c0bde5bc44534dbbf4976402c277833b91f0bb7f8c46d80563d714ce.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        404,
                        364,
                        433
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                404,
                                364,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        404,
                                        364,
                                        433
                                    ],
                                    "type": "interline_equation",
                                    "content": "q_{*}(s,a) = \\sum_{r,s'} p(s',r|s,a) \\bigl [r - \\max_{\\pi} r(\\pi) + \\max_{a'} q_{*}(s',a') \\bigr ],",
                                    "image_path": "5c3b53baf3cd5176df056bd5d361830840fc84352f25e1233f37f77775db8594.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        63,
                        436,
                        280,
                        449
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                436,
                                280,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        436,
                                        280,
                                        449
                                    ],
                                    "type": "text",
                                    "content": "(cf. (3.14), Exercise 3.17, (3.19), and (3.20))."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        75,
                        450,
                        337,
                        463
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                75,
                                450,
                                337,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        450,
                                        337,
                                        463
                                    ],
                                    "type": "text",
                                    "content": "There is also a differential form of the two TD errors:"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        91,
                        468,
                        488,
                        483
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                468,
                                488,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        468,
                                        488,
                                        483
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t} \\doteq R_{t + 1} - \\bar{R}_{t} + \\hat{v} (S_{t + 1},\\mathbf{w}_{t}) - \\hat{v} (S_{t},\\mathbf{w}_{t}), \\tag{10.10}",
                                    "image_path": "a5f37ef4b71292302dfea027a39e2d6db6a8021f6c9476b25f5a71734d1fc2d0.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        75,
                        487,
                        95,
                        499
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                75,
                                487,
                                95,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        487,
                                        95,
                                        499
                                    ],
                                    "type": "text",
                                    "content": "and"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        91,
                        502,
                        488,
                        516
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                502,
                                488,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        502,
                                        488,
                                        516
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_{t} \\doteq R_{t + 1} - \\bar{R}_{t} + \\hat{q} (S_{t + 1},A_{t + 1},\\mathbf{w}_{t}) - \\hat{q} (S_{t},A_{t},\\mathbf{w}_{t}), \\tag{10.11}",
                                    "image_path": "5b3d8b0cd2f2fa085706fcf53c9061d6187d6c528eea9d3e4ad0b523fa14aec3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        64,
                        522,
                        489,
                        561
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                522,
                                489,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " is an estimate at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": " of the average reward "
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        522,
                                        489,
                                        561
                                    ],
                                    "type": "text",
                                    "content": ". With these alternate definitions, most of our algorithms and many theoretical results carry through to the average- reward setting without change."
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        64,
                        563,
                        489,
                        590
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                563,
                                489,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        563,
                                        489,
                                        590
                                    ],
                                    "type": "text",
                                    "content": "For example, an average reward version of semi- gradient Sarsa could be defined just as in (10.2) except with the differential version of the TD error. That is, by"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        92,
                        594,
                        488,
                        608
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                594,
                                488,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        594,
                                        488,
                                        608
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathbf{w}_{t + 1} \\doteq \\mathbf{w}_{t} + \\alpha \\delta_{t} \\nabla \\hat{q} (S_{t},A_{t},\\mathbf{w}_{t}), \\tag{10.12}",
                                    "image_path": "992846adbf723c0e250b13bf402f371f5be1d5b12e388e54e64e0bacaa157437.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        64,
                        613,
                        489,
                        694
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                613,
                                489,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        613,
                                        489,
                                        694
                                    ],
                                    "type": "text",
                                    "content": "with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        613,
                                        489,
                                        694
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        613,
                                        489,
                                        694
                                    ],
                                    "type": "text",
                                    "content": " given by (10.11). Pseudocode for a complete algorithm is given in the box on the next page. One limitation of this algorithm is that it does not converge to the differential values but to the differential values plus an arbitrary offset. Notice that the Bellman equations and TD errors given above are unaffected if all the values are shifted by the same amount. Thus, the offset may not matter in practice. How this algorithm could be changed to eliminate the offset is an interesting question for future research."
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        64,
                        697,
                        489,
                        710
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                697,
                                489,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        697,
                                        489,
                                        710
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.4 Give pseudocode for a differential version of semi- gradient Q- learning. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        697,
                                        489,
                                        710
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        64,
                        713,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                713,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.5 What equations are needed (beyond 10.10) to specify the differential version of TD(0)? "
                                },
                                {
                                    "bbox": [
                                        64,
                                        713,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 17
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 7
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        117,
                        139,
                        412,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                139,
                                412,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        139,
                                        412,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "Differential semi-gradient Sarsa for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        139,
                                        412,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} \\approx q_{*}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        162,
                        517,
                        216
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                162,
                                517,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable action- value function parameterization "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}: \\mathcal{S} \\times \\mathcal{A} \\times \\mathbb{R}^{d} \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " Algorithm parameters: step sizes "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha , \\beta > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": ", small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^{d}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": ") Initialize average reward estimate "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} \\in \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} = 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        517,
                                        216
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        117,
                        222,
                        271,
                        235
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                222,
                                271,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        222,
                                        271,
                                        235
                                    ],
                                    "type": "text",
                                    "content": "Initialize state "
                                },
                                {
                                    "bbox": [
                                        117,
                                        222,
                                        271,
                                        235
                                    ],
                                    "type": "inline_equation",
                                    "content": "S"
                                },
                                {
                                    "bbox": [
                                        117,
                                        222,
                                        271,
                                        235
                                    ],
                                    "type": "text",
                                    "content": ", and action "
                                },
                                {
                                    "bbox": [
                                        117,
                                        222,
                                        271,
                                        235
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        117,
                        236,
                        214,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                236,
                                214,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        236,
                                        214,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step:"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        129,
                        250,
                        389,
                        341
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                250,
                                389,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "A"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " , observe "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "R,S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " Choose "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "A^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " as a function of "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S^{\\prime},\\cdot ,\\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " (e.g., "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " greedy) "
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta \\leftarrow R - \\bar{R} +\\hat{q} (S^{\\prime},A^{\\prime},\\mathbf{w}) - \\hat{q} (S,A,\\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}\\leftarrow \\bar{R} +\\beta \\delta"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w}\\leftarrow \\mathbf{w} + \\alpha \\delta \\nabla \\hat{q} (S,A,\\mathbf{w})"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "S\\gets S^{\\prime}"
                                },
                                {
                                    "bbox": [
                                        129,
                                        250,
                                        389,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "A\\gets A^{\\prime}"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        359,
                        530,
                        493
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                359,
                                530,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.6 Suppose there is an MDP that under any policy produces the deterministic sequence of rewards "
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "inline_equation",
                                    "content": "+1, 0, +1, 0, +1, 0, \\ldots"
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "text",
                                    "content": " going on forever. Technically, this violates ergodicity; there is no stationary limiting distribution "
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mu_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "text",
                                    "content": " and the limit (10.7) does not exist. Nevertheless, the average reward (10.6) is well defined. What is it? Now consider two states in this MDP. From A, the reward sequence is exactly as described above, starting with a "
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "inline_equation",
                                    "content": "+1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "text",
                                    "content": ", whereas, from B, the reward sequence starts with a 0 and then continues with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "inline_equation",
                                    "content": "+1, 0, +1, 0, \\ldots"
                                },
                                {
                                    "bbox": [
                                        104,
                                        359,
                                        530,
                                        493
                                    ],
                                    "type": "text",
                                    "content": ". We would like to compute the differential values of A and B. Unfortunately, the differential return (10.9) is not well defined when starting from these states as the implicit limit does not exist. To repair this, one could alternatively define the differential value of a state as"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        131,
                        504,
                        528,
                        541
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                504,
                                528,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        504,
                                        528,
                                        541
                                    ],
                                    "type": "interline_equation",
                                    "content": "v_{\\pi}(s) \\doteq \\lim_{\\gamma \\to 1} \\lim_{s \\to \\infty} \\sum_{t = 0}^{h} \\gamma^{t} \\Big([ \\mathbb{E}_{\\pi} [R_{t + 1} | S_{0} = s] - r(\\pi) \\Big). \\tag{10.13}",
                                    "image_path": "d10744afd5011435192b1bb6c5726cb47cd02cb288531226f749b0a833193744.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        554,
                        456,
                        567
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                554,
                                456,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        456,
                                        567
                                    ],
                                    "type": "text",
                                    "content": "Under this definition, what are the differential values of states A and B?"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        104,
                        574,
                        530,
                        628
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                574,
                                530,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        574,
                                        530,
                                        628
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.7 Consider a Markov reward process consisting of a ring of three states A, B, and C, with state transitions going deterministically around the ring. A reward of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        574,
                                        530,
                                        628
                                    ],
                                    "type": "inline_equation",
                                    "content": "+1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        574,
                                        530,
                                        628
                                    ],
                                    "type": "text",
                                    "content": " is received upon arrival in A and otherwise the reward is 0. What are the differential values of the three states, using (10.13)?"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        633,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                633,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.8 The pseudocode in the box on page 251 updates "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " using "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " as an error rather than simply "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1} - \\bar{R}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". Both errors work, but using "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is better. To see why, consider the ring MRP of three states from Exercise 10.7. The estimate of the average reward should tend towards its true value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac{1}{3}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". Suppose it was already there and was held stuck there. What would the sequence of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1} - \\bar{R}_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " errors be? What would the sequence of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        633,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " errors be (using Equation 10.10)? Which error sequence would produce a more stable estimate of the average reward if the estimate were allowed to change in response to the errors? Why?"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 8
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        326
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        326
                                    ],
                                    "type": "text",
                                    "content": "Example 10.2: An Access- Control Queuing Task This is a decision task involving access control to a set of 10 servers. Customers of four different priorities arrive at a single queue. If given access to a server, the customers pay a reward of 1, 2, 4, or 8 to the server, depending on their priority, with higher priority customers paying more. In each time step, the customer at the head of the queue is either accepted (assigned to one of the servers) or rejected (removed from the queue, with a reward of zero). In either case, on the next time step the next customer in the queue is considered. The queue never empties, and the priorities of the customers in the queue are uniformly randomly distributed. Of course a customer cannot be served if there is no free server; the customer is always rejected in this case. Each busy server becomes free with probability "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        326
                                    ],
                                    "type": "inline_equation",
                                    "content": "p = 0.06"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        326
                                    ],
                                    "type": "text",
                                    "content": " on each time step. Although we have just described them for definiteness, let us assume the statistics of arrivals and departures are unknown. The task is to decide on each step whether to accept or reject the next customer, on the basis of his priority and the number of free servers, so as to maximize long- term reward without discounting."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        327,
                        490,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                327,
                                490,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "In this example we consider a tabular solution to this problem. Although there is no generalization between states, we can still consider it in the general function approximation setting as this setting generalizes the tabular setting. Thus we have a differential action- value estimate for each pair of state (number of free servers and priority of the customer at the head of the queue) and action (accept or reject). Figure 10.5 shows the solution found by differential semi- gradient Sarsa with parameters "
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha = 0.01"
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\beta = 0.01"
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon = 0.1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "text",
                                    "content": ". The initial action values and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        327,
                                        490,
                                        421
                                    ],
                                    "type": "text",
                                    "content": " were zero."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "image",
                    "bbox": [
                        117,
                        436,
                        436,
                        675
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                117,
                                436,
                                436,
                                675
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        117,
                                        436,
                                        436,
                                        675
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                117,
                                                436,
                                                436,
                                                675
                                            ],
                                            "type": "image",
                                            "image_path": "d3f7266bb1d2a5c6552d1288faa0035974dbfb3e9305beb6082f0b5e3acf5a2f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                63,
                                687,
                                490,
                                736
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        63,
                                        687,
                                        490,
                                        736
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                63,
                                                687,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "Figure 10.5: The policy and value function found by differential semi-gradient one-step Sarsa on the access-control queuing task after 2 million steps. The drop on the right of the graph is probably due to insufficient data; many of these states were never experienced. The value learned for "
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                687,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\bar{R}"
                                        },
                                        {
                                            "bbox": [
                                                63,
                                                687,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": " was about 2.31. (Note that priority 1 here is the lowest priority.)"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_caption"
                        }
                    ],
                    "index": 2
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 9
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        437,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                437,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        437,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "10.4 Deprecating the Discounted Setting"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        178,
                        530,
                        218
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                178,
                                530,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        178,
                                        530,
                                        218
                                    ],
                                    "type": "text",
                                    "content": "The continuing, discounted problem formulation has been very useful in the tabular case, in which the returns from each state can be separately identified and averaged. But in the approximate case it is questionable whether one should ever use this problem formulation."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        219,
                        530,
                        444
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                219,
                                530,
                                444
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "text",
                                    "content": "To see why, consider an infinite sequence of returns with no beginning or end, and no clearly identified states. The states might be represented only by feature vectors, which may do little to distinguish the states from each other. As a special case, all of the feature vectors may be the same. Thus one really has only the reward sequence (and the actions), and performance has to be assessed purely from these. How could it be done? One way is by averaging the rewards over a long interval- this is the idea of the average- reward setting. How could discounting be used? Well, for each time step we could measure the discounted return. Some returns would be small and some big, so again we would have to average them over a sufficiently large time interval. In the continuing setting there are no starts and ends, and no special time steps, so there is nothing else that could be done. However, if you do this, it turns out that the average of the discounted returns is proportional to the average reward. In fact, for policy "
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "text",
                                    "content": " , the average of the discounted returns is always "
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi) / (1 - \\gamma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "text",
                                    "content": " , that is, it is essentially the average reward, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "text",
                                    "content": " . In particular, the ordering of all policies in the average discounted return setting would be exactly the same as in the average- reward setting. The discount rate "
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        219,
                                        530,
                                        444
                                    ],
                                    "type": "text",
                                    "content": " thus has no effect on the problem formulation. It could in fact be zero and the ranking would be unchanged."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        447,
                        530,
                        552
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                447,
                                530,
                                552
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": "This surprising fact is proven in the box on the next page, but the basic idea can be seen via a symmetry argument. Each time step is exactly the same as every other. With discounting, every reward will appear exactly once in each position in some return. The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " th reward will appear undiscounted in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "t - 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " st return, discounted once in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "t - 2"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " nd return, and discounted 999 times in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "t - 1000"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " th return. The weight on the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " th reward is thus "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 + \\gamma +\\gamma^{2} + \\gamma^{3} + \\dots = 1 / (1 - \\gamma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " . Because all states are the same, they are all weighted by this, and thus the average of the returns will be this times the average reward, or "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi) / (1 - \\gamma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        552
                                    ],
                                    "type": "text",
                                    "content": " ."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        554,
                        530,
                        672
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                554,
                                530,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        530,
                                        672
                                    ],
                                    "type": "text",
                                    "content": "This example and the more general argument in the box show that if we optimized discounted value over the on- policy distribution, then the effect would be identical to optimizing undiscounted average reward; the actual value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        530,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        530,
                                        672
                                    ],
                                    "type": "text",
                                    "content": " would have no effect. This strongly suggests that discounting has no role to play in the definition of the control problem with function approximation. One can nevertheless go ahead and use discounting in solution methods. The discounting parameter "
                                },
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        530,
                                        672
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        104,
                                        554,
                                        530,
                                        672
                                    ],
                                    "type": "text",
                                    "content": " changes from a problem parameter to a solution method parameter! Unfortunately, discounting algorithms with function approximation do not optimize discounted value over the on- policy distribution, and thus are not guaranteed to optimize average reward."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        674,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                674,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        674,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "The root cause of the difficulties with the discounted control setting is that with function approximation we have lost the policy improvement theorem (Section 4.2). It is no longer true that if we change the policy to improve the discounted value of one state then we are guaranteed to have improved the overall policy in any useful sense. That guarantee was key to the theory of our reinforcement learning control methods. With"
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 10
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        77,
                        139,
                        368,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                139,
                                368,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        139,
                                        368,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "The Futility of Discounting in Continuing Problems"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        164,
                        477,
                        191
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                164,
                                477,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        164,
                                        477,
                                        191
                                    ],
                                    "type": "text",
                                    "content": "Perhaps discounting can be saved by choosing an objective that sums discounted values over the distribution with which states occur under the policy:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        92,
                        200,
                        476,
                        433
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                200,
                                476,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        200,
                                        476,
                                        433
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{rl} & J(\\pi) = \\sum_{s}\\mu_{\\pi}(s)v_{\\pi}^{2}(s)\\\\ & \\quad = \\sum_{s}\\mu_{\\pi}(s)\\sum_{a}\\pi (a|s)\\sum_{s^{\\prime}}\\sum_{r}p(s^{\\prime},r|s,a)[r + \\gamma v_{\\pi}^{\\prime}(s^{\\prime})]\\\\ & \\quad = r(\\pi) + \\sum_{s}\\mu_{\\pi}(s)\\sum_{a}\\pi (a|s)\\sum_{s^{\\prime}}\\sum_{r}p(s^{\\prime},r|s,a)\\gamma v_{\\pi}^{\\prime}(s^{\\prime})\\\\ & \\quad = r(\\pi) + \\gamma \\sum_{s^{\\prime}}v_{\\pi}^{\\prime}(s^{\\prime})\\sum_{s}\\mu_{\\pi}(s)\\sum_{a}\\pi (a|s)p(s^{\\prime}|s,a)\\\\ & \\quad = r(\\pi) + \\gamma \\sum_{s^{\\prime}}v_{\\pi}^{\\prime}(s^{\\prime})\\mu_{\\pi}(s^{\\prime})\\\\ & \\quad = r(\\pi) + \\gamma J(\\pi)\\\\ & \\quad = r(\\pi) + \\gamma r(\\pi) + \\gamma^{2}J(\\pi)\\\\ & \\quad = r(\\pi) + \\gamma r(\\pi) + \\gamma^{2}r(\\pi) + \\gamma^{3}r(\\pi) + \\dots \\\\ & \\quad = \\frac{1}{1 - \\gamma} r(\\pi). \\end{array} \\tag{from (10.8)}",
                                    "image_path": "f8b3c11e097d0ff900a199f6bd49520f5f305b5c91218c765590681f251e6543.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        76,
                        440,
                        476,
                        468
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                440,
                                476,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        440,
                                        476,
                                        468
                                    ],
                                    "type": "text",
                                    "content": "The proposed discounted objective orders policies identically to the undiscounted (average reward) objective. The discount rate "
                                },
                                {
                                    "bbox": [
                                        76,
                                        440,
                                        476,
                                        468
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        76,
                                        440,
                                        476,
                                        468
                                    ],
                                    "type": "text",
                                    "content": " does not influence the ordering!"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        503,
                        257,
                        516
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                503,
                                257,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        503,
                                        257,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "function approximation we have lost it!"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        517,
                        490,
                        663
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                517,
                                490,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        517,
                                        490,
                                        663
                                    ],
                                    "type": "text",
                                    "content": "In fact, the lack of a policy improvement theorem is also a theoretical lacuna for the total- episodic and average- reward settings. Once we introduce function approximation we can no longer guarantee improvement for any setting. In Chapter 13 we introduce an alternative class of reinforcement learning algorithms based on parameterized policies, and there we have a theoretical guarantee called the \"policy- gradient theorem\" which plays a similar role as the policy improvement theorem. But for methods that learn action values we seem to be currently without a local improvement guarantee (possibly the approach taken by Perkins and Precup (2003) may provide a part of the answer). We do know that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        517,
                                        490,
                                        663
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        517,
                                        490,
                                        663
                                    ],
                                    "type": "text",
                                    "content": "- greedification may sometimes result in an inferior policy, as policies may chatter among good policies rather than converge (Gordon, 1996a). This is an area with multiple open theoretical questions."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 11
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        462,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                462,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        462,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "10.5 Differential Semi-gradient "
                                },
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        462,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        462,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        530,
                        206
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                530,
                                206
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "In order to generalize to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step bootstrapping, we need an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step version of the TD error. We begin by generalizing the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.4) to its differential form, with function approximation:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        132,
                        214,
                        528,
                        229
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                214,
                                528,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        214,
                                        528,
                                        229
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} - \\bar{R}_{t + n - 1} + \\dots + R_{t + n} - \\bar{R}_{t + n - 1} + \\hat{q} (S_{t + n}, A_{t + n}, \\mathbf{w}_{t + n - 1}), \\tag{10.14}",
                                    "image_path": "b2b4aa458a99e16da1e09180120998c7b05b356174fe3b77d8b42773f5caa8fd.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        238,
                        530,
                        266
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                238,
                                530,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": " is an estimate of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "n \\geq 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n < T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": ". If "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n \\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": ", then we define "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} \\doteq G_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": " as usual. The "
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        238,
                                        530,
                                        266
                                    ],
                                    "type": "text",
                                    "content": "- step TD error is then"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        132,
                        275,
                        528,
                        289
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                275,
                                528,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        275,
                                        528,
                                        289
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\delta_t \\doteq G_{t:t + n} - \\hat{q} (S_t, A_t, \\mathbf{w}), \\tag{10.15}",
                                    "image_path": "b35a96e50cde0d033f4b244a91201e710bc9651a83119ceab97965dc233bf8aa.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        298,
                        530,
                        325
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                298,
                                530,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        298,
                                        530,
                                        325
                                    ],
                                    "type": "text",
                                    "content": "after which we can apply our usual semi- gradient Sarsa update (10.12). Pseudocode for the complete algorithm is given in the box."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        117,
                        338,
                        483,
                        353
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                338,
                                483,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "Differential semi-gradient "
                                },
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} \\approx q_\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        117,
                                        338,
                                        483,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_*"
                                }
                            ]
                        }
                    ],
                    "index": 6,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        361,
                        424,
                        375
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                361,
                                424,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        361,
                                        424,
                                        375
                                    ],
                                    "type": "text",
                                    "content": "Input: a differentiable function "
                                },
                                {
                                    "bbox": [
                                        117,
                                        361,
                                        424,
                                        375
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q}: S \\times \\mathcal{A} \\times \\mathbb{R}^d \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        361,
                                        424,
                                        375
                                    ],
                                    "type": "text",
                                    "content": ", a policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        361,
                                        424,
                                        375
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        117,
                        376,
                        432,
                        388
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                376,
                                432,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        376,
                                        432,
                                        388
                                    ],
                                    "type": "text",
                                    "content": "Initialize value- function weights "
                                },
                                {
                                    "bbox": [
                                        117,
                                        376,
                                        432,
                                        388
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} \\in \\mathbb{R}^d"
                                },
                                {
                                    "bbox": [
                                        117,
                                        376,
                                        432,
                                        388
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        376,
                                        432,
                                        388
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf{w} = \\mathbf{0}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        376,
                                        432,
                                        388
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        117,
                        389,
                        433,
                        401
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                389,
                                433,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        389,
                                        433,
                                        401
                                    ],
                                    "type": "text",
                                    "content": "Initialize average- reward estimate "
                                },
                                {
                                    "bbox": [
                                        117,
                                        389,
                                        433,
                                        401
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} \\in \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        389,
                                        433,
                                        401
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily (e.g., "
                                },
                                {
                                    "bbox": [
                                        117,
                                        389,
                                        433,
                                        401
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R} = 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        389,
                                        433,
                                        401
                                    ],
                                    "type": "text",
                                    "content": ")"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        117,
                        402,
                        506,
                        428
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                402,
                                506,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step sizes "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha , \\beta > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": ", small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": ", a positive integer "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": " All store and access operations ("
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": ", "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": ", and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_t"
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "text",
                                    "content": ") can take their index mod "
                                },
                                {
                                    "bbox": [
                                        117,
                                        402,
                                        506,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        117,
                        434,
                        265,
                        447
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                434,
                                265,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        434,
                                        265,
                                        447
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        117,
                                        434,
                                        265,
                                        447
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        434,
                                        265,
                                        447
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        434,
                                        265,
                                        447
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_0"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        117,
                        448,
                        286,
                        461
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                448,
                                286,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        448,
                                        286,
                                        461
                                    ],
                                    "type": "text",
                                    "content": "Loop for each step, "
                                },
                                {
                                    "bbox": [
                                        117,
                                        448,
                                        286,
                                        461
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0, 1, 2, \\ldots"
                                },
                                {
                                    "bbox": [
                                        117,
                                        448,
                                        286,
                                        461
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        132,
                        463,
                        205,
                        474
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                463,
                                205,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        463,
                                        205,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        463,
                                        205,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_t"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        132,
                        475,
                        486,
                        488
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                475,
                                486,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        475,
                                        486,
                                        488
                                    ],
                                    "type": "text",
                                    "content": "Observe and store the next reward as "
                                },
                                {
                                    "bbox": [
                                        132,
                                        475,
                                        486,
                                        488
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        132,
                                        475,
                                        486,
                                        488
                                    ],
                                    "type": "text",
                                    "content": " and the next state as "
                                },
                                {
                                    "bbox": [
                                        132,
                                        475,
                                        486,
                                        488
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        132,
                        489,
                        487,
                        501
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                489,
                                487,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1} \\sim \\pi (\\cdot | S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "text",
                                    "content": ", or "
                                },
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "text",
                                    "content": "- greedly wrt "
                                },
                                {
                                    "bbox": [
                                        132,
                                        489,
                                        487,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\hat{q} (S_{t + 1}, \\cdot , \\mathbf{w})"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        132,
                        502,
                        446,
                        515
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                502,
                                446,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        502,
                                        446,
                                        515
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\leftarrow t - n + 1"
                                },
                                {
                                    "bbox": [
                                        132,
                                        502,
                                        446,
                                        515
                                    ],
                                    "type": "text",
                                    "content": " ("
                                },
                                {
                                    "bbox": [
                                        132,
                                        502,
                                        446,
                                        515
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        132,
                                        502,
                                        446,
                                        515
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        132,
                        516,
                        174,
                        527
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                516,
                                174,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        516,
                                        174,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        516,
                                        174,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        132,
                                        516,
                                        174,
                                        527
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        145,
                        527,
                        422,
                        571
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                145,
                                527,
                                422,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        145,
                                        527,
                                        422,
                                        571
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {\\delta \\leftarrow \\sum_{i = \\pi +1}^{\\tau +\\delta}(R_{i} - \\bar{R}) + \\hat{q} (S_{\\tau +n},A_{\\tau +n},\\mathbf{w}) - \\hat{q} (S_{\\tau},A_{\\tau},\\mathbf{w})}\\\\ & {\\bar{R}\\leftarrow \\bar{R} +\\beta \\delta}\\\\ & {\\mathbf{w}\\leftarrow \\mathbf{w} + \\alpha \\delta \\nabla \\hat{q} (S_{\\tau},A_{\\tau},\\mathbf{w})} \\end{array}",
                                    "image_path": "285cfd018f7e7cf1386b93e8b5c2a9f7f548b6d4e4491872e91d18aa469ae511.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        104,
                        593,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                593,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Exercise 10.9 In the differential semi- gradient "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa algorithm, the step- size parameter on the average reward, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\beta"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ", needs to be quite small so that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " becomes a good long- term estimate of the average reward. Unfortunately, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " will then be biased by its initial value for many steps, which may make learning inefficient. Alternatively, one could use a sample average of the observed rewards for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": ". That would initially adapt rapidly but in the long run would also adapt slowly. As the policy slowly changed, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " would also change; the potential for such long- term nonstationarity makes sample- average methods ill- suited. In fact, the step- size parameter on the average reward is a perfect place to use the unbiased constant- step- size trick from Exercise 2.7. Describe the specific changes needed to the boxed algorithm for differential semi- gradient "
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        593,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa to use this trick."
                                }
                            ]
                        }
                    ],
                    "index": 19
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 12
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        65,
                        137,
                        190,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                137,
                                190,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        137,
                                        190,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "10.6 Summary"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        165,
                        489,
                        271
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                165,
                                489,
                                271
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        489,
                                        271
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we have extended the ideas of parameterized function approximation and semi- gradient descent, introduced in the previous chapter, to control. The extension is immediate for the episodic case, but for the continuing case we have to introduce a whole new problem formulation based on maximizing the average reward setting per time step. Surprisingly, the discounted formulation cannot be carried over to control in the presence of approximations. In the approximate case most policies cannot be represented by a value function. The arbitrary policies that remain need to be ranked, and the scalar average reward "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        489,
                                        271
                                    ],
                                    "type": "inline_equation",
                                    "content": "r(\\pi)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        489,
                                        271
                                    ],
                                    "type": "text",
                                    "content": " provides an effective way to do this."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        273,
                        489,
                        326
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                273,
                                489,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        273,
                                        489,
                                        326
                                    ],
                                    "type": "text",
                                    "content": "The average reward formulation involves new differential versions of value functions, Bellman equations, and TD errors, but all of these parallel the old ones, and the conceptual changes are small. There is also a new parallel set of differential algorithms for the average- reward case."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        346,
                        374,
                        364
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                346,
                                374,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        346,
                                        374,
                                        364
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical Remarks"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        376,
                        489,
                        482
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                376,
                                489,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        489,
                                        482
                                    ],
                                    "type": "text",
                                    "content": "10.1 Semi- gradient Sarsa with function approximation was first explored by Rummery and Niranjan (1994). Linear semi- gradient Sarsa with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        489,
                                        482
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        376,
                                        489,
                                        482
                                    ],
                                    "type": "text",
                                    "content": "- greedy action selection does not converge in the usual sense, but does enter a bounded region near the best solution (Gordon, 1996a, 2001). Precup and Perkins (2003) showed convergence in a differentiable action selection setting. See also Perkins and Pendrith (2002) and Melo, Meyn, and Ribeiro (2008). The mountain- car example is based on a similar task studied by Moore (1990), but the exact form used here is from Sutton (1996)."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        494,
                        489,
                        533
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                494,
                                489,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        494,
                                        489,
                                        533
                                    ],
                                    "type": "text",
                                    "content": "10.2 Episodic "
                                },
                                {
                                    "bbox": [
                                        64,
                                        494,
                                        489,
                                        533
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        494,
                                        489,
                                        533
                                    ],
                                    "type": "text",
                                    "content": "- step semi- gradient Sarsa is based on the forward Sarsa("
                                },
                                {
                                    "bbox": [
                                        64,
                                        494,
                                        489,
                                        533
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\lambda"
                                },
                                {
                                    "bbox": [
                                        64,
                                        494,
                                        489,
                                        533
                                    ],
                                    "type": "text",
                                    "content": ") algorithm of van Seijen (2016). The empirical results shown here are new to the second edition of this text."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        545,
                        489,
                        665
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                545,
                                489,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        545,
                                        489,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "10.3 The average- reward formulation has been described for dynamic programming (e.g., Puterman, 1994) and from the point of view of reinforcement learning (Mahadevan, 1996; Tadepalli and Ok, 1994; Bertsekas and Tsitsiklis, 1996; Tsitsiklis and Van Roy, 1999). The algorithm described here is the on- policy analog of the \"R- learning\" algorithm introduced by Schwartz (1993). The name R- learning was probably meant to be the alphabetic successor to Q- learning, but we prefer to think of it as a reference to the learning of differential or relative values. The access- control queuing example was suggested by the work of Carlström and Nordström (1997)."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        676,
                        489,
                        729
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                676,
                                489,
                                729
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        676,
                                        489,
                                        729
                                    ],
                                    "type": "text",
                                    "content": "10.4 The recognition of the limitations of discounting as a formulation of the reinforcement learning problem with function approximation became apparent to the authors shortly after the publication of the first edition of this text. Singh, Jaakkola, and Jordan (1994) may have been the first to observe it in print."
                                }
                            ]
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 13
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.0.6"
}
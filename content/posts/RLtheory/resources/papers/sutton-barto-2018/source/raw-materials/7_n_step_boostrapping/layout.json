{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        105,
                        214,
                        220,
                        239
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                214,
                                220,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        214,
                                        220,
                                        239
                                    ],
                                    "type": "text",
                                    "content": "Chapter 7"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        268,
                        395,
                        298
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                268,
                                395,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        268,
                                        395,
                                        298
                                    ],
                                    "type": "text",
                                    "content": "n-step Bootstrapping"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        340,
                        530,
                        433
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                340,
                                530,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        433
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we unify the Monte Carlo (MC) methods and the one- step temporaldifference (TD) methods presented in the previous two chapters. Neither MC methods nor one- step TD methods are always the best. In this chapter we present "
                                },
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        433
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        433
                                    ],
                                    "type": "text",
                                    "content": " - step TD methods that generalize both methods so that one can shift from one to the other smoothly as needed to meet the demands of a particular task. "
                                },
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        433
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        340,
                                        530,
                                        433
                                    ],
                                    "type": "text",
                                    "content": " - step methods span a spectrum with MC methods at one end and one- step TD methods at the other. The best methods are often intermediate between the two extremes."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        435,
                        529,
                        554
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                435,
                                529,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        435,
                                        529,
                                        554
                                    ],
                                    "type": "text",
                                    "content": "Another way of looking at the benefits of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        435,
                                        529,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        435,
                                        529,
                                        554
                                    ],
                                    "type": "text",
                                    "content": " - step methods is that they free you from the tyranny of the time step. With one- step TD methods the same time step determines how often the action can be changed and the time interval over which bootstrapping is done. In many applications one wants to be able to update the action very fast to take into account anything that has changed, but bootstrapping works best if it is over a length of time in which a significant and recognizable state change has occurred. With one- step TD methods, these time intervals are the same, and so a compromise must be made. "
                                },
                                {
                                    "bbox": [
                                        104,
                                        435,
                                        529,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        435,
                                        529,
                                        554
                                    ],
                                    "type": "text",
                                    "content": " - step methods enable bootstrapping to occur over multiple steps, freeing us from the tyranny of the single time step."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        556,
                        529,
                        635
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                556,
                                529,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "text",
                                    "content": "The idea of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "text",
                                    "content": " - step methods is usually used as an introduction to the algorithmic idea of eligibility traces (Chapter 12), which enable bootstrapping over multiple time intervals simultaneously. Here we instead consider the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "text",
                                    "content": " - step bootstrapping idea on its own, postponing the treatment of eligibility- trace mechanisms until later. This allows us to separate the issues better, dealing with as many of them as possible in the simpler "
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        556,
                                        529,
                                        635
                                    ],
                                    "type": "text",
                                    "content": " - step setting."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        637,
                        530,
                        689
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                637,
                                530,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        637,
                                        530,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "As usual, we first consider the prediction problem and then the control problem. That is, we first consider how "
                                },
                                {
                                    "bbox": [
                                        104,
                                        637,
                                        530,
                                        689
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        637,
                                        530,
                                        689
                                    ],
                                    "type": "text",
                                    "content": " - step methods can help in predicting returns as a function of state for a fixed policy (i.e., in estimating "
                                },
                                {
                                    "bbox": [
                                        104,
                                        637,
                                        530,
                                        689
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        637,
                                        530,
                                        689
                                    ],
                                    "type": "text",
                                    "content": " ). Then we extend the ideas to action values and control methods."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 0
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        137,
                        276,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                137,
                                276,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        137,
                                        276,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "7.1 "
                                },
                                {
                                    "bbox": [
                                        64,
                                        137,
                                        276,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pmb{n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        137,
                                        276,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " -step TD Prediction"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        165,
                        490,
                        325
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                165,
                                490,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "text",
                                    "content": "What is the space of methods lying between Monte Carlo and TD methods? Consider estimating "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " from sample episodes generated using "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " . Monte Carlo methods perform an update for each state based on the entire sequence of observed rewards from that state until the end of the episode. The update of one- step TD methods, on the other hand, is based on just the one next reward, bootstrapping from the value of the state one step later as a proxy for the remaining rewards. One kind of intermediate method, then, would perform an update based on an intermediate number of rewards: more than one, but less than all of them until termination. For example, a two- step update would be based on the first two rewards and the estimated value of the state two steps later. Similarly, we could have three- step updates, four- step updates, and so on. Figure 7.1 shows the backup diagrams of the spectrum of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " - step updates for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        325
                                    ],
                                    "type": "text",
                                    "content": " , with the one- step TD update on the left and the up- until- termination Monte Carlo update on the right."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "image",
                    "bbox": [
                        138,
                        340,
                        414,
                        582
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                138,
                                340,
                                414,
                                582
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        138,
                                        340,
                                        414,
                                        582
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                138,
                                                340,
                                                414,
                                                582
                                            ],
                                            "type": "image",
                                            "image_path": "df3491b4b69479c97ed4791c3d568f45ff554cc9a37c88783d0db13614e2eb3a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                591,
                                489,
                                616
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        591,
                                        489,
                                        616
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                591,
                                                489,
                                                616
                                            ],
                                            "type": "text",
                                            "content": "Figure 7.1: The backup diagrams of "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                591,
                                                489,
                                                616
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                591,
                                                489,
                                                616
                                            ],
                                            "type": "text",
                                            "content": "-step methods. These methods form a spectrum ranging from one-step TD methods to Monte Carlo methods."
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_caption"
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        633,
                        489,
                        699
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                633,
                                489,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "text",
                                    "content": "The methods that use "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "text",
                                    "content": "- step updates are still TD methods because they still change an earlier estimate based on how it differs from a later estimate. Now the later estimate is not one step later, but "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " steps later. Methods in which the temporal difference extends over "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "text",
                                    "content": " steps are called "
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        633,
                                        489,
                                        699
                                    ],
                                    "type": "text",
                                    "content": "- step TD methods. The TD methods introduced in the previous chapter all used one- step updates, which is why we called them one- step TD methods."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        700,
                        489,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                700,
                                489,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "More formally, consider the update of the estimated value of state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " as a result of the state- reward sequence, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}, R_{t + 1}, S_{t + 1}, R_{t + 2}, \\ldots , R_{T}, S_{T}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " (omitting the actions). We know that in Monte Carlo updates the estimate of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}(S_{t})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        700,
                                        489,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " is updated in the direction of the"
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 1
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        142,
                        185,
                        154
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                142,
                                185,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        142,
                                        185,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "complete return:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        132,
                        161,
                        368,
                        175
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                161,
                                368,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        161,
                                        368,
                                        175
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\gamma^{2} R_{t + 3} + \\dots + \\gamma^{T - t - 1} R_{T},",
                                    "image_path": "69076a5bd67d6b0bae9527cbcbe63d9d392f83e32daa7364ee35242a1d353c89.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        181,
                        530,
                        235
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                181,
                                530,
                                235
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        235
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        235
                                    ],
                                    "type": "inline_equation",
                                    "content": "T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        181,
                                        530,
                                        235
                                    ],
                                    "type": "text",
                                    "content": " is the last time step of the episode. Let us call this quantity the target of the update. Whereas in Monte Carlo updates the target is the return, in one- step updates the target is the first reward plus the discounted estimated value of the next state, which we call the one- step return:"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        132,
                        244,
                        264,
                        256
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                244,
                                264,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        244,
                                        264,
                                        256
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + 1} \\doteq R_{t + 1} + \\gamma V_{t}(S_{t + 1}),",
                                    "image_path": "ab1847add1559602b0f12aba92e23d82c62d9b63c993a49b1372941be80bca7f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        262,
                        530,
                        342
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                262,
                                530,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t}: \\mathcal{S} \\to \\mathbb{R}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " here is the estimate at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": ". The subscripts on "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " indicate that it is a truncated return for time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " using rewards up until time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": ", with the discounted estimate "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma V_{t}(S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " taking the place of the other terms "
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma R_{t + 2} + \\gamma^{2} R_{t + 3} + \\dots + \\gamma^{T - t - 1} R_{T}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        262,
                                        530,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " of the full return, as discussed in the previous chapter. Our point now is that this idea makes just as much sense after two steps as it does after one. The target for a two- step update is the two- step return:"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        132,
                        351,
                        324,
                        364
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                351,
                                324,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        351,
                                        324,
                                        364
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + 2} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\gamma^{2} V_{t + 1}(S_{t + 2}),",
                                    "image_path": "06d0bebcf6816f7e74ae3cce28c4d0dc6cfaaf7bf17f7b32df974a062d7bc5c8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        370,
                        531,
                        397
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                370,
                                531,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "text",
                                    "content": "where now "
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{2} V_{t + 1}(S_{t + 2})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "text",
                                    "content": " corrects for the absence of the terms "
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{2} R_{t + 3} + \\gamma^{3} R_{t + 4} + \\dots + \\gamma^{T - t - 1} R_{T}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "text",
                                    "content": ". Similarly, the target for an arbitrary "
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "text",
                                    "content": "- step update is the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        370,
                                        531,
                                        397
                                    ],
                                    "type": "text",
                                    "content": "- step return:"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        132,
                        404,
                        528,
                        419
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                404,
                                528,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        404,
                                        528,
                                        419
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^{n} V_{t + n - 1}(S_{t + n}), \\tag{7.1}",
                                    "image_path": "b25ea3f9cf1f6579e0d1ff992760de0ae8236bb5a7e78b50d11b7317d824c17c.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        104,
                        424,
                        530,
                        491
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                424,
                                530,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": "for all "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n,t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n\\geq 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "0\\leq t< T - n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " .All "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " - step returns can be considered approximations to the full return, truncated after "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " steps and then corrected for the remaining missing terms by "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n - 1}(S_{t + n})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " . If "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n\\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " (if the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " - step return extends to or beyond termination), then all the missing terms are taken as zero, and the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " - step return defined to be equal to the ordinary full return ( "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} = G_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n\\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        424,
                                        530,
                                        491
                                    ],
                                    "type": "text",
                                    "content": " -"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        493,
                        530,
                        559
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                493,
                                530,
                                559
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "Note that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- step returns for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "n > 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " involve future rewards and states that are not available at the time of transition from "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": ". No real algorithm can use the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- step return until after it has seen "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + n}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": " and computed "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": ". The first time these are available is "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": ". The natural state- value learning algorithm for using "
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        493,
                                        530,
                                        559
                                    ],
                                    "type": "text",
                                    "content": "- step returns is thus"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        132,
                        564,
                        528,
                        580
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                564,
                                528,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        564,
                                        528,
                                        580
                                    ],
                                    "type": "interline_equation",
                                    "content": "V_{t + n}(S_{t}) \\doteq V_{t + n - 1}(S_{t}) + \\alpha \\big[G_{t:t + n} - V_{t + n - 1}(S_{t})\\big], \\qquad 0 \\leq t < T, \\tag{7.2}",
                                    "image_path": "17fd23c49c5532a69323d9309eae64da7e510a8e9ab5076676a3913a073359f2.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        104,
                        586,
                        530,
                        653
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                586,
                                530,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": "while the values of all other states remain unchanged: "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n}(s) = V_{t + n - 1}(s)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": ", for all "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\neq S_{t}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": ". We call this algorithm "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": "- step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "TD"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": ". Note that no changes at all are made during the first "
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "inline_equation",
                                    "content": "n - 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        586,
                                        530,
                                        653
                                    ],
                                    "type": "text",
                                    "content": " steps of each episode. To make up for that, an equal number of additional updates are made at the end of the episode, after termination and before starting the next episode. Complete pseudocode is given in the box on the next page."
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        104,
                        656,
                        530,
                        710
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                656,
                                530,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        656,
                                        530,
                                        710
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.1 In Chapter 6 we noted that the Monte Carlo error can be written as the sum of TD errors (6.6) if the value estimates don't change from step to step. Show that the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        656,
                                        530,
                                        710
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        656,
                                        530,
                                        710
                                    ],
                                    "type": "text",
                                    "content": "- step error used in (7.2) can also be written as a sum of TD errors (again if the value estimates don't change) generalizing the earlier result. "
                                },
                                {
                                    "bbox": [
                                        104,
                                        656,
                                        530,
                                        710
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        104,
                        713,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                713,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.2 (programming) With an "
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step method, the value estimates do change from step to step, so an algorithm that used the sum of TD errors (see previous exercise) in"
                                }
                            ]
                        }
                    ],
                    "index": 13
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 2
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        76,
                        139,
                        259,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                139,
                                259,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        259,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "n-step TD for estimating "
                                },
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        259,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "V\\approx v_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        78,
                        163,
                        164,
                        175
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                78,
                                163,
                                164,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        163,
                                        164,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "Input: a policy "
                                },
                                {
                                    "bbox": [
                                        78,
                                        163,
                                        164,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        78,
                        176,
                        383,
                        189
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                78,
                                176,
                                383,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        176,
                                        383,
                                        189
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        78,
                                        176,
                                        383,
                                        189
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha \\in (0,1]"
                                },
                                {
                                    "bbox": [
                                        78,
                                        176,
                                        383,
                                        189
                                    ],
                                    "type": "text",
                                    "content": " , a positive integer "
                                },
                                {
                                    "bbox": [
                                        78,
                                        176,
                                        383,
                                        189
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        78,
                        190,
                        264,
                        202
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                78,
                                190,
                                264,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        190,
                                        264,
                                        202
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        78,
                                        190,
                                        264,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(s)"
                                },
                                {
                                    "bbox": [
                                        78,
                                        190,
                                        264,
                                        202
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily, for all "
                                },
                                {
                                    "bbox": [
                                        78,
                                        190,
                                        264,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S}"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        202,
                        461,
                        216
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                202,
                                461,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations (for "
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " ) can take their index mod "
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        461,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        78,
                        223,
                        188,
                        234
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                78,
                                223,
                                188,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        223,
                                        188,
                                        234
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        91,
                        235,
                        255,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                235,
                                255,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        235,
                                        255,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        91,
                                        235,
                                        255,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}\\neq"
                                },
                                {
                                    "bbox": [
                                        91,
                                        235,
                                        255,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        250,
                        129,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                250,
                                129,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        250,
                                        129,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        92,
                        262,
                        208,
                        275
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                262,
                                208,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        262,
                                        208,
                                        275
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        92,
                                        262,
                                        208,
                                        275
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,2,\\ldots"
                                },
                                {
                                    "bbox": [
                                        92,
                                        262,
                                        208,
                                        275
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        92,
                        276,
                        177,
                        287
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                276,
                                177,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        276,
                                        177,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        92,
                                        276,
                                        177,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T"
                                },
                                {
                                    "bbox": [
                                        92,
                                        276,
                                        177,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " , then:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        121,
                        289,
                        292,
                        302
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                289,
                                292,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        289,
                                        292,
                                        302
                                    ],
                                    "type": "text",
                                    "content": "Take an action according to "
                                },
                                {
                                    "bbox": [
                                        121,
                                        289,
                                        292,
                                        302
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |S_{t})"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        121,
                        303,
                        462,
                        315
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                303,
                                462,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        303,
                                        462,
                                        315
                                    ],
                                    "type": "text",
                                    "content": "Observe and store the next reward as "
                                },
                                {
                                    "bbox": [
                                        121,
                                        303,
                                        462,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        121,
                                        303,
                                        462,
                                        315
                                    ],
                                    "type": "text",
                                    "content": " and the next state as "
                                },
                                {
                                    "bbox": [
                                        121,
                                        303,
                                        462,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        117,
                        316,
                        289,
                        328
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                316,
                                289,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        316,
                                        289,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        117,
                                        316,
                                        289,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        316,
                                        289,
                                        328
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then "
                                },
                                {
                                    "bbox": [
                                        117,
                                        316,
                                        289,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets t + 1"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        103,
                        329,
                        455,
                        341
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                329,
                                455,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        329,
                                        455,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\leftarrow t - n + 1"
                                },
                                {
                                    "bbox": [
                                        103,
                                        329,
                                        455,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma"
                                },
                                {
                                    "bbox": [
                                        103,
                                        329,
                                        455,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " is the time whose state's estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        104,
                        342,
                        149,
                        353
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                342,
                                149,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        342,
                                        149,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        104,
                                        342,
                                        149,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        342,
                                        149,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        121,
                        355,
                        257,
                        369
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                355,
                                257,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        355,
                                        257,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow \\sum_{i = \\tau +1}^{\\min (\\tau +n,T)}\\gamma^{i - \\tau - 1}R_{i}} \\end{array}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        117,
                        369,
                        322,
                        383
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                369,
                                322,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        369,
                                        322,
                                        383
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        117,
                                        369,
                                        322,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau +n< T"
                                },
                                {
                                    "bbox": [
                                        117,
                                        369,
                                        322,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " , then: "
                                },
                                {
                                    "bbox": [
                                        117,
                                        369,
                                        322,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "G\\leftarrow G + \\gamma^{n}V(S_{\\tau +n})"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        92,
                        383,
                        280,
                        398
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                383,
                                280,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        383,
                                        280,
                                        398
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(S_{\\tau})\\leftarrow V(S_{\\tau}) + \\alpha [G - V(S_{\\tau})]"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        92,
                        398,
                        170,
                        410
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                398,
                                170,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        398,
                                        170,
                                        410
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        92,
                                        398,
                                        170,
                                        410
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        64,
                        442,
                        489,
                        483
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                442,
                                489,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        442,
                                        489,
                                        483
                                    ],
                                    "type": "text",
                                    "content": "place of the error in (7.2) would actually be a slightly different algorithm. Would it be a better algorithm or a worse one? Devise and program a small experiment to answer this question empirically."
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        64,
                        484,
                        490,
                        551
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                484,
                                490,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": "The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " - step return uses the value function "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " to correct for the missing rewards beyond "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " . An important property of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " - step returns is that their expectation is guaranteed to be a better estimate of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "v_{\\pi}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " than "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " is, in a worst- state sense. That is, the worst error of the expected "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " - step return is guaranteed to be less than or equal to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\gamma^{n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " times the worst error under "
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "inline_equation",
                                    "content": "V_{t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        484,
                                        490,
                                        551
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        91,
                        558,
                        489,
                        582
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                558,
                                489,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        558,
                                        489,
                                        582
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\max_{s}\\bigg|\\mathbb{E}_{\\pi}[G_{t:t + n}|S_{t} = s] - v_{\\pi}(s)\\bigg| \\leq \\gamma^{n}\\max_{s}\\bigg|V_{t + n - 1}(s) - v_{\\pi}(s)\\bigg|, \\tag{7.3}",
                                    "image_path": "d21b412bb5fa24b9c37cc4b785f3c033e01ca05553fc5098b77f9574e00cb03f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        64,
                        590,
                        489,
                        656
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                590,
                                489,
                                656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "text",
                                    "content": "for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "inline_equation",
                                    "content": "n\\geq 1"
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "text",
                                    "content": " . This is called the error reduction property of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "text",
                                    "content": " - step returns. Because of the error reduction property, one can show formally that all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "text",
                                    "content": " - step TD methods converge to the correct predictions under appropriate technical conditions. The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        590,
                                        489,
                                        656
                                    ],
                                    "type": "text",
                                    "content": " - step TD methods thus form a family of sound methods, with one- step TD methods and Monte Carlo methods as extreme members."
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        64,
                        660,
                        490,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                660,
                                490,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "Example 7.1: "
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " - step TD Methods on the Random Walk Consider using "
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " - step TD methods on the 5- state random walk task described in Example 6.2 (page 125). Suppose the first episode progressed directly from the center state, C, to the right, through D and E, and then terminated on the right with a return of 1. Recall that the estimated values of all the states started at an intermediate value, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(s) = 0.5"
                                },
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": " . As a result of this experience, a one- step method would change only the estimate for the last state,"
                                }
                            ]
                        }
                    ],
                    "index": 23
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 3
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        141,
                        531,
                        206
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                141,
                                531,
                                206
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(\\mathsf{E})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "text",
                                    "content": ", which would be incremented toward 1, the observed return. A two- step method, on the other hand, would increment the values of the two states preceding termination: "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(\\mathsf{D})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "V(\\mathsf{E})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "text",
                                    "content": " both would be incremented toward 1. A three- step method, or any "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "text",
                                    "content": "- step method for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "inline_equation",
                                    "content": "n > 2"
                                },
                                {
                                    "bbox": [
                                        104,
                                        141,
                                        531,
                                        206
                                    ],
                                    "type": "text",
                                    "content": ", would increment the values of all three of the visited states toward 1, all by the same amount."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        208,
                        531,
                        353
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                208,
                                531,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "Which value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " is better? Figure 7.2 shows the results of a simple empirical test for a larger random walk process, with 19 states instead of 5 (and with a "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " outcome on the left, all values initialized to 0), which we use as a running example in this chapter. Results are shown for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "- step TD methods with a range of values for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": ". The performance measure for each parameter setting, shown on the vertical axis, is the square- root of the average squared error between the predictions at the end of the episode for the 19 states and their true values, then averaged over the first 10 episodes and 100 repetitions of the whole experiment (the same sets of walks were used for all parameter settings). Note that methods with an intermediate value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": " worked best. This illustrates how the generalization of TD and Monte Carlo methods to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        208,
                                        531,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "- step methods can potentially perform better than either of the two extreme methods."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "image",
                    "bbox": [
                        149,
                        372,
                        437,
                        550
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                149,
                                372,
                                437,
                                550
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        372,
                                        437,
                                        550
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                372,
                                                437,
                                                550
                                            ],
                                            "type": "image",
                                            "image_path": "37bd8f749b624c232816404ebcf91311c107cc96daaba8b9af4eb812df0155e3.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                561,
                                530,
                                587
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        561,
                                        530,
                                        587
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "text",
                                            "content": "Figure 7.2: Performance of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "text",
                                            "content": "-step TD methods as a function of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\alpha"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "text",
                                            "content": ", for various values of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                561,
                                                530,
                                                587
                                            ],
                                            "type": "text",
                                            "content": ", on a 19-state random walk task (Example 7.1)."
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "type": "image_caption"
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        607,
                        530,
                        660
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                607,
                                530,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.3 Why do you think a larger random walk task (19 states instead of 5) was used in the examples of this chapter? Would a smaller walk have shifted the advantage to a different value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "text",
                                    "content": "? How about the change in left- side outcome from 0 to "
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "- 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "text",
                                    "content": " made in the larger walk? Do you think that made any difference in the best value of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "text",
                                    "content": "? "
                                },
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        660
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        105,
                        684,
                        245,
                        702
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                684,
                                245,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        245,
                                        702
                                    ],
                                    "type": "text",
                                    "content": "7.2 "
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        245,
                                        702
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        105,
                                        684,
                                        245,
                                        702
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa"
                                }
                            ]
                        }
                    ],
                    "index": 5,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        713,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                713,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "How can "
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step methods be used not just for prediction, but for control? In this section we show how "
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        713,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "- step methods can be combined with Sarsa in a straightforward way to"
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 4
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        181
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                181
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "produce an on- policy TD control method. The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "- step version of Sarsa we call "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa, and the original version presented in the previous chapter we henceforth call one- step Sarsa, or "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "inline_equation",
                                    "content": "Sarsa(0)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        181
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        181,
                        489,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                181,
                                489,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "The main idea is to simply switch states for actions (state- action pairs) and then use an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "- greedy policy. The backup diagrams for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa (shown in Figure 7.3), like those of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "- step TD (Figure 7.1), are strings of alternating states and actions, except that the Sarsa ones all start and end with an action rather a state. We redefine "
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        181,
                                        489,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "- step returns (update targets) in terms of estimated action values:"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        71,
                        261,
                        489,
                        277
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                71,
                                261,
                                489,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        261,
                                        489,
                                        277
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\gamma R_{t + 2} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^n Q_{t + n - 1} (S_{t + n}, A_{t + n}), \\quad n \\geq 1, 0 \\leq t < T - n,",
                                    "image_path": "08c9fa7a3928b52cfa93dc0e34f788df299b1ade1c35c9e0645ed8e2d07e8ac4.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        303,
                        362,
                        316
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                303,
                                362,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        362,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        362,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} \\doteq G_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        362,
                                        316
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        362,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n \\geq T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        303,
                                        362,
                                        316
                                    ],
                                    "type": "text",
                                    "content": ". The natural algorithm is then"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        89,
                        326,
                        489,
                        341
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                89,
                                326,
                                489,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        326,
                                        489,
                                        341
                                    ],
                                    "type": "interline_equation",
                                    "content": "Q_{t + n}(S_t, A_t) \\doteq Q_{t + n - 1}(S_t, A_t) + \\alpha \\left[ G_{t:t + n} - Q_{t + n - 1}(S_t, A_t) \\right], \\qquad 0 \\leq t < T, \\tag{7.5}",
                                    "image_path": "76e68ef2a7b9106acde95af15fab86d3784d84f2fb85a408f0cb11df8c94a079.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        350,
                        489,
                        405
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                350,
                                489,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "while the values of all other states remain unchanged: "
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q_{t + n}(s, a) = Q_{t + n - 1}(s, a)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": ", for all "
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "s, a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\neq S_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "a \\neq A_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": ". This is the algorithm we call "
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        350,
                                        489,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa. Pseudocode is shown in the box on the next page, and an example of why it can speed up learning compared to one- step methods is given in Figure 7.4."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "image",
                    "bbox": [
                        82,
                        426,
                        474,
                        666
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                82,
                                426,
                                474,
                                666
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        82,
                                        426,
                                        474,
                                        666
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                82,
                                                426,
                                                474,
                                                666
                                            ],
                                            "type": "image",
                                            "image_path": "b7fdc27870bea522449b1b6387840cc112bfde45bf5d6e1daacfc91b2288d04f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                64,
                                674,
                                490,
                                736
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        64,
                                        674,
                                        490,
                                        736
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "Figure 7.3: The backup diagrams for the spectrum of "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step methods for state-action values. They range from the one-step update of Sarsa(0) to the up-until-termination update of the Monte Carlo method. In between are the "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step updates, based on "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": " steps of real rewards and the estimated value of the "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "th next state-action pair, all appropriately discounted. On the far right is the backup diagram for "
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                64,
                                                674,
                                                490,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step Expected Sarsa."
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "type": "image_caption"
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 5
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        117,
                        140,
                        336,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                140,
                                336,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        140,
                                        336,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "n-step Sarsa for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        140,
                                        336,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q\\approx q_{*}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        140,
                                        336,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        117,
                                        140,
                                        336,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        163,
                        348,
                        175
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                163,
                                348,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        163,
                                        348,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        163,
                                        348,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(s,a)"
                                },
                                {
                                    "bbox": [
                                        117,
                                        163,
                                        348,
                                        175
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily, for all "
                                },
                                {
                                    "bbox": [
                                        117,
                                        163,
                                        348,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        163,
                                        348,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "a\\in \\mathcal{A}"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        117,
                        176,
                        462,
                        188
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                176,
                                462,
                                188
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "text",
                                    "content": " to be "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "text",
                                    "content": " - greedy with respect to "
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                },
                                {
                                    "bbox": [
                                        117,
                                        176,
                                        462,
                                        188
                                    ],
                                    "type": "text",
                                    "content": " , or to a fixed given policy"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        117,
                        190,
                        485,
                        202
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                190,
                                485,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha \\in (0,1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "text",
                                    "content": " ,small "
                                },
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon >0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "text",
                                    "content": " , a positive integer "
                                },
                                {
                                    "bbox": [
                                        117,
                                        190,
                                        485,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        117,
                        202,
                        524,
                        216
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                202,
                                524,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations (for "
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " , and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "text",
                                    "content": " ) can take their index mod "
                                },
                                {
                                    "bbox": [
                                        117,
                                        202,
                                        524,
                                        216
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        117,
                        223,
                        228,
                        234
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                223,
                                228,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        223,
                                        228,
                                        234
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        129,
                        236,
                        295,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                236,
                                295,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        236,
                                        295,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        129,
                                        236,
                                        295,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_0\\neq"
                                },
                                {
                                    "bbox": [
                                        129,
                                        236,
                                        295,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        132,
                        250,
                        324,
                        262
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                250,
                                324,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        250,
                                        324,
                                        262
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        250,
                                        324,
                                        262
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_0\\sim \\pi (\\cdot |S_0)"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        264,
                        170,
                        273
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                264,
                                170,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        264,
                                        170,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        132,
                        277,
                        248,
                        288
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                277,
                                248,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        277,
                                        248,
                                        288
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        132,
                                        277,
                                        248,
                                        288
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,2,\\ldots"
                                },
                                {
                                    "bbox": [
                                        132,
                                        277,
                                        248,
                                        288
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        141,
                        290,
                        221,
                        302
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                141,
                                290,
                                221,
                                302
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        141,
                                        290,
                                        221,
                                        302
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        141,
                                        290,
                                        221,
                                        302
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T"
                                },
                                {
                                    "bbox": [
                                        141,
                                        290,
                                        221,
                                        302
                                    ],
                                    "type": "text",
                                    "content": " ,then:"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        162,
                        303,
                        234,
                        314
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                162,
                                303,
                                234,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        162,
                                        303,
                                        234,
                                        314
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        162,
                                        303,
                                        234,
                                        314
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        161,
                        316,
                        503,
                        328
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                316,
                                503,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        316,
                                        503,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "Observe and store the next reward as "
                                },
                                {
                                    "bbox": [
                                        161,
                                        316,
                                        503,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        161,
                                        316,
                                        503,
                                        328
                                    ],
                                    "type": "text",
                                    "content": " and the next state as "
                                },
                                {
                                    "bbox": [
                                        161,
                                        316,
                                        503,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        161,
                        329,
                        283,
                        341
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                329,
                                283,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        329,
                                        283,
                                        341
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        161,
                                        329,
                                        283,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        161,
                                        329,
                                        283,
                                        341
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then:"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        174,
                        342,
                        225,
                        353
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                174,
                                342,
                                225,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        174,
                                        342,
                                        225,
                                        353
                                    ],
                                    "type": "interline_equation",
                                    "content": "T\\gets t + 1",
                                    "image_path": "ac252b97da2cac2a3c39281435f6e008d4a4945d487980de3c6af54dfce1a516.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        161,
                        357,
                        183,
                        367
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                357,
                                183,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        357,
                                        183,
                                        367
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        161,
                        369,
                        388,
                        382
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                369,
                                388,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        369,
                                        388,
                                        382
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        161,
                                        369,
                                        388,
                                        382
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}\\sim \\pi (\\cdot |S_{t + 1})"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        143,
                        382,
                        460,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                382,
                                460,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        382,
                                        460,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\gets t - n + 1"
                                },
                                {
                                    "bbox": [
                                        143,
                                        382,
                                        460,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        143,
                                        382,
                                        460,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        143,
                        395,
                        189,
                        406
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                395,
                                189,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        395,
                                        189,
                                        406
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        143,
                                        395,
                                        189,
                                        406
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        143,
                                        395,
                                        189,
                                        406
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        161,
                        409,
                        294,
                        422
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                409,
                                294,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        409,
                                        294,
                                        422
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow \\sum_{n = \\tau +1}^{\\min (\\tau +n,T)}\\gamma^{i - \\tau -1}R_{t}} \\end{array}",
                                    "image_path": "ab21478e068a0a3362f5b071c18239ae160650650ab5fbeb9a4cb57e4e67e7b8.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        161,
                        424,
                        388,
                        436
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                424,
                                388,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        424,
                                        388,
                                        436
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        161,
                                        424,
                                        388,
                                        436
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau +n< T"
                                },
                                {
                                    "bbox": [
                                        161,
                                        424,
                                        388,
                                        436
                                    ],
                                    "type": "text",
                                    "content": " ,then "
                                },
                                {
                                    "bbox": [
                                        161,
                                        424,
                                        388,
                                        436
                                    ],
                                    "type": "inline_equation",
                                    "content": "G\\gets G + \\gamma^{n}Q(S_{\\tau +n},A_{\\tau +n})"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        161,
                        436,
                        376,
                        450
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                161,
                                436,
                                376,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        161,
                                        436,
                                        376,
                                        450
                                    ],
                                    "type": "interline_equation",
                                    "content": "Q(S_{\\tau},A_{\\tau})\\gets Q(S_{\\tau},A_{\\tau}) + \\alpha [G - Q(S_{\\tau},A_{\\tau})]",
                                    "image_path": "6fbe51ce6bc8d1c7dc5e4be0084e9620f4d1d723ab5c2c42bff0b68b7a2ac088.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        143,
                        451,
                        473,
                        463
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                143,
                                451,
                                473,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "text",
                                    "content": " is being learned, then ensure that "
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |S_{\\tau})"
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "text",
                                    "content": " is "
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "text",
                                    "content": " greedy wrt "
                                },
                                {
                                    "bbox": [
                                        143,
                                        451,
                                        473,
                                        463
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        132,
                        464,
                        209,
                        475
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                464,
                                209,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        464,
                                        209,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        132,
                                        464,
                                        209,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "type": "image",
                    "bbox": [
                        117,
                        511,
                        516,
                        628
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                117,
                                511,
                                516,
                                628
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        117,
                                        511,
                                        516,
                                        628
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                117,
                                                511,
                                                516,
                                                628
                                            ],
                                            "type": "image",
                                            "image_path": "a71abc542318ef2750c3b0a49f6587457d236ef6bcc5797e630ce427103fa541.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 24,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                639,
                                530,
                                736
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        639,
                                        530,
                                        736
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "Figure 7.4: Gridworld example of the speedup of policy learning due to the use of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step methods. The first panel shows the path taken by an agent in a single episode, ending at a location of high reward, marked by the G. In this example the values were all initially 0, and all rewards were zero except for a positive reward at G. The arrows in the other two panels show which action values were strengthened as a result of this path by one-step and "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step Sarsa methods. The one-step method strengthens only the last action of the sequence of actions that led to the high reward, whereas the "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": "-step method strengthens the last "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                639,
                                                530,
                                                736
                                            ],
                                            "type": "text",
                                            "content": " actions of the sequence, so that much more is learned from the one episode."
                                        }
                                    ]
                                }
                            ],
                            "index": 25,
                            "type": "image_caption"
                        }
                    ],
                    "index": 24
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 6
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.4 Prove that the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "- step return of Sarsa (7.4) can be written exactly in terms of a novel TD error, as"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        77,
                        178,
                        489,
                        217
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                178,
                                489,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        178,
                                        489,
                                        217
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} = Q_{t - 1}(S_t, A_t) + \\sum_{k = t}^{\\min (t + n, T) - 1} \\gamma^{k - t} \\left[ R_{k + 1} + \\gamma Q_k(S_{k + 1}, A_{k + 1}) - Q_{k - 1}(S_k, A_k) \\right].",
                                    "image_path": "a45e9020f34950031f73e8ccda900b298dd935e527e7338c0b435b64e3d83317.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        253,
                        489,
                        333
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                253,
                                489,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "What about Expected Sarsa? The backup diagram for the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "- step version of Expected Sarsa is shown on the far right in Figure 7.3. It consists of a linear string of sample actions and states, just as in "
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa, except that its last element is a branch over all action possibilities weighted, as always, by their probability under "
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": ". This algorithm can be described by the same equation as "
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa (above) except with the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        253,
                                        489,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "- step return redefined as"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        341,
                        489,
                        356
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                341,
                                489,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        341,
                                        489,
                                        356
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} \\doteq R_{t + 1} + \\dots + \\gamma^{n - 1} R_{t + n} + \\gamma^n \\bar{V}_{t + n - 1}(S_{t + n}), \\qquad t + n < T, \\tag{7.7}",
                                    "image_path": "c134537e6a1a875fe7ad58515bd47cdd67967c1bac5dcaaf846b21669762f632.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        63,
                        362,
                        490,
                        390
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                63,
                                362,
                                490,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": "(with "
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{t:t + n} \\doteq G_t"
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": " for "
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n \\geq T"
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": ") where "
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{V}_t(s)"
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": " is the expected approximate value of state "
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": ", using the estimated action values at time "
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        63,
                                        362,
                                        490,
                                        390
                                    ],
                                    "type": "text",
                                    "content": ", under the target policy:"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        92,
                        398,
                        489,
                        425
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                398,
                                489,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        398,
                                        489,
                                        425
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\bar{V}_t(s) \\doteq \\sum_{a} \\pi (a|s) Q_t(s, a), \\qquad \\text{for all} s \\in \\mathcal{S}. \\tag{7.8}",
                                    "image_path": "ef96d7f3d7e2019173071f190900fd7f5a02ea55073d341d0db9518bdc8bc014.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        431,
                        489,
                        471
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                431,
                                489,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        471
                                    ],
                                    "type": "text",
                                    "content": "Expected approximate values are used in developing many of the action- value methods in the rest of this book. If "
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        471
                                    ],
                                    "type": "inline_equation",
                                    "content": "s"
                                },
                                {
                                    "bbox": [
                                        64,
                                        431,
                                        489,
                                        471
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then its expected approximate value is defined to be 0."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        491,
                        314,
                        510
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                491,
                                314,
                                510
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        491,
                                        314,
                                        510
                                    ],
                                    "type": "text",
                                    "content": "7.3 "
                                },
                                {
                                    "bbox": [
                                        64,
                                        491,
                                        314,
                                        510
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        491,
                                        314,
                                        510
                                    ],
                                    "type": "text",
                                    "content": "-step Off-policy Learning"
                                }
                            ]
                        }
                    ],
                    "index": 7,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        520,
                        490,
                        641
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                520,
                                490,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": "Recall that off- policy learning is learning the value function for one policy, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": ", while following another policy, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": ". Often, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " is the greedy policy for the current action- value- function estimate, and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " is a more exploratory policy, perhaps "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": "- greedy. In order to use the data from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " we must take into account the difference between the two policies, using their relative probability of taking the actions that were taken (see Section 5.5). In "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": "- step methods, returns are constructed over "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " steps, so we are interested in the relative probability of just those "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " actions. For example, to make a simple off- policy version of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": "- step TD, the update for time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": " (actually made at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": ") can simply be weighted by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t:t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        520,
                                        490,
                                        641
                                    ],
                                    "type": "text",
                                    "content": ":"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        91,
                        648,
                        489,
                        662
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                648,
                                489,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        648,
                                        489,
                                        662
                                    ],
                                    "type": "interline_equation",
                                    "content": "V_{t + n}(S_t) \\doteq V_{t + n - 1}(S_t) + \\alpha \\rho_{t:t + n - 1} \\left[ G_{t:t + n} - V_{t + n - 1}(S_t) \\right], \\qquad 0 \\leq t < T, \\tag{7.9}",
                                    "image_path": "cf2959560d585d3c143cb223e1df49a23cacfc184660062a23ae59195b81632d.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        64,
                        670,
                        489,
                        698
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                670,
                                489,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t:t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": ", called the importance sampling ratio, is the relative probability under the two policies of taking the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": " actions from "
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": " to "
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        670,
                                        489,
                                        698
                                    ],
                                    "type": "text",
                                    "content": " (cf. Eq. 5.3):"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        91,
                        704,
                        489,
                        743
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                704,
                                489,
                                743
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        704,
                                        489,
                                        743
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\rho_{t:h} \\doteq \\prod_{k = t}^{\\min (h, T - 1)} \\frac{\\pi(A_k|S_k)}{b(A_k|S_k)}. \\tag{7.10}",
                                    "image_path": "e414f282e2bed9515c3852a3f24b285cb1e5714c20dcdf3144f175dda8c935ea.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 11
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 7
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        287
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "For example, if any one of the actions would never be taken by "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " (i.e., "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (A_{k}|S_{k}) = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": ") then the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "- step return should be given zero weight and be totally ignored. On the other hand, if by chance an action is taken that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " would take with much greater probability than "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " does, then this will increase the weight that would otherwise be given to the return. This makes sense because that action is characteristic of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " (and therefore we want to learn about it) but is selected only rarely by "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": " and thus rarely appears in the data. To make up for this we have to over- weight it when it does occur. Note that if the two policies are actually the same (the on- policy case) then the importance sampling ratio is always 1. Thus our new update (7.9) generalizes and can completely replace our earlier "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "- step TD update. Similarly, our previous "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa update can be completely replaced by a simple off- policy form:"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        132,
                        294,
                        528,
                        309
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                294,
                                528,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        294,
                                        528,
                                        309
                                    ],
                                    "type": "interline_equation",
                                    "content": "Q_{t + n}(S_t,A_t)\\doteq Q_{t + n - 1}(S_t,A_t) + \\alpha \\rho_{t + 1:t + n}\\left[G_{t:t + n} - Q_{t + n - 1}(S_t,A_t)\\right], \\tag{7.11}",
                                    "image_path": "08e8d076bacbcebc1b5a69a2fbd5fa18a7190145a99ab41359e0bd5862d5bae5.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        316,
                        530,
                        383
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                316,
                                530,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        316,
                                        530,
                                        383
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        316,
                                        530,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "0\\leq t< T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        316,
                                        530,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " . Note that the importance sampling ratio here starts and ends one step later than for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        316,
                                        530,
                                        383
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        316,
                                        530,
                                        383
                                    ],
                                    "type": "text",
                                    "content": " step TD (7.9). This is because here we are updating a state- action pair. We do not have to care how likely we were to select the action; now that we have selected it we want to learn fully from what happens, with importance sampling only for subsequent actions. Pseudocode for the full algorithm is shown in the box below."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        117,
                        392,
                        376,
                        405
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                392,
                                376,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "Off-policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "-step Sarsa for estimating "
                                },
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q\\approx q_{*}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        117,
                                        392,
                                        376,
                                        405
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 3,
                    "level": 1
                },
                {
                    "bbox": [
                        117,
                        413,
                        468,
                        425
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                413,
                                468,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "text",
                                    "content": "Input: an arbitrary behavior policy "
                                },
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "inline_equation",
                                    "content": "b(a|s) > 0"
                                },
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "text",
                                    "content": " , for all "
                                },
                                {
                                    "bbox": [
                                        117,
                                        413,
                                        468,
                                        425
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathbb{S},a\\in \\mathcal{A}"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        117,
                        426,
                        330,
                        437
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                426,
                                330,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        426,
                                        330,
                                        437
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        426,
                                        330,
                                        437
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(s,a)"
                                },
                                {
                                    "bbox": [
                                        117,
                                        426,
                                        330,
                                        437
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily, for all "
                                },
                                {
                                    "bbox": [
                                        117,
                                        426,
                                        330,
                                        437
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathbb{S},a\\in \\mathcal{A}"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        117,
                        439,
                        427,
                        449
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                439,
                                427,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        439,
                                        427,
                                        449
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        117,
                                        439,
                                        427,
                                        449
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        117,
                                        439,
                                        427,
                                        449
                                    ],
                                    "type": "text",
                                    "content": " to be greedy with respect to "
                                },
                                {
                                    "bbox": [
                                        117,
                                        439,
                                        427,
                                        449
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                },
                                {
                                    "bbox": [
                                        117,
                                        439,
                                        427,
                                        449
                                    ],
                                    "type": "text",
                                    "content": " , or as a fixed given policy"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        117,
                        451,
                        401,
                        462
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                451,
                                401,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        451,
                                        401,
                                        462
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        117,
                                        451,
                                        401,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha \\in (0,1]"
                                },
                                {
                                    "bbox": [
                                        117,
                                        451,
                                        401,
                                        462
                                    ],
                                    "type": "text",
                                    "content": " , a positive integer "
                                },
                                {
                                    "bbox": [
                                        117,
                                        451,
                                        401,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        117,
                        463,
                        493,
                        475
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                463,
                                493,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations (for "
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " , and "
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "text",
                                    "content": " ) can take their index mod "
                                },
                                {
                                    "bbox": [
                                        117,
                                        463,
                                        493,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        117,
                        482,
                        220,
                        493
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                482,
                                220,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        482,
                                        220,
                                        493
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        129,
                        494,
                        282,
                        505
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                129,
                                494,
                                282,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        129,
                                        494,
                                        282,
                                        505
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        129,
                                        494,
                                        282,
                                        505
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_0\\neq"
                                },
                                {
                                    "bbox": [
                                        129,
                                        494,
                                        282,
                                        505
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        132,
                        506,
                        306,
                        517
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                506,
                                306,
                                517
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        506,
                                        306,
                                        517
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        132,
                                        506,
                                        306,
                                        517
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_0\\sim b(\\cdot |S_0)"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        132,
                        519,
                        164,
                        529
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                519,
                                164,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        519,
                                        164,
                                        529
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        132,
                        531,
                        238,
                        542
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                531,
                                238,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        531,
                                        238,
                                        542
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        132,
                                        531,
                                        238,
                                        542
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,2,\\ldots"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        132,
                        543,
                        213,
                        554
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                543,
                                213,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        543,
                                        213,
                                        554
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        543,
                                        213,
                                        554
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T"
                                },
                                {
                                    "bbox": [
                                        132,
                                        543,
                                        213,
                                        554
                                    ],
                                    "type": "text",
                                    "content": " , then:"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        164,
                        554,
                        226,
                        565
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                554,
                                226,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        554,
                                        226,
                                        565
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        164,
                                        554,
                                        226,
                                        565
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        164,
                        567,
                        474,
                        578
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                567,
                                474,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        567,
                                        474,
                                        578
                                    ],
                                    "type": "text",
                                    "content": "Observe and store the next reward as "
                                },
                                {
                                    "bbox": [
                                        164,
                                        567,
                                        474,
                                        578
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        164,
                                        567,
                                        474,
                                        578
                                    ],
                                    "type": "text",
                                    "content": " and the next state as "
                                },
                                {
                                    "bbox": [
                                        164,
                                        567,
                                        474,
                                        578
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        132,
                        579,
                        270,
                        590
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                579,
                                270,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        579,
                                        270,
                                        590
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        579,
                                        270,
                                        590
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        132,
                                        579,
                                        270,
                                        590
                                    ],
                                    "type": "text",
                                    "content": " is terminal, then:"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        164,
                        591,
                        217,
                        602
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                591,
                                217,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        591,
                                        217,
                                        602
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets t + 1"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        132,
                        603,
                        178,
                        613
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                603,
                                178,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        603,
                                        178,
                                        613
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        164,
                        615,
                        366,
                        627
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                615,
                                366,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        615,
                                        366,
                                        627
                                    ],
                                    "type": "text",
                                    "content": "Select and store an action "
                                },
                                {
                                    "bbox": [
                                        164,
                                        615,
                                        366,
                                        627
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}\\sim b(\\cdot |S_{t + 1})"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        132,
                        628,
                        435,
                        639
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                628,
                                435,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        628,
                                        435,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\gets t - n + 1"
                                },
                                {
                                    "bbox": [
                                        132,
                                        628,
                                        435,
                                        639
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        132,
                                        628,
                                        435,
                                        639
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        132,
                        639,
                        184,
                        650
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                639,
                                184,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        639,
                                        184,
                                        650
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        639,
                                        184,
                                        650
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        132,
                                        639,
                                        184,
                                        650
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        164,
                        651,
                        511,
                        666
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                651,
                                511,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        651,
                                        511,
                                        666
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{\\rho \\leftarrow \\prod_{i = \\tau +1}^{\\tau \\mathrm{in}(\\tau +n,T - 1)}\\frac{\\pi(A_{i}|S_{i})}{b(A_{i}|S_{i})}} \\end{array}"
                                },
                                {
                                    "bbox": [
                                        164,
                                        651,
                                        511,
                                        666
                                    ],
                                    "type": "inline_equation",
                                    "content": "(\\rho_{\\tau +1:\\tau +n})"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        164,
                        666,
                        283,
                        678
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                666,
                                283,
                                678
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        666,
                                        283,
                                        678
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow \\sum_{i = \\tau +1}^{\\mathrm{in}(\\tau +n,T)}\\gamma^{i - \\tau - 1}R_{i}} \\end{array}"
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        164,
                        679,
                        503,
                        692
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                679,
                                503,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        679,
                                        503,
                                        692
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        164,
                                        679,
                                        503,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau +n< T"
                                },
                                {
                                    "bbox": [
                                        164,
                                        679,
                                        503,
                                        692
                                    ],
                                    "type": "text",
                                    "content": " , then: "
                                },
                                {
                                    "bbox": [
                                        164,
                                        679,
                                        503,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "G\\gets G + \\gamma^n Q(S_{\\tau +n},A_{\\tau +n})"
                                },
                                {
                                    "bbox": [
                                        164,
                                        679,
                                        503,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "(G_{\\tau :\\tau +n})"
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        164,
                        692,
                        366,
                        704
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                164,
                                692,
                                366,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        164,
                                        692,
                                        366,
                                        704
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(S_{\\tau},A_{\\tau})\\gets Q(S_{\\tau},A_{\\tau}) + \\alpha \\rho [G - Q(S_{\\tau},A_{\\tau})]"
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        132,
                        705,
                        437,
                        716
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                705,
                                437,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "text",
                                    "content": " is being learned, then ensure that "
                                },
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |S_{\\tau})"
                                },
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "text",
                                    "content": " is greedy wrt "
                                },
                                {
                                    "bbox": [
                                        132,
                                        705,
                                        437,
                                        716
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                }
                            ]
                        }
                    ],
                    "index": 27
                },
                {
                    "bbox": [
                        132,
                        717,
                        202,
                        728
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                717,
                                202,
                                728
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        717,
                                        202,
                                        728
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        132,
                                        717,
                                        202,
                                        728
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 28
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 8
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        220
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "The off- policy version of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step Expected Sarsa would use the same update as above for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa except that the importance sampling ratio would have one less factor in it. That is, the above equation would use "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t + 1:t + n - 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": " instead of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t + 1:t + n}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": ", and of course it would use the Expected Sarsa version of the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.7). This is because in Expected Sarsa all possible actions are taken into account in the last state; the one actually taken has no effect and does not have to be corrected for."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        65,
                        234,
                        461,
                        252
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                65,
                                234,
                                461,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        65,
                                        234,
                                        461,
                                        252
                                    ],
                                    "type": "text",
                                    "content": "7.4 *Per-decision Methods with Control Variates"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        262,
                        489,
                        342
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                262,
                                489,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "The multi- step off- policy methods presented in the previous section are simple and conceptually clear, but are probably not the most efficient. A more sophisticated approach would use per- decision importance sampling ideas such as were introduced in Section 5.9. To understand this approach, first note that the ordinary "
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.1), like all returns, can be written recursively. For the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "text",
                                    "content": " steps ending at horizon "
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "text",
                                    "content": ", the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        262,
                                        489,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "- step return can be written"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        91,
                        354,
                        489,
                        367
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                354,
                                489,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        354,
                                        489,
                                        367
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:h} = R_{t + 1} + \\gamma G_{t + 1:h},\\qquad t< h< T, \\tag{7.12}",
                                    "image_path": "942d3b663f369f435721b8a6b8fe05fadbb58cc081b14cdec54930fc93966a3f.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        377,
                        489,
                        513
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                377,
                                489,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{h:h}\\doteq V_{h - 1}(S_{h})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " . (Recall that this return is used at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " , previously denoted "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " ) Now consider the effect of following a behavior policy "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " that is not the same as the target policy "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " . All of the resulting experience, including the first reward "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " and the next state "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " , must be weighted by the importance sampling ratio for time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array}{r}{\\rho_{t} = \\frac{\\pi(A_{t}|S_{t})}{b(A_{t}|S_{t})}} \\end{array}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " . One might be tempted to simply weight the righthand side of the above equation, but one can do better. Suppose the action at time "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " would never be selected by "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " , so that "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " is zero. Then a simple weighting would result in the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " - step return being zero, which could result in high variance when it was used as a target. Instead, in this more sophisticated approach, one uses an alternate, off- policy definition of the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " - step return ending at horizon "
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        64,
                                        377,
                                        489,
                                        513
                                    ],
                                    "type": "text",
                                    "content": " , as"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        91,
                        523,
                        489,
                        538
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                523,
                                489,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        523,
                                        489,
                                        538
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:h}\\doteq \\rho_{t}(R_{t + 1} + \\gamma G_{t + 1:h}) + (1 - \\rho_{t})V_{h - 1}(S_{t}),\\qquad t< h< T, \\tag{7.13}",
                                    "image_path": "51d4acfd83bea72d0fae04eb9bbbdc9653dcab53e531800685a017a2ad5ca24b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        548,
                        489,
                        682
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                548,
                                489,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "text",
                                    "content": "where again "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{h:h}\\doteq V_{h - 1}(S_{h})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "text",
                                    "content": " . In this approach, if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "text",
                                    "content": " is zero, then instead of the target being zero and causing the estimate to shrink, the target is the same as the estimate and causes no change. The importance sampling ratio being zero means we should ignore the sample, so leaving the estimate unchanged seems appropriate. The second, additional term in (7.13) is called a control variate (for obscure reasons). Notice that the control variate does not change the expected update; the importance sampling ratio has expected value one (Section 5.9) and is uncorrelated with the estimate, so the expected value of the control variate is zero. Also note that the off- policy definition (7.13) is a strict generalization of the earlier on- policy definition of the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "text",
                                    "content": " - step return (7.1), as the two are identical in the on- policy case, in which "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        489,
                                        682
                                    ],
                                    "type": "text",
                                    "content": " is always 1."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        64,
                        682,
                        489,
                        722
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                682,
                                489,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        682,
                                        489,
                                        722
                                    ],
                                    "type": "text",
                                    "content": "For a conventional "
                                },
                                {
                                    "bbox": [
                                        64,
                                        682,
                                        489,
                                        722
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        682,
                                        489,
                                        722
                                    ],
                                    "type": "text",
                                    "content": "- step method, the learning rule to use in conjunction with (7.13) is the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        682,
                                        489,
                                        722
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        682,
                                        489,
                                        722
                                    ],
                                    "type": "text",
                                    "content": "- step TD update (7.2), which has no explicit importance sampling ratios other than those embedded in the return."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        64,
                        726,
                        489,
                        753
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                726,
                                489,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        726,
                                        489,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.5 Write the pseudocode for the off- policy state- value prediction algorithm described above. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        726,
                                        489,
                                        753
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\square"
                                }
                            ]
                        }
                    ],
                    "index": 8
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 9
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        219
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": "For action values, the off- policy definition of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        219
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": "- step return is a little different because the first action does not play a role in the importance sampling. That first action is the one being learned; it does not matter if it was unlikely or even impossible under the target policy—it has been taken and now full unit weight must be given to the reward and state that follows it. Importance sampling will apply only to the actions that follow it."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        221,
                        530,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                221,
                                530,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "First note that for action values the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "- step on- policy return ending at horizon "
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "h"
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": ", expectation form (7.7), can be written recursively just as in (7.12), except that for action values the recursion ends with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{h:h} \\doteq \\bar{V}_{h - 1}(S_{h})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        221,
                                        530,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " as in (7.8). An off- policy form with control variates is"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        130,
                        282,
                        528,
                        342
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                130,
                                282,
                                528,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        130,
                                        282,
                                        528,
                                        342
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {G_{t:h}\\doteq R_{t + 1} + \\gamma \\Big(\\rho_{t + 1}G_{t + 1:h} + \\bar{V}_{h - 1}(S_{t + 1}) - \\rho_{t + 1}Q_{h - 1}(S_{t + 1},A_{t + 1})\\Big),}\\\\ & {\\qquad = R_{t + 1} + \\gamma \\rho_{t + 1}\\Big(G_{t + 1:h} - Q_{h - 1}(S_{t + 1},A_{t + 1})\\Big) + \\gamma \\bar{V}_{h - 1}(S_{t + 1}),t< h\\leq T.} \\end{array} \\tag{7.14}",
                                    "image_path": "7a1a67ef230f9fb3d6f53cab21bc15a6dafe11a162f73676407f407fab9a048a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        354,
                        530,
                        395
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                354,
                                530,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "inline_equation",
                                    "content": "h < T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "text",
                                    "content": ", then the recursion ends with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{h:h} \\doteq Q_{h - 1}(S_{h}, A_{t})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "text",
                                    "content": ", whereas, if "
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "inline_equation",
                                    "content": "h \\geq T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "text",
                                    "content": ", the recursion ends with and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{T - 1:h} \\doteq R_{T}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        354,
                                        530,
                                        395
                                    ],
                                    "type": "text",
                                    "content": ". The resultant prediction algorithm (after combining with (7.5)) is analogous to Expected Sarsa."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        104,
                        399,
                        530,
                        426
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                399,
                                530,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        399,
                                        530,
                                        426
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.6 Prove that the control variate in the above equations does not change the expected value of the return."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        431,
                        529,
                        472
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                431,
                                529,
                                472
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        431,
                                        529,
                                        472
                                    ],
                                    "type": "text",
                                    "content": "*Exercise 7.7 Write the pseudocode for the off- policy action- value prediction algorithm described immediately above. Pay particular attention to the termination conditions for the recursion upon hitting the horizon or the end of episode."
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        104,
                        476,
                        529,
                        516
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                476,
                                529,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        476,
                                        529,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.8 Show that the general (off- policy) version of the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        476,
                                        529,
                                        516
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        476,
                                        529,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.13) can still be written exactly and compactly as the sum of state- based TD errors (6.5) if the approximate state value function does not change."
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        104,
                        522,
                        530,
                        560
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                522,
                                530,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        560
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.9 Repeat the above exercise for the action version of the off- policy "
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        560
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        522,
                                        530,
                                        560
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.14) and the Expected Sarsa TD error (the quantity in brackets in Equation 6.9)."
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        104,
                        566,
                        529,
                        607
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                566,
                                529,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        566,
                                        529,
                                        607
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.10 (programming) Devise a small off- policy prediction problem and use it to show that the off- policy learning algorithm using (7.13) and (7.2) is more data efficient than the simpler algorithm using (7.1) and (7.9)."
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        607,
                        530,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                607,
                                530,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        607,
                                        530,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "The importance sampling that we have used in this section, the previous section, and in Chapter 5, enables sound off- policy learning, but also results in high variance updates, forcing the use of a small step- size parameter and thereby causing learning to be slow. It is probably inevitable that off- policy training is slower than on- policy training—after all, the data is less relevant to what is being learned. However, it is probably also true that these methods can be improved on. The control variates are one way of reducing the variance. Another is to rapidly adapt the step sizes to the observed variance, as in the Autostep method (Mahmood, Sutton, Degris and Pilarski, 2012). Yet another promising approach is the invariant updates of Karampatziakis and Langford (2010) as extended to TD by Tian (in preparation). The usage technique of Mahmood (2017; Mahmood"
                                }
                            ]
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 10
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        140,
                        489,
                        168
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                140,
                                489,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        140,
                                        489,
                                        168
                                    ],
                                    "type": "text",
                                    "content": "and Sutton, 2015) may also be part of the solution. In the next section we consider an off- policy learning method that does not use importance sampling."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        64,
                        187,
                        500,
                        225
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                187,
                                500,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        187,
                                        500,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "7.5 Off-policy Learning Without Importance Sampling: The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        187,
                                        500,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        187,
                                        500,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "-step Tree Backup Algorithm"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        236,
                        489,
                        289
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                236,
                                489,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        236,
                                        489,
                                        289
                                    ],
                                    "type": "text",
                                    "content": "Is off- policy learning possible without importance sampling? Q- learning and Expected Sarsa from Chapter 6 do this for the one- step case, but is there a corresponding multi- step algorithm? In this section we present just such an "
                                },
                                {
                                    "bbox": [
                                        64,
                                        236,
                                        489,
                                        289
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        236,
                                        489,
                                        289
                                    ],
                                    "type": "text",
                                    "content": "- step method, called the tree- backup algorithm."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        291,
                        415,
                        516
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                291,
                                415,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        291,
                                        415,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "The idea of the algorithm is suggested by the 3- step tree- backup backup diagram shown to the right. Down the central spine and labeled in the diagram are three sample states and rewards, and two sample actions. These are the random variables representing the events occurring after the initial state- action pair "
                                },
                                {
                                    "bbox": [
                                        64,
                                        291,
                                        415,
                                        516
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t}, A_{t}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        291,
                                        415,
                                        516
                                    ],
                                    "type": "text",
                                    "content": ". Hanging off to the sides of each state are the actions that were not selected. (For the last state, all the actions are considered to have not (yet) been selected.) Because we have no sample data for the unselected actions, we bootstrap and use the estimates of their values in forming the target for the update. This slightly extends the idea of a backup diagram. So far we have always updated the estimated value of the node at the top of the diagram toward a target combining the rewards along the way (appropriately discounted) and the estimated values of the nodes at the bottom. In the tree- backup update, the target includes all these things plus the estimated values of the dangling action nodes hanging off the sides, at all levels. This is why it is called a tree- backup update; it is an update from the entire tree of estimated action values."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        64,
                        517,
                        415,
                        543
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                517,
                                415,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        517,
                                        415,
                                        543
                                    ],
                                    "type": "text",
                                    "content": "More precisely, the update is from the estimated action values of the leaf nodes of the tree. The action nodes in the interior, corresponding to"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "image",
                    "bbox": [
                        430,
                        297,
                        487,
                        531
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                430,
                                297,
                                487,
                                531
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        430,
                                        297,
                                        487,
                                        531
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                430,
                                                297,
                                                487,
                                                531
                                            ],
                                            "type": "image",
                                            "image_path": "11ced9e8d7a713c6cec9541814cf4416b0690f43aaeb56bc28dfa7229f9bd914.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "type": "image_body"
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        64,
                        544,
                        489,
                        677
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                544,
                                489,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "the actual actions taken, do not participate. Each leaf node contributes to the target with a weight proportional to its probability of occurring under the target policy "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ". Thus each first- level action "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "a"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": " contributes with a weight of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (a|S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ", except that the action actually taken, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ", does not contribute at all. Its probability, "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (A_{t + 1}|S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ", is used to weight all the second- level action values. Thus, each non- selected second- level action "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "a'"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": " contributes with weight "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (A_{t + 1}|S_{t + 1})\\pi (a'|S_{t + 2})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ". Each third- level action contributes with weight "
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (A_{t + 1}|S_{t + 1})\\pi (A_{t + 2}|S_{t + 2})\\pi (a'|S_{t + 3})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        544,
                                        489,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ", and so on. It is as if each arrow to an action node in the diagram is weighted by the action's probability of being selected under the target policy and, if there is a tree below the action, then that weight applies to all the leaf nodes in the tree."
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 11
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        140,
                        530,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                140,
                                530,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "We can think of the 3- step tree- backup update as consisting of 6 half- steps, alternating between sample half- steps from an action to a subsequent state, and expected half- steps considering from that state all possible actions with their probabilities of occurring under the policy.Now let us develop the detailed equations for the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        140,
                                        530,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "- step tree- backup algorithm."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        103,
                        195,
                        530,
                        222
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                195,
                                530,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        195,
                                        530,
                                        222
                                    ],
                                    "type": "text",
                                    "content": "Now let us develop the detailed equations for the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        195,
                                        530,
                                        222
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        195,
                                        530,
                                        222
                                    ],
                                    "type": "text",
                                    "content": " - step tree- backup algorithm. The one- step return (target) is the same as that of Expected Sarsa,"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        132,
                        231,
                        528,
                        259
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                231,
                                528,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        231,
                                        528,
                                        259
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + 1}\\doteq R_{t + 1} + \\gamma \\sum_{a}\\pi (a|S_{t + 1})Q_{t}(S_{t + 1},a), \\tag{7.15}",
                                    "image_path": "e15a96f626eb2530fdb5bc67fd3a47635ef076fa573775554c0e5fd0df930917.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        103,
                        268,
                        363,
                        282
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                268,
                                363,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        268,
                                        363,
                                        282
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        268,
                                        363,
                                        282
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T - 1"
                                },
                                {
                                    "bbox": [
                                        103,
                                        268,
                                        363,
                                        282
                                    ],
                                    "type": "text",
                                    "content": " , and the two- step tree- backup return is"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        131,
                        292,
                        495,
                        387
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                131,
                                292,
                                495,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        131,
                                        292,
                                        495,
                                        387
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{G_{t:t+2}\\doteq R_{t+1}+\\gamma\\sum_{a\\not=A_{t+1}}\\pi(a|S_{t+1})Q_{t+1}(S_{t+1},a)}}\\\\ {{\\qquad+\\gamma\\pi(A_{t+1}|S_{t+1})\\Big(R_{t+2}+\\gamma\\sum_{a}\\pi(a|S_{t+2})Q_{t+1}(S_{t+2},a)\\Big)}}\\\\ {{\\qquad=R_{t+1}+\\gamma\\sum_{a\\not=A_{t+1}}\\pi(a|S_{t+1})Q_{t+1}(S_{t+1},a)+\\gamma\\pi(A_{t+1}|S_{t+1})G_{t+1:t+2},}}\\end{array}",
                                    "image_path": "e1df4142bd324e6f0a7dcb7ec16b7cc7beca9e92c93a40a9e53479a09fff9837.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        103,
                        394,
                        530,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                394,
                                530,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        394,
                                        530,
                                        421
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        394,
                                        530,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T - 2"
                                },
                                {
                                    "bbox": [
                                        103,
                                        394,
                                        530,
                                        421
                                    ],
                                    "type": "text",
                                    "content": " . The latter form suggests the general recursive definition of the tree- backup "
                                },
                                {
                                    "bbox": [
                                        103,
                                        394,
                                        530,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        394,
                                        530,
                                        421
                                    ],
                                    "type": "text",
                                    "content": " - step return:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        124,
                        430,
                        528,
                        460
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                124,
                                430,
                                528,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        430,
                                        528,
                                        460
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n}\\doteq R_{t + 1} + \\gamma \\sum_{a\\not = A_{t + 1}}\\pi (a|S_{t + 1})Q_{t + n - 1}(S_{t + 1},a) + \\gamma \\pi (A_{t + 1}|S_{t + 1})G_{t + 1:t + n}, \\tag{7.16}",
                                    "image_path": "fc28dbd9e897bc9a28f37c161b1b80b4f391652ebecae604ca27e53394e250d2.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        103,
                        470,
                        531,
                        497
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                470,
                                531,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T - 1,n\\geq 2"
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "text",
                                    "content": " , with the "
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "n = 1"
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "text",
                                    "content": " case handled by (7.15) except for "
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{T - 1:t + n}\\doteq R_{T}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "text",
                                    "content": " This target is then used with the usual action- value update rule from "
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        103,
                                        470,
                                        531,
                                        497
                                    ],
                                    "type": "text",
                                    "content": " - step Sarsa:"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        132,
                        509,
                        431,
                        522
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                509,
                                431,
                                522
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        509,
                                        431,
                                        522
                                    ],
                                    "type": "interline_equation",
                                    "content": "Q_{t + n}(S_t,A_t)\\doteq Q_{t + n - 1}(S_t,A_t) + \\alpha [G_{t:t + n} - Q_{t + n - 1}(S_t,A_t)],",
                                    "image_path": "3bfe203849789f882903679f33a957c39f0b15adbd8e042cf55f5b7ac2ec6cfe.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        104,
                        532,
                        530,
                        572
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                532,
                                530,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "inline_equation",
                                    "content": "0\\leq t< T"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": " , while the values of all other state- action pairs remain unchanged: "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q_{t + n}(s,a) = Q_{t + n - 1}(s,a)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": " , for all "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "inline_equation",
                                    "content": "s,a"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\neq S_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "inline_equation",
                                    "content": "a\\neq A_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        532,
                                        530,
                                        572
                                    ],
                                    "type": "text",
                                    "content": " . Pseudocode for this algorithm is shown in the box on the next page."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        103,
                        576,
                        530,
                        603
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                576,
                                530,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        576,
                                        530,
                                        603
                                    ],
                                    "type": "text",
                                    "content": "Exercise 7.11 Show that if the approximate action values are unchanging, then the tree- backup return (7.16) can be written as a sum of expectation- based TD errors:"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        132,
                        614,
                        396,
                        653
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                132,
                                614,
                                396,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        132,
                                        614,
                                        396,
                                        653
                                    ],
                                    "type": "interline_equation",
                                    "content": "G_{t:t + n} = Q(S_t,A_t) + \\sum_{k = t}^{\\min (t + n - 1,T - 1)}\\delta_k\\prod_{i = t + 1}^{k}\\gamma \\pi (A_i|S_i),",
                                    "image_path": "77907edc2d4a8772c71db3d380f3276b3ffd9af5fe3ab3af3a439e0ea84ce149.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        103,
                        661,
                        424,
                        677
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                103,
                                661,
                                424,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        103,
                                        661,
                                        424,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "where "
                                },
                                {
                                    "bbox": [
                                        103,
                                        661,
                                        424,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\delta_{t}\\doteq R_{t + 1} + \\gamma \\bar{V}_{t}(S_{t + 1}) - Q(S_{t},A_{t})"
                                },
                                {
                                    "bbox": [
                                        103,
                                        661,
                                        424,
                                        677
                                    ],
                                    "type": "text",
                                    "content": " and "
                                },
                                {
                                    "bbox": [
                                        103,
                                        661,
                                        424,
                                        677
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{V}_{t}"
                                },
                                {
                                    "bbox": [
                                        103,
                                        661,
                                        424,
                                        677
                                    ],
                                    "type": "text",
                                    "content": " is given by (7.8)."
                                }
                            ]
                        }
                    ],
                    "index": 12
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 12
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        76,
                        139,
                        337,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                76,
                                139,
                                337,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        337,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "n-step Tree Backup for estimating "
                                },
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        337,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q\\approx q_{*}"
                                },
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        337,
                                        154
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        76,
                                        139,
                                        337,
                                        154
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        162,
                        308,
                        175
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                162,
                                308,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        162,
                                        308,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        77,
                                        162,
                                        308,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(s,a)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        162,
                                        308,
                                        175
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily, for all "
                                },
                                {
                                    "bbox": [
                                        77,
                                        162,
                                        308,
                                        175
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S},a\\in \\mathcal{A}"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        77,
                        176,
                        413,
                        189
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                176,
                                413,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        176,
                                        413,
                                        189
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        77,
                                        176,
                                        413,
                                        189
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        77,
                                        176,
                                        413,
                                        189
                                    ],
                                    "type": "text",
                                    "content": " to be greedy with respect to "
                                },
                                {
                                    "bbox": [
                                        77,
                                        176,
                                        413,
                                        189
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                },
                                {
                                    "bbox": [
                                        77,
                                        176,
                                        413,
                                        189
                                    ],
                                    "type": "text",
                                    "content": " , or as a fixed given policy"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        77,
                        190,
                        385,
                        202
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                190,
                                385,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        190,
                                        385,
                                        202
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        77,
                                        190,
                                        385,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha \\in (0,1]"
                                },
                                {
                                    "bbox": [
                                        77,
                                        190,
                                        385,
                                        202
                                    ],
                                    "type": "text",
                                    "content": " , a positive integer "
                                },
                                {
                                    "bbox": [
                                        77,
                                        190,
                                        385,
                                        202
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        202,
                        385,
                        215
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                202,
                                385,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        385,
                                        215
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations can take their index mod "
                                },
                                {
                                    "bbox": [
                                        77,
                                        202,
                                        385,
                                        215
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        223,
                        189,
                        234
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                223,
                                189,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        223,
                                        189,
                                        234
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        92,
                        236,
                        255,
                        248
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                236,
                                255,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        236,
                                        255,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        92,
                                        236,
                                        255,
                                        248
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}\\neq"
                                },
                                {
                                    "bbox": [
                                        92,
                                        236,
                                        255,
                                        248
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        91,
                        250,
                        389,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                250,
                                389,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "Choose an action "
                                },
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{0}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily as a function of "
                                },
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0}"
                                },
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " ; Store "
                                },
                                {
                                    "bbox": [
                                        91,
                                        250,
                                        389,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{0}"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        92,
                        263,
                        130,
                        273
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                263,
                                130,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        263,
                                        130,
                                        273
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        91,
                        276,
                        208,
                        288
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                276,
                                208,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        276,
                                        208,
                                        288
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        91,
                                        276,
                                        208,
                                        288
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,2,\\ldots"
                                },
                                {
                                    "bbox": [
                                        91,
                                        276,
                                        208,
                                        288
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        106,
                        290,
                        148,
                        301
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                290,
                                148,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        290,
                                        148,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        106,
                                        290,
                                        148,
                                        301
                                    ],
                                    "type": "inline_equation",
                                    "content": "t< T"
                                },
                                {
                                    "bbox": [
                                        106,
                                        290,
                                        148,
                                        301
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        117,
                        303,
                        482,
                        315
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                117,
                                303,
                                482,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        303,
                                        482,
                                        315
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        117,
                                        303,
                                        482,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        117,
                                        303,
                                        482,
                                        315
                                    ],
                                    "type": "text",
                                    "content": " , observe and store the next reward and state as "
                                },
                                {
                                    "bbox": [
                                        117,
                                        303,
                                        482,
                                        315
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1},S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        121,
                        316,
                        214,
                        328
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                316,
                                214,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        316,
                                        214,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        121,
                                        316,
                                        214,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        121,
                                        316,
                                        214,
                                        328
                                    ],
                                    "type": "text",
                                    "content": " is terminal:"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        138,
                        329,
                        186,
                        341
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                138,
                                329,
                                186,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        138,
                                        329,
                                        186,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "T\\gets t + 1"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        118,
                        342,
                        143,
                        353
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                118,
                                342,
                                143,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        342,
                                        143,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        135,
                        356,
                        464,
                        368
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                135,
                                356,
                                464,
                                368
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "text",
                                    "content": "Choose an action "
                                },
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily as a function of "
                                },
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "text",
                                    "content": " ; Store "
                                },
                                {
                                    "bbox": [
                                        135,
                                        356,
                                        464,
                                        368
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        106,
                        369,
                        420,
                        381
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                369,
                                420,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        369,
                                        420,
                                        381
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\leftarrow t + 1 - n"
                                },
                                {
                                    "bbox": [
                                        106,
                                        369,
                                        420,
                                        381
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        106,
                                        369,
                                        420,
                                        381
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        106,
                        382,
                        149,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                382,
                                149,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        382,
                                        149,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        106,
                                        382,
                                        149,
                                        394
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                },
                                {
                                    "bbox": [
                                        106,
                                        382,
                                        149,
                                        394
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        121,
                        395,
                        183,
                        407
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                395,
                                183,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        395,
                                        183,
                                        407
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        121,
                                        395,
                                        183,
                                        407
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + 1\\geq T"
                                },
                                {
                                    "bbox": [
                                        121,
                                        395,
                                        183,
                                        407
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        121,
                        409,
                        179,
                        421
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                409,
                                179,
                                421
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        409,
                                        179,
                                        421
                                    ],
                                    "type": "inline_equation",
                                    "content": "G\\gets R_{T}"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        121,
                        422,
                        141,
                        432
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                422,
                                141,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        422,
                                        141,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "else"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        135,
                        435,
                        323,
                        448
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                135,
                                435,
                                323,
                                448
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        435,
                                        323,
                                        448
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow R_{t + 1} + \\gamma \\sum_{a}\\pi (a|S_{t + 1})Q(S_{t + 1},a)} \\end{array}",
                                    "image_path": "e5fdfc27c255fc694a58752e709c0d5f957a427a19846fef6b60b65532f7c88a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        121,
                        449,
                        354,
                        461
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                449,
                                354,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        449,
                                        354,
                                        461
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        121,
                                        449,
                                        354,
                                        461
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = \\min (t,T - 1)"
                                },
                                {
                                    "bbox": [
                                        121,
                                        449,
                                        354,
                                        461
                                    ],
                                    "type": "text",
                                    "content": " down through "
                                },
                                {
                                    "bbox": [
                                        121,
                                        449,
                                        354,
                                        461
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau +1"
                                },
                                {
                                    "bbox": [
                                        121,
                                        449,
                                        354,
                                        461
                                    ],
                                    "type": "text",
                                    "content": " .."
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        135,
                        462,
                        386,
                        475
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                135,
                                462,
                                386,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        462,
                                        386,
                                        475
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r}{G\\leftarrow R_{k} + \\gamma \\sum_{a\\neq A_{k}}\\pi (a|S_{k})Q(S_{k},a) + \\gamma \\pi (A_{k}|S_{k})G} \\end{array}",
                                    "image_path": "b0ceced4595a738c14af4dfb721723436b6500d54066324ba6946a0b08a1f704.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        121,
                        476,
                        336,
                        489
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                476,
                                336,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        476,
                                        336,
                                        489
                                    ],
                                    "type": "interline_equation",
                                    "content": "Q(S_{\\tau},A_{\\tau})\\leftarrow Q(S_{\\tau},A_{\\tau}) + \\alpha [G - Q(S_{\\tau},A_{\\tau})]",
                                    "image_path": "fa3a9e88d743a571f77cd49eba798b5e426f19b06550fb79dd691c971e48815b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        91,
                        490,
                        424,
                        501
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                490,
                                424,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "text",
                                    "content": " is being learned, then ensure that "
                                },
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot |S_{\\tau})"
                                },
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "text",
                                    "content": " is greedy wrt "
                                },
                                {
                                    "bbox": [
                                        91,
                                        490,
                                        424,
                                        501
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        91,
                        502,
                        170,
                        514
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                502,
                                170,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        502,
                                        170,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        91,
                                        502,
                                        170,
                                        514
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        64,
                        548,
                        392,
                        567
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                548,
                                392,
                                567
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        392,
                                        567
                                    ],
                                    "type": "text",
                                    "content": "7.6 \\*A Unifying Algorithm: "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        392,
                                        567
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        392,
                                        567
                                    ],
                                    "type": "text",
                                    "content": " -step "
                                },
                                {
                                    "bbox": [
                                        64,
                                        548,
                                        392,
                                        567
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                }
                            ]
                        }
                    ],
                    "index": 27,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        579,
                        490,
                        659
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                579,
                                490,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        579,
                                        490,
                                        659
                                    ],
                                    "type": "text",
                                    "content": "So far in this chapter we have considered three different kinds of action- value algorithms, corresponding to the first three backup diagrams shown in Figure 7.5. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        579,
                                        490,
                                        659
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        579,
                                        490,
                                        659
                                    ],
                                    "type": "text",
                                    "content": " - step Sarsa has all sample transitions, the tree- backup algorithm has all state- to- action transitions fully branched without sampling, and "
                                },
                                {
                                    "bbox": [
                                        64,
                                        579,
                                        490,
                                        659
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        579,
                                        490,
                                        659
                                    ],
                                    "type": "text",
                                    "content": " - step Expected Sarsa has all sample transitions except for the last state- to- action one, which is fully branched with an expected value. To what extent can these algorithms be unified?"
                                }
                            ]
                        }
                    ],
                    "index": 28
                },
                {
                    "bbox": [
                        64,
                        660,
                        490,
                        740
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                660,
                                490,
                                740
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        660,
                                        490,
                                        740
                                    ],
                                    "type": "text",
                                    "content": "One idea for unification is suggested by the fourth backup diagram in Figure 7.5. This is the idea that one might decide on a step- by- step basis whether one wanted to take the action as a sample, as in Sarsa, or consider the expectation over all actions instead, as in the tree- backup update. Then, if one chose always to sample, one would obtain Sarsa, whereas if one chose never to sample, one would get the tree- backup algorithm. Expected Sarsa would be the case where one chose to sample for all steps except for the last one."
                                }
                            ]
                        }
                    ],
                    "index": 29
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 13
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        171,
                        137,
                        468,
                        357
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                171,
                                137,
                                468,
                                357
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        171,
                                        137,
                                        468,
                                        357
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                171,
                                                137,
                                                468,
                                                357
                                            ],
                                            "type": "image",
                                            "image_path": "de23347113129286aa26e052fcd12bf3e16a314eed6706a1daf7fa880d5d9c3e.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                104,
                                364,
                                530,
                                426
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        364,
                                        530,
                                        426
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": "Figure 7.5: The backup diagrams of the three kinds of "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "inline_equation",
                                            "content": "n"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": "-step action-value updates considered so far in this chapter (4-step case) plus the backup diagram of a fourth kind of update that unifies them all. The label "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "inline_equation",
                                            "content": "\\rho"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": "' indicates half transitions on which importance sampling is required in the off-policy case. The fourth kind of update unifies all the others by choosing on a state-by-state basis whether to sample "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "inline_equation",
                                            "content": "(\\sigma_t = 1)"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": " or not "
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "inline_equation",
                                            "content": "(\\sigma_t = 0)"
                                        },
                                        {
                                            "bbox": [
                                                104,
                                                364,
                                                530,
                                                426
                                            ],
                                            "type": "text",
                                            "content": "."
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        104,
                        447,
                        530,
                        527
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                447,
                                530,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "And of course there would be many other possibilities, as suggested by the last diagram in the figure. To increase the possibilities even further we can consider a continuous variation between sampling and expectation. Let "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma_t \\in [0,1]"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": " denote the degree of sampling on step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": ", with "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma = 1"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": " denoting full sampling and "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma = 0"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": " denoting a pure expectation with no sampling. The random variable "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma_t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": " might be set as a function of the state, action, or state- action pair at time "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "t"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": ". We call this proposed new algorithm "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "- step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        530,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        529,
                        530,
                        569
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                529,
                                530,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": "Now let us develop the equations of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": "- step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": ". First we write the tree- backup "
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": "- step return (7.16) in terms of the horizon "
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "inline_equation",
                                    "content": "h = t + n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": " and then in terms of the expected approximate value "
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\bar{V}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        529,
                                        530,
                                        569
                                    ],
                                    "type": "text",
                                    "content": " (7.8):"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        113,
                        575,
                        530,
                        648
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                113,
                                575,
                                530,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        113,
                                        575,
                                        530,
                                        648
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{l}{{G_{t:h}=R_{t+1}+\\gamma\\sum_{a\\not=A_{t+1}}\\pi(a|S_{t+1})Q_{h-1}(S_{t+1},a)~+~\\gamma\\pi(A_{t+1}|S_{t+1})G_{t+1:h}}}\\\\ {{~=R_{t+1}+\\gamma V_{h-1}(S_{t+1})-\\gamma\\pi(A_{t+1}|S_{t+1})Q_{h-1}(S_{t+1},A_{t+1})+\\gamma\\pi(A_{t+1}|S_{t+1})G_{t+1:h}}}\\\\ {{~=R_{t+1}+\\gamma\\pi(A_{t+1}|S_{t+1})\\Big(G_{t+1:h}-Q_{h-1}(S_{t+1},A_{t+1})\\Big)+\\gamma V_{h-1}(S_{t+1}),}}\\end{array}",
                                    "image_path": "65b7686fe1fe35bd0feb4b533df62bac9eeb141988dbfdde739700a11b3acddb.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        651,
                        530,
                        692
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                651,
                                530,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "text",
                                    "content": "after which it is exactly like the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "text",
                                    "content": "- step return for Sarsa with control variates (7.14) except with the action probability "
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (A_{t + 1}|S_{t + 1})"
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "text",
                                    "content": " substituted for the importance- sampling ratio "
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "text",
                                    "content": ". For "
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        651,
                                        530,
                                        692
                                    ],
                                    "type": "text",
                                    "content": ", we slide linearly between these two cases:"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        112,
                        696,
                        528,
                        739
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                112,
                                696,
                                528,
                                739
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        112,
                                        696,
                                        528,
                                        739
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\begin{array}{r l} & {G_{t:h}\\doteq R_{t + 1} + \\gamma \\Big(\\sigma_{t + 1}\\rho_{t + 1} + (1 - \\sigma_{t + 1})\\pi (A_{t + 1}|S_{t + 1})\\Big)\\Big(G_{t + 1:h} - Q_{h - 1}(S_{t + 1},A_{t + 1})\\Big)}\\\\ & {\\qquad +\\gamma V_{h - 1}(S_{t + 1}),\\qquad (7.17)} \\end{array} \\tag{7.17}",
                                    "image_path": "401797c87c8e723365d23c269933bd45a3fdacbdd4898c4045cd40a5d446af76.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 14
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        139,
                        489,
                        194
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                139,
                                489,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "t < h \\leq T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": ". The recursion ends with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{h:h} \\doteq Q_{h - 1}(S_{h}, A_{h})"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "h < T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": ", or with "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "G_{T - 1:T} \\doteq R_{T}"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": " if "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "h = T"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": ". Then we use the earlier update for "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "- step Sarsa without importance- sampling ratios (7.5) instead of (7.11), because now the ratios are incorporated in the "
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        139,
                                        489,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "- step return. A complete algorithm is given in the box."
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        77,
                        211,
                        350,
                        225
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                211,
                                350,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "Off-policy "
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "-step "
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\alpha)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "text",
                                    "content": " for estimating "
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q \\approx q_{*}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "text",
                                    "content": " or "
                                },
                                {
                                    "bbox": [
                                        77,
                                        211,
                                        350,
                                        225
                                    ],
                                    "type": "inline_equation",
                                    "content": "q_{\\pi}"
                                }
                            ]
                        }
                    ],
                    "index": 1,
                    "level": 1
                },
                {
                    "bbox": [
                        77,
                        234,
                        456,
                        261
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                234,
                                456,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "text",
                                    "content": "Input: an arbitrary behavior policy "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "b"
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " such that "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "b(a|s) > 0"
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " , for all "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S},a\\in \\mathcal{A}"
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " Initialize "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(s,a)"
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "text",
                                    "content": " arbitrarily, for all "
                                },
                                {
                                    "bbox": [
                                        77,
                                        234,
                                        456,
                                        261
                                    ],
                                    "type": "inline_equation",
                                    "content": "s\\in \\mathcal{S},a\\in \\mathcal{A}"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        77,
                        261,
                        443,
                        274
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                261,
                                443,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        443,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "Initialize "
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        443,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        443,
                                        274
                                    ],
                                    "type": "text",
                                    "content": " to be greedy with respect to "
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        443,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                },
                                {
                                    "bbox": [
                                        77,
                                        261,
                                        443,
                                        274
                                    ],
                                    "type": "text",
                                    "content": ", or else it is a fixed given policy"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        77,
                        275,
                        384,
                        287
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                275,
                                384,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        384,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "Algorithm parameters: step size "
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        384,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\alpha \\in (0,1]"
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        384,
                                        287
                                    ],
                                    "type": "text",
                                    "content": ", a positive integer "
                                },
                                {
                                    "bbox": [
                                        77,
                                        275,
                                        384,
                                        287
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        77,
                        288,
                        384,
                        300
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                288,
                                384,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        384,
                                        300
                                    ],
                                    "type": "text",
                                    "content": "All store and access operations can take their index mod "
                                },
                                {
                                    "bbox": [
                                        77,
                                        288,
                                        384,
                                        300
                                    ],
                                    "type": "inline_equation",
                                    "content": "n + 1"
                                }
                            ]
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        77,
                        308,
                        188,
                        320
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                77,
                                308,
                                188,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        308,
                                        188,
                                        320
                                    ],
                                    "type": "text",
                                    "content": "Loop for each episode:"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        92,
                        321,
                        255,
                        333
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                321,
                                255,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        321,
                                        255,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "Initialize and store "
                                },
                                {
                                    "bbox": [
                                        92,
                                        321,
                                        255,
                                        333
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{0} \\neq"
                                },
                                {
                                    "bbox": [
                                        92,
                                        321,
                                        255,
                                        333
                                    ],
                                    "type": "text",
                                    "content": " terminal"
                                }
                            ]
                        }
                    ],
                    "index": 7
                },
                {
                    "bbox": [
                        92,
                        335,
                        287,
                        347
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                335,
                                287,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        335,
                                        287,
                                        347
                                    ],
                                    "type": "text",
                                    "content": "Choose and store an action "
                                },
                                {
                                    "bbox": [
                                        92,
                                        335,
                                        287,
                                        347
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{0} \\sim b(\\cdot |S_{0})"
                                }
                            ]
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        92,
                        348,
                        129,
                        359
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                348,
                                129,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        348,
                                        129,
                                        359
                                    ],
                                    "type": "inline_equation",
                                    "content": "T \\leftarrow \\infty"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        92,
                        361,
                        207,
                        373
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                361,
                                207,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        361,
                                        207,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        92,
                                        361,
                                        207,
                                        373
                                    ],
                                    "type": "inline_equation",
                                    "content": "t = 0,1,2,\\ldots"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        105,
                        374,
                        149,
                        386
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                374,
                                149,
                                386
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        149,
                                        386
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        149,
                                        386
                                    ],
                                    "type": "inline_equation",
                                    "content": "t < T"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        118,
                        388,
                        481,
                        400
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                118,
                                388,
                                481,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        388,
                                        481,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "Take action "
                                },
                                {
                                    "bbox": [
                                        118,
                                        388,
                                        481,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t}"
                                },
                                {
                                    "bbox": [
                                        118,
                                        388,
                                        481,
                                        400
                                    ],
                                    "type": "text",
                                    "content": " : observe and store the next reward and state as "
                                },
                                {
                                    "bbox": [
                                        118,
                                        388,
                                        481,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "R_{t + 1},S_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        118,
                        401,
                        214,
                        414
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                118,
                                401,
                                214,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        401,
                                        214,
                                        414
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        118,
                                        401,
                                        214,
                                        414
                                    ],
                                    "type": "inline_equation",
                                    "content": "S_{t + 1}"
                                },
                                {
                                    "bbox": [
                                        118,
                                        401,
                                        214,
                                        414
                                    ],
                                    "type": "text",
                                    "content": " is terminal:"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        126,
                        415,
                        185,
                        426
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                126,
                                415,
                                185,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        415,
                                        185,
                                        426
                                    ],
                                    "type": "inline_equation",
                                    "content": "T \\leftarrow t + 1"
                                }
                            ]
                        }
                    ],
                    "index": 14
                },
                {
                    "bbox": [
                        121,
                        428,
                        143,
                        439
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                428,
                                143,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        428,
                                        143,
                                        439
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 15
                },
                {
                    "bbox": [
                        136,
                        441,
                        352,
                        453
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                441,
                                352,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        441,
                                        352,
                                        453
                                    ],
                                    "type": "text",
                                    "content": "Choose and store an action "
                                },
                                {
                                    "bbox": [
                                        136,
                                        441,
                                        352,
                                        453
                                    ],
                                    "type": "inline_equation",
                                    "content": "A_{t + 1} \\sim b(\\cdot |S_{t + 1})"
                                }
                            ]
                        }
                    ],
                    "index": 16
                },
                {
                    "bbox": [
                        136,
                        455,
                        238,
                        467
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                455,
                                238,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        455,
                                        238,
                                        467
                                    ],
                                    "type": "text",
                                    "content": "Select and store "
                                },
                                {
                                    "bbox": [
                                        136,
                                        455,
                                        238,
                                        467
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\sigma_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 17
                },
                {
                    "bbox": [
                        136,
                        468,
                        261,
                        484
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                468,
                                261,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        468,
                                        261,
                                        484
                                    ],
                                    "type": "text",
                                    "content": "Store "
                                },
                                {
                                    "bbox": [
                                        136,
                                        468,
                                        261,
                                        484
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac{\\pi(A_{t + 1} | S_{t + 1})}{b(A_{t + 1} | S_{t + 1})}"
                                },
                                {
                                    "bbox": [
                                        136,
                                        468,
                                        261,
                                        484
                                    ],
                                    "type": "text",
                                    "content": " as "
                                },
                                {
                                    "bbox": [
                                        136,
                                        468,
                                        261,
                                        484
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\rho_{t + 1}"
                                }
                            ]
                        }
                    ],
                    "index": 18
                },
                {
                    "bbox": [
                        106,
                        484,
                        420,
                        496
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                106,
                                484,
                                420,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        484,
                                        420,
                                        496
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\leftarrow t - n + 1"
                                },
                                {
                                    "bbox": [
                                        106,
                                        484,
                                        420,
                                        496
                                    ],
                                    "type": "text",
                                    "content": " ("
                                },
                                {
                                    "bbox": [
                                        106,
                                        484,
                                        420,
                                        496
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau"
                                },
                                {
                                    "bbox": [
                                        106,
                                        484,
                                        420,
                                        496
                                    ],
                                    "type": "text",
                                    "content": " is the time whose estimate is being updated)"
                                }
                            ]
                        }
                    ],
                    "index": 19
                },
                {
                    "bbox": [
                        105,
                        497,
                        149,
                        509
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                105,
                                497,
                                149,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        497,
                                        149,
                                        509
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        105,
                                        497,
                                        149,
                                        509
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau \\geq 0"
                                }
                            ]
                        }
                    ],
                    "index": 20
                },
                {
                    "bbox": [
                        118,
                        511,
                        183,
                        523
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                118,
                                511,
                                183,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        511,
                                        183,
                                        523
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        118,
                                        511,
                                        183,
                                        523
                                    ],
                                    "type": "inline_equation",
                                    "content": "t + 1 < T"
                                }
                            ]
                        }
                    ],
                    "index": 21
                },
                {
                    "bbox": [
                        136,
                        524,
                        232,
                        538
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                524,
                                232,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        524,
                                        232,
                                        538
                                    ],
                                    "type": "inline_equation",
                                    "content": "G \\leftarrow Q(S_{t + 1}, A_{t + 1})"
                                }
                            ]
                        }
                    ],
                    "index": 22
                },
                {
                    "bbox": [
                        121,
                        538,
                        354,
                        550
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                538,
                                354,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        538,
                                        354,
                                        550
                                    ],
                                    "type": "text",
                                    "content": "Loop for "
                                },
                                {
                                    "bbox": [
                                        121,
                                        538,
                                        354,
                                        550
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = \\min (t + 1, T)"
                                },
                                {
                                    "bbox": [
                                        121,
                                        538,
                                        354,
                                        550
                                    ],
                                    "type": "text",
                                    "content": " down through "
                                },
                                {
                                    "bbox": [
                                        121,
                                        538,
                                        354,
                                        550
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau + 1"
                                }
                            ]
                        }
                    ],
                    "index": 23
                },
                {
                    "bbox": [
                        136,
                        550,
                        180,
                        562
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                550,
                                180,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        550,
                                        180,
                                        562
                                    ],
                                    "type": "text",
                                    "content": "if "
                                },
                                {
                                    "bbox": [
                                        136,
                                        550,
                                        180,
                                        562
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = T"
                                }
                            ]
                        }
                    ],
                    "index": 24
                },
                {
                    "bbox": [
                        153,
                        564,
                        194,
                        575
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                153,
                                564,
                                194,
                                575
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        153,
                                        564,
                                        194,
                                        575
                                    ],
                                    "type": "inline_equation",
                                    "content": "G \\leftarrow R_{T}"
                                }
                            ]
                        }
                    ],
                    "index": 25
                },
                {
                    "bbox": [
                        136,
                        577,
                        158,
                        588
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                136,
                                577,
                                158,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        577,
                                        158,
                                        588
                                    ],
                                    "type": "text",
                                    "content": "else:"
                                }
                            ]
                        }
                    ],
                    "index": 26
                },
                {
                    "bbox": [
                        150,
                        590,
                        452,
                        606
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                150,
                                590,
                                452,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        150,
                                        590,
                                        452,
                                        606
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\bar{V} \\leftarrow \\sum_{a} \\pi (a | S_{k}) Q(S_{k}, a)",
                                    "image_path": "d878b7aaa0036cd771f2898522b28b63f6875cae88d3fce8dab470869cae774a.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 27
                },
                {
                    "bbox": [
                        149,
                        602,
                        452,
                        617
                    ],
                    "type": "interline_equation",
                    "lines": [
                        {
                            "bbox": [
                                149,
                                602,
                                452,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        149,
                                        602,
                                        452,
                                        617
                                    ],
                                    "type": "interline_equation",
                                    "content": "G \\leftarrow R_{k} + \\gamma \\left(\\sigma_{k} \\rho_{k} + (1 - \\sigma_{k}) \\pi (A_{k} | S_{k})\\right) \\left(G - Q(S_{k}, A_{k})\\right) + \\gamma \\bar{V}",
                                    "image_path": "74658e1c7b9ee38b5e0eb70a6931541d1a79acb8ff1ccbf18a0cbd02ae8550c3.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 28
                },
                {
                    "bbox": [
                        121,
                        617,
                        336,
                        630
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                121,
                                617,
                                336,
                                630
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        617,
                                        336,
                                        630
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(S_{\\tau}, A_{\\tau}) \\leftarrow Q(S_{\\tau}, A_{\\tau}) + \\alpha \\left[ G - Q(S_{\\tau}, A_{\\tau}) \\right]"
                                }
                            ]
                        }
                    ],
                    "index": 29
                },
                {
                    "bbox": [
                        92,
                        630,
                        424,
                        643
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                92,
                                630,
                                424,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "text",
                                    "content": "If "
                                },
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi"
                                },
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "text",
                                    "content": " is being learned, then ensure that "
                                },
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi (\\cdot | S_{\\tau})"
                                },
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "text",
                                    "content": " is greedy wrt "
                                },
                                {
                                    "bbox": [
                                        92,
                                        630,
                                        424,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q"
                                }
                            ]
                        }
                    ],
                    "index": 30
                },
                {
                    "bbox": [
                        91,
                        644,
                        170,
                        655
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                91,
                                644,
                                170,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        644,
                                        170,
                                        655
                                    ],
                                    "type": "text",
                                    "content": "Until "
                                },
                                {
                                    "bbox": [
                                        91,
                                        644,
                                        170,
                                        655
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\tau = T - 1"
                                }
                            ]
                        }
                    ],
                    "index": 31
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 15
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        104,
                        137,
                        221,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                137,
                                221,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        137,
                                        221,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "7.7 Summary"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        104,
                        165,
                        530,
                        219
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                165,
                                530,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        165,
                                        530,
                                        219
                                    ],
                                    "type": "text",
                                    "content": "In this chapter we have developed a range of temporal- difference learning methods that lie in between the one- step TD methods of the previous chapter and the Monte Carlo methods of the chapter before. Methods that involve an intermediate amount of bootstrapping are important because they will typically perform better than either extreme."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        104,
                        220,
                        423,
                        446
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                220,
                                423,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": "Our focus in this chapter has been on "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " - step methods, which look ahead to the next "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " rewards, states, and actions. The two 4- step backup diagrams to the right together summarize most of the methods introduced. The state- value update shown is for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " - step TD with importance sampling, and the action- value update is for "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " - step "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " , which generalizes Expected Sarsa and Q- learning. All "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " - step methods involve a delay of "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " time steps before updating, as only then are all the required future events known. A further drawback is that they involve more computation per time step than previous methods. Compared to one- step methods, "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " - step methods also require more memory to record the states, actions, rewards, and sometimes other variables over the last "
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        220,
                                        423,
                                        446
                                    ],
                                    "type": "text",
                                    "content": " time steps. Eventually, in Chapter 12, we will see how multi- step TD methods can be implemented with minimal memory and computational complexity using eligibility traces, but there will always be some additional computation beyond one- step methods. Such costs can be well worth paying to escape the tyranny of the single time step."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        104,
                        447,
                        423,
                        500
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                447,
                                423,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        423,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "Although "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        423,
                                        500
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        423,
                                        500
                                    ],
                                    "type": "text",
                                    "content": " - step methods are more complex than those using eligibility traces, they have the great benefit of being conceptually clear. We have sought to take advantage of this by developing two approaches to off- policy learning in the "
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        423,
                                        500
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        447,
                                        423,
                                        500
                                    ],
                                    "type": "text",
                                    "content": " - step case. One, based on"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        439,
                        234,
                        529,
                        488
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                439,
                                234,
                                529,
                                488
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        439,
                                        234,
                                        529,
                                        488
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                439,
                                                234,
                                                529,
                                                488
                                            ],
                                            "type": "image",
                                            "image_path": "baaf65181ab52772581992521007c7e46fac876dfef5f9d980a13d1ee08d5e6a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "type": "image_body"
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        104,
                        500,
                        530,
                        580
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                104,
                                500,
                                530,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        104,
                                        500,
                                        530,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "importance sampling is conceptually simple but can be of high variance. If the target and behavior policies are very different it probably needs some new algorithmic ideas before it can be efficient and practical. The other, based on tree- backup updates, is the natural extension of Q- learning to the multi- step case with stochastic target policies. It involves no importance sampling but, again if the target and behavior policies are substantially different, the bootstrapping may span only a few steps even if "
                                },
                                {
                                    "bbox": [
                                        104,
                                        500,
                                        530,
                                        580
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        104,
                                        500,
                                        530,
                                        580
                                    ],
                                    "type": "text",
                                    "content": " is large."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 16
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        64,
                        136,
                        375,
                        154
                    ],
                    "type": "title",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                136,
                                375,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        136,
                                        375,
                                        154
                                    ],
                                    "type": "text",
                                    "content": "Bibliographical and Historical Remarks"
                                }
                            ]
                        }
                    ],
                    "index": 0,
                    "level": 1
                },
                {
                    "bbox": [
                        64,
                        165,
                        490,
                        259
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                165,
                                490,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        259
                                    ],
                                    "type": "text",
                                    "content": "The notion of "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        259
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        259
                                    ],
                                    "type": "text",
                                    "content": "- step returns is due to Watkins (1989), who also first discussed their error reduction property. "
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        259
                                    ],
                                    "type": "inline_equation",
                                    "content": "n"
                                },
                                {
                                    "bbox": [
                                        64,
                                        165,
                                        490,
                                        259
                                    ],
                                    "type": "text",
                                    "content": "- step algorithms were explored in the first edition of this book, in which they were treated as of conceptual interest, but not feasible in practice. The work of Cichosz (1995) and particularly van Seijen (2016) showed that they are actually completely practical algorithms. Given this, and their conceptual clarity and simplicity, we have chosen to highlight them here in the second edition. In particular, we now postpone all discussion of the backward view and of eligibility traces until Chapter 12."
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        64,
                        271,
                        489,
                        311
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                271,
                                489,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        271,
                                        489,
                                        311
                                    ],
                                    "type": "text",
                                    "content": "7.1- 2 The results in the random walk examples were made for this text based on work of Sutton (1988) and Singh and Sutton (1996). The use of backup diagrams to describe these and other algorithms in this chapter is new."
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        64,
                        323,
                        490,
                        363
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                323,
                                490,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        323,
                                        490,
                                        363
                                    ],
                                    "type": "text",
                                    "content": "7.3- 5 The developments in these sections are based on the work of Precup, Sutton, and Singh (2000), Precup, Sutton, and Dasgupta (2001), and Sutton, Mahmood, Precup, and van Hasselt (2014)."
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        102,
                        367,
                        489,
                        394
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                102,
                                367,
                                489,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        102,
                                        367,
                                        489,
                                        394
                                    ],
                                    "type": "text",
                                    "content": "The tree- backup algorithm is due to Precup, Sutton, and Singh (2000), but the presentation of it here is new."
                                }
                            ]
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        64,
                        406,
                        489,
                        432
                    ],
                    "type": "text",
                    "lines": [
                        {
                            "bbox": [
                                64,
                                406,
                                489,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        64,
                                        406,
                                        489,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "7.6 The "
                                },
                                {
                                    "bbox": [
                                        64,
                                        406,
                                        489,
                                        432
                                    ],
                                    "type": "inline_equation",
                                    "content": "Q(\\sigma)"
                                },
                                {
                                    "bbox": [
                                        64,
                                        406,
                                        489,
                                        432
                                    ],
                                    "type": "text",
                                    "content": " algorithm is new to this text, but closely related algorithms have been explored further by De Asis, Hernandez- Garcia, Holland, and Sutton (2017)."
                                }
                            ]
                        }
                    ],
                    "index": 5
                }
            ],
            "discarded_blocks": [],
            "page_size": [
                595,
                842
            ],
            "page_idx": 17
        }
    ],
    "_backend": "vlm",
    "_version_name": "2.0.6"
}